<!DOCTYPE HTML>
<html>

<!-- HEADER -->
<head>

<title>My Bitsy Game By Me</title>

<script type="bitsyGameData" id="exportedGameData">


# BITSY VERSION 4.8

! ROOM_FORMAT 1

PAL 0
NAME indoors
255,194,194
250,125,149
173,212,255
83,3,75
206,24,106
86,127,235
86,127,235

PAL 1
NAME outdoors
171,252,172
83,3,75
206,24,106
10,84,123
39,140,127
252,131,159
86,127,235

PAL 2
171,252,172
252,131,159
252,131,159

PAL 3
NAME title
173,212,255
252,131,159
255,194,194
173,212,255
173,212,255
173,212,255
173,212,255

PAL 4
NAME chase
255,194,194
252,131,159
255,64,64
255,64,64
255,64,64
255,64,64
86,127,235

PAL 5
NAME outdoors
171,252,172
83,3,75
206,24,106
10,84,123
39,140,127
255,64,64
86,127,235

PAL 6
NAME walk
255,194,194
250,125,149
173,212,255
240,117,131
206,24,106
86,127,235
255,194,194
86,127,235

PAL 7
NAME chase2
255,194,194
252,131,159
255,64,64
255,64,64
255,64,64
255,64,64
255,194,194

PAL 8
NAME indoors2
255,194,194
250,125,149
83,3,75
10,84,123
39,140,127
86,127,235
206,24,106
255,236,109
255,167,99

ROOM 0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 5
ITM 0 2,5
ITM h 7,3
ITM 4 12,4
ITM 4 12,3
ITM 35 5,9
ITM 35 6,9
EXT 10,10 0 8,10
EXT 9,10 0 11,10
EXT 3,8 0 3,6
EXT 3,7 0 3,9
EXT 5,5 0 7,5
EXT 6,5 0 4,5
EXT 9,5 0 11,5
EXT 10,5 0 8,5
PAL 0

ROOM 1
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,0,0,0,0,0
0,a,0,0,0,m,n,0,0,c,0,0,0,0,0,0
0,a,0,0,0,0,0,0,0,t,0,0,0,0,0,0
0,a,0,0,0,0,0,0,0,c,0,0,0,0,0,0
0,a,0,0,0,0,l,k,0,c,0,0,0,0,0,0
0,a,0,l,k,k,k,k,0,c,0,0,0,0,0,0
0,0,d,d,d,d,d,d,d,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 4
ITM 0 2,5
ITM h 7,3
ITM 4 12,4
ITM 4 12,3
ITM 35 5,9
ITM 35 6,9
EXT 3,8 1 3,6
EXT 3,7 1 3,9
EXT 5,5 1 7,5
EXT 6,5 1 4,5
EXT 9,5 1 11,5
EXT 10,5 1 8,5
EXT 9,10 0 11,10
PAL 0

ROOM 2
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 3a
ITM b 5,5
ITM b 3,7
ITM 4 12,4
ITM 4 12,3
EXT 2,6 1y 2,6
EXT 2,4 1x 2,4
PAL 0

ROOM 3
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,u,b,0,a,0,q,0,c,0
0,0,0,0,0,0,a,0,0,c,a,0,r,0,c,0
0,0,0,0,0,0,s,0,0,t,s,0,0,0,c,0
0,0,0,0,0,0,a,0,0,c,a,0,0,0,c,0
0,0,0,0,0,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 2
ITM 5 7,3
ITM 4 12,4
ITM 4 12,3
EXT 9,5 3 11,5
EXT 10,5 3 8,5
EXT 6,5 2 4,5
PAL 0

ROOM 4
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 1
ITM 4 12,4
ITM 4 12,3
EXT 10,5 3 8,5
PAL 0

ROOM 5
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,10,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,11,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME sleep
ITM 2 13,6
ITM 3j 12,3
EXT 8,9 6 7,9
EXT 6,9 8 7,9
PAL 6

ROOM 6
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,16,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 13,3
ITM 2 13,6
ITM 4 6,9
EXT 7,10 7 7,9
PAL 6

ROOM 7
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,16,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 13,4
ITM 2 13,6
ITM 4 6,9
EXT 7,8 6 7,9
EXT 7,10 a 7,9
PAL 6

ROOM 8
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,16,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 11,3
ITM 2 13,6
ITM 4 8,9
EXT 7,10 9 7,9
PAL 6

ROOM 9
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,16,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 11,4
ITM 2 13,6
ITM 4 8,9
EXT 7,8 8 7,9
EXT 7,10 c 7,9
PAL 6

ROOM 10
0,0,0,1c,1n,1d,1e,0,0,0,1g,1h,1i,1j,2,0
0,0,0,0,3,2,0,0,0,0,1k,1o,1o,1l,8,5
1h,1i,1j,0,3,2,0,0,0,0,1c,1n,1d,1e,0,0
1o,1o,1l,9p,7,8,5,0,0,0,0,3,2,0,0,0
1n,1d,1e,0,0,0,0,0,0,0,0,3,2,1g,1h,1i
3,2,0,0,0,0,0,0,0,0,9p,7,8,1k,1o,1o
3,2,0,1g,1h,1i,1j,0,0,0,0,0,0,1c,1n,1d
7,8,5,1k,1o,1o,1l,0,0,0,0,0,0,0,3,2
0,0,0,1c,1n,1d,1e,0,0,1g,1h,1i,1j,0,3,2
0,0,0,0,3,2,0,0,0,1k,1o,1o,1l,9p,7,8
1g,1h,1i,1j,3,2,0,0,0,1c,1n,1d,1e,0,0,0
1k,1o,1o,1l,7,8,5,0,0,0,3,2,0,0,0,0
1c,1n,1d,1e,0,0,0,0,0,0,3,1g,1h,1i,1j,0
0,3,2,0,0,0,0,0,0,9p,7,1k,1o,1o,1l,0
0,3,2,0,0,0,0,0,0,0,0,1c,1n,1d,1e,0
9p,7,8,5,0,0,0,0,0,0,0,0,3,2,0,0
NAME orchard-1
ITM m 11,12
ITM o 12,14
ITM o 10,10
ITM o 1,12
ITM o 0,4
ITM o 4,0
ITM o 11,2
ITM o 14,6
ITM p 11,10
ITM p 13,14
ITM p 15,6
ITM p 12,2
ITM p 5,0
ITM p 1,4
ITM p 2,12
ITM q 3,12
ITM q 2,4
ITM q 6,0
ITM q 13,2
ITM q 12,10
ITM q 14,14
ITM r 12,9
ITM r 14,13
ITM r 13,1
ITM r 2,3
ITM r 3,11
ITM s 3,10
ITM s 2,2
ITM s 13,0
ITM s 12,8
ITM s 14,12
ITM t 11,14
ITM t 9,10
ITM t 0,12
ITM t 10,2
ITM t 3,0
ITM t 13,6
ITM u 11,13
ITM u 9,9
ITM u 0,11
ITM u 10,1
ITM u 13,5
ITM v 9,8
ITM v 0,10
ITM v 10,0
ITM v 13,4
ITM v 11,12
ITM w 10,8
ITM w 12,12
ITM w 14,4
ITM w 11,0
ITM w 0,2
ITM w 1,10
ITM x 2,10
ITM x 1,2
ITM x 12,0
ITM x 15,4
ITM x 11,8
ITM x 13,12
ITM o 4,8
ITM p 5,8
ITM q 6,8
ITM t 3,8
ITM s 6,6
ITM x 5,6
ITM w 4,6
ITM v 3,6
ITM u 3,7
ITM r 6,7
ITM z 7,11
ITM z 15,15
ITM z 1,1
ITM 1e 0,5
ITM 1e 4,1
ITM 1e 11,3
ITM 1e 14,7
ITM 1e 10,11
ITM 1e 4,9
ITM 1e 1,13
ITM 1e 12,15
ITM 1e 14,8
ITM 1e 10,12
ITM 1e 4,10
ITM 1e 1,14
ITM 1e 0,6
ITM 1e 4,2
ITM 1e 11,4
ITM 1f 2,14
ITM 1f 2,13
ITM 1f 5,10
ITM 1f 5,9
ITM 1f 1,6
ITM 1f 1,5
ITM 1f 5,2
ITM 1f 5,1
ITM 1f 12,3
ITM 1f 12,4
ITM 1f 14,0
ITM 1f 15,7
ITM 1f 15,8
ITM 1f 11,11
ITM 1f 13,15
ITM 1g 15,9
ITM 1g 5,11
ITM 1g 2,15
ITM 1g 1,7
ITM 1g 5,3
ITM 1g 12,5
ITM 1g 14,1
ITM 1h 1,15
ITM 1h 0,7
ITM 1h 4,3
ITM 1h 4,11
ITM 1h 10,13
ITM 1h 14,9
ITM 1h 11,5
ITM 36 11,12
ITM 39 11,13
EXT 7,15 r 7,4
EXT 6,15 r 7,4
EXT 8,15 r 7,4
EXT 9,15 r 7,4
EXT 10,15 r 7,4
EXT 5,15 r 7,4
EXT 4,15 r 7,4
EXT 3,15 r 7,4
EXT 7,0 11 7,14
EXT 8,0 11 8,14
EXT 9,0 11 9,14
PAL 1

ROOM 11
1h,1i,1j,0,0,0,0,0,0,1c,1n,1d,1e,0,0,3
1o,1o,1l,0,0,0,0,0,0,0,3,2,0,0,9p,7
1n,1d,1e,0,0,0,0,0,0,0,3,1g,1h,1i,1j,0
3,2,0,0,0,0,0,0,0,9p,7,1k,1o,1o,1l,0
3,1g,1h,1i,1j,0,0,1g,1h,1i,1j,1c,1n,1d,1e,0
7,1k,1o,1o,1l,0,0,1k,1o,1o,1l,0,3,2,0,0
0,1c,1n,1d,1e,0,0,1c,1n,1d,1e,0,3,2,0,0
0,0,3,2,0,0,0,0,3,2,0,9p,7,1g,1h,1i
0,0,3,1g,1h,1i,1j,0,3,2,0,0,0,1k,1o,1o
0,9p,7,1k,1o,1o,1l,9p,7,8,5,0,0,1c,1n,1d
1h,1i,1j,1c,1n,1d,1e,0,0,0,0,0,0,0,3,2
1o,1o,1l,0,3,2,0,0,0,0,0,0,1g,1h,1i,1j
1n,1d,1e,0,3,2,0,0,0,0,0,0,1k,1o,1o,1l
3,2,0,1g,1h,1i,1j,0,0,0,0,0,1c,1n,1d,1e
3,2,0,1k,1o,1o,1l,0,0,0,0,0,0,3,2,0
7,8,5,1c,1n,1d,1e,0,0,0,0,0,0,3,2,0
NAME trunky
ITM m 13,7
ITM m 11,2
ITM m 1,4
ITM m 3,8
ITM o 4,10
ITM o 2,6
ITM o 0,2
ITM o 0,12
ITM o 4,15
ITM o 10,0
ITM o 12,4
ITM o 14,9
ITM o 13,13
ITM p 5,10
ITM p 5,15
ITM p 1,12
ITM p 3,6
ITM p 1,2
ITM p 11,0
ITM p 13,4
ITM p 15,9
ITM p 14,13
ITM y 15,11
ITM q 6,10
ITM q 2,12
ITM q 4,6
ITM q 2,2
ITM q 12,0
ITM q 14,4
ITM q 6,15
ITM q 15,13
ITM t 12,13
ITM t 3,15
ITM t 3,10
ITM t 1,6
ITM t 11,4
ITM t 9,0
ITM t 13,9
ITM u 12,12
ITM u 13,8
ITM u 11,3
ITM u 1,5
ITM u 3,9
ITM u 3,14
ITM r 15,12
ITM r 6,14
ITM r 2,11
ITM r 6,9
ITM r 4,5
ITM r 2,1
ITM r 14,3
ITM w 13,11
ITM w 14,7
ITM w 4,13
ITM w 0,10
ITM w 4,8
ITM w 2,4
ITM w 0,0
ITM w 12,2
ITM x 14,11
ITM x 15,7
ITM x 13,2
ITM x 3,4
ITM x 1,0
ITM x 5,8
ITM x 1,10
ITM x 5,13
ITM s 4,4
ITM s 2,0
ITM s 14,2
ITM s 6,8
ITM s 2,10
ITM s 6,13
ITM s 15,11
ITM v 12,11
ITM v 3,13
ITM v 13,7
ITM v 11,2
ITM v 3,8
ITM v 1,4
ITM s 10,4
ITM x 9,4
ITM w 8,4
ITM v 7,4
ITM u 7,5
ITM r 10,5
ITM t 7,6
ITM o 8,6
ITM p 9,6
ITM q 10,6
ITM z 10,8
ITM z 3,2
ITM 1e 0,14
ITM 1e 0,13
ITM 1e 2,8
ITM 1e 2,7
ITM 1e 0,4
ITM 1e 0,3
ITM 1e 10,2
ITM 1e 10,1
ITM 1e 12,5
ITM 1e 12,6
ITM 1e 14,10
ITM 1e 8,7
ITM 1e 8,8
ITM 1e 4,11
ITM 1e 4,12
ITM 1e 13,14
ITM 1e 13,15
ITM 1e 15,0
ITM 1f 11,1
ITM 1f 1,3
ITM 1f 1,13
ITM 1f 1,14
ITM 1f 3,7
ITM 1f 5,11
ITM 1f 5,12
ITM 1f 9,7
ITM 1f 9,8
ITM 1f 13,5
ITM 1f 13,6
ITM 1f 15,10
ITM 1f 14,14
ITM 1f 14,15
ITM 1g 1,15
ITM 1h 8,9
ITM 1h 10,3
ITM 1h 12,7
ITM 1h 15,1
ITM 1h 0,5
ITM 1h 2,9
ITM 1h 0,15
ITM 36 1,4
ITM 36 3,8
ITM 36 11,2
ITM 37 13,7
ITM 38 13,7
ITM 39 1,5
ITM 39 3,9
ITM 39 11,3
ITM 3a 15,11
ITM 3b 14,11
ITM 1g 9,9
EXT 7,15 10 7,1
EXT 8,15 10 8,1
EXT 9,15 10 9,1
EXT 10,15 10 9,1
EXT 11,15 10 9,1
EXT 12,15 10 9,1
EXT 8,0 12 8,14
EXT 7,0 12 7,14
EXT 6,0 12 6,14
EXT 5,0 12 5,14
EXT 4,0 12 4,14
EXT 3,0 12 3,14
PAL 1

ROOM 12
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,19,2x,2x,1a,1b,2x,2x,1f,0,0,0,0
0,0,1m,1p,1q,2u,2u,1r,1s,2u,2u,1t,1p,1u,0,0
0,0,1b,2x,2u,1v,1w,1x,1y,1z,20,2u,2x,1a,0,0
0,0,1b,2x,2u,21,2w,22,23,2v,24,2u,2x,1a,0,0
0,0,1b,2x,2u,25,26,2u,2u,27,28,2u,2x,1a,0,0
0,0,1b,2x,29,2a,2b,2c,2c,2d,2e,2f,2x,1a,0,0
0,0,1b,2x,2g,2h,0,0,0,0,2i,2j,2x,1a,0,0
0,0,2k,2l,2m,2n,2o,2p,2p,2q,2r,2s,2l,2t,0,0
0,0,0,0,19,2u,2u,2u,2u,2u,2u,1f,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME apple
ITM 10 5,10
ITM 10 6,10
ITM 10 7,10
ITM 10 8,10
ITM 10 9,10
ITM 10 10,10
PAL 5

ROOM 13
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,10,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,11,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME sleep2
ITM 2 13,6
ITM 3j 12,3
EXT 6,9 14 11,3
EXT 8,9 14 13,3
PAL 6

ROOM 14
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME app1
ITM 4 12,4
ITM 4 12,3
EXT 10,5 15 8,5
PAL 0

ROOM 15
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,u,b,0,a,0,q,0,c,0
0,0,0,0,0,0,a,0,0,c,a,0,r,0,c,0
0,0,0,0,0,0,s,0,0,t,s,0,0,0,c,0
0,0,0,0,0,0,a,0,0,c,a,0,0,0,c,0
0,0,0,0,0,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME app2
ITM 4 12,4
ITM 4 12,3
ITM 5 7,3
EXT 9,5 15 11,5
EXT 10,5 15 8,5
EXT 6,5 16 4,5
PAL 0

ROOM 16
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,36,c,a,0,0,c,a,0,r,0,c,0
35,37,34,36,0,t,s,0,0,t,s,0,0,0,c,0
31,32,33,0,36,c,a,0,0,c,a,0,0,0,c,0
30,2z,2y,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME app3
ITM 11 3,4
ITM 12 3,5
ITM 13 3,6
ITM 14 3,7
ITM 17 0,4
ITM 18 2,4
ITM 16 1,4
EXT 5,5 17 7,5
PAL 4

ROOM 17
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,35,37,34,0,c,a,0,0,c,a,0,r,0,c,0
0,31,32,33,0,t,s,0,0,t,s,0,0,0,c,0
0,30,2z,2y,0,c,a,0,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c1
ITM 14 4,6
ITM 12 4,4
ITM 11 4,3
ITM 16 2,3
ITM 17 1,3
ITM 18 3,3
ITM 13 4,5
ITM 31 6,5
ITM 3c 7,3
EXT 7,4 18 7,4
EXT 8,5 18 8,5
EXT 7,6 18 7,6
PAL 4

ROOM 18
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,35,37,34,0,0,u,b,0,a,0,q,0,c,0
0,0,31,32,33,0,a,0,0,c,a,0,r,0,c,0
0,0,30,2z,2y,t,s,0,0,t,s,0,0,0,c,0
0,0,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c2
ITM 17 2,2
ITM 11 5,2
ITM 12 5,3
ITM 13 5,4
ITM 14 5,5
ITM 16 3,2
ITM 18 4,2
ITM 31 6,5
ITM 3c 7,3
EXT 7,5 19 7,5
EXT 8,4 19 8,4
EXT 8,6 19 8,6
EXT 9,5 19 11,5
PAL 4

ROOM 19
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,u,b,0,a,0,q,0,c,0
0,0,0,35,37,34,a,36,0,c,a,0,r,0,c,0
0,0,0,31,32,33,36,0,0,t,s,0,0,0,c,0
0,0,0,30,2z,2y,a,36,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c3
ITM 11 6,3
ITM 12 6,4
ITM 13 6,5
ITM 14 6,6
ITM 16 4,3
ITM 17 3,3
ITM 18 5,3
ITM 31 10,5
EXT 8,5 1a 8,5
EXT 11,4 1a 11,4
EXT 12,5 1a 12,5
EXT 11,6 1a 11,6
PAL 4

ROOM a
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,16,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 13,5
ITM 2 13,6
ITM 3 7,10
EXT 7,8 7 7,9
EXT 6,9 b 7,9
EXT 7,10 4 13,6
PAL 6

ROOM b
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 12,5
ITM 2 13,6
ITM 4 7,8
EXT 8,9 a 7,9
EXT 6,9 c 7,9
EXT 7,10 e 7,9
PAL 6

ROOM c
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 11,5
ITM 2 13,6
EXT 7,8 9 7,9
EXT 8,9 b 7,9
EXT 7,10 d 7,9
PAL 6

ROOM d
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,16,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 11,6
ITM 2 13,6
EXT 7,8 c 7,9
EXT 8,9 e 7,9
PAL 6

ROOM e
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,0,0
0,0,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,r,0,c,0
0,0,0,0,0,0,0,0,0,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,a,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME dress
ITM 1 12,6
ITM 3 8,9
ITM 2 13,6
EXT 6,9 d 7,9
EXT 7,8 b 7,9
EXT 8,9 4 13,6
PAL 6

ROOM f
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 3b
ITM 0 2,5
ITM 5 7,3
ITM 4 12,4
ITM 4 12,3
EXT 5,5 f 7,5
EXT 6,5 f 4,5
EXT 9,5 f 11,5
EXT 10,5 f 8,5
EXT 3,7 1 3,9
PAL 0

ROOM g
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 5b
ITM c 2,5
EXT 10,10 h 8,10
PAL 0

ROOM h
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM 8 14,10
ITM a 9,10
ITM c 2,5
EXT 7,10 i 7,10
EXT 8,11 i 8,11
PAL 0

ROOM i
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM 8 13,10
ITM a 9,10
ITM c 2,5
ITM 35 6,9
EXT 6,10 j 6,10
EXT 7,11 j 7,11
PAL 0

ROOM j
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM 8 12,10
ITM a 9,10
ITM c 2,5
ITM 35 6,9
ITM 35 5,9
EXT 5,10 k 5,10
EXT 6,11 k 6,11
PAL 0

ROOM k
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM 8 12,11
ITM a 9,10
ITM c 2,5
ITM 35 5,9
ITM 35 6,9
EXT 4,10 l 4,10
EXT 5,11 l 5,11
EXT 5,12 l 5,12
PAL 0

ROOM l
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM 8 12,12
ITM a 9,10
ITM c 2,5
ITM 35 5,9
ITM 35 6,9
EXT 4,9 m 4,9
EXT 3,10 m 3,10
EXT 4,11 m 4,11
EXT 4,12 m 4,12
PAL 0

ROOM m
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM a 9,10
ITM c 2,5
ITM 35 5,9
ITM 35 6,9
EXT 3,9 n 3,9
PAL 0

ROOM n
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM a 9,10
ITM c 2,5
ITM 1d 12,12
ITM 35 5,9
ITM 35 6,9
EXT 3,8 o 3,6
PAL 0

ROOM o
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM b 3,7
ITM c 2,5
ITM b 5,5
ITM 1d 12,11
EXT 3,5 p 3,5
EXT 2,6 p 2,6
EXT 4,6 p 4,6
PAL 0

ROOM p
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM b 3,7
ITM c 2,5
ITM b 5,5
ITM 1d 12,10
EXT 4,5 q 4,5
EXT 3,6 q 3,6
EXT 3,4 q 3,4
PAL 0

ROOM q
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME awake
ITM b 3,7
ITM c 2,5
ITM b 5,5
ITM 1d 11,10
PAL 0

ROOM r
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,b,u,b,o,p,b,b,0,0,b,b,b,b,0
0,a,0,0,0,m,n,0,0,c,a,0,0,g,i,c
0,a,0,0,0,0,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,0,0,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,9g,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME getapples
ITM d 2,5
ITM 4 12,4
ITM 4 12,3
EXT 10,10 r 8,10
EXT 9,10 r 11,10
EXT 3,7 r 3,9
EXT 3,8 r 3,6
EXT 5,5 r 7,5
EXT 6,5 r 4,5
EXT 9,5 r 11,5
EXT 10,5 r 8,5
EXT 7,3 10 7,14
PAL 0

ROOM 1a
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,u,b,0,a,0,q,0,c,0
0,0,0,0,0,0,a,0,36,c,a,0,r,0,c,0
0,0,0,0,35,37,34,36,0,t,s,0,0,0,c,0
0,0,0,0,31,32,33,0,36,c,a,0,0,0,c,0
0,0,0,0,d,2z,2y,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c4
ITM 19 4,7
ITM 11 7,4
ITM 12 7,5
ITM 13 7,6
ITM 14 7,7
ITM 16 5,4
ITM 17 4,4
ITM 18 6,4
ITM 31 10,5
EXT 9,5 1b 11,5
EXT 11,3 1b 11,3
EXT 11,5 1b 11,5
EXT 12,6 1b 12,6
EXT 13,5 1b 13,5
PAL 4

ROOM 1b
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,0,b,0,a,0,q,0,c,0
0,0,0,0,0,35,37,34,0,c,a,0,r,0,c,0
0,0,0,0,0,31,32,33,0,t,s,0,0,0,c,0
0,0,0,0,0,30,2z,2y,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c5
ITM 11 8,3
ITM 12 8,4
ITM 13 8,5
ITM 14 8,6
ITM 18 7,3
ITM 16 6,3
ITM 17 5,3
ITM 31 10,5
EXT 13,4 1c 13,4
EXT 13,6 1c 13,6
EXT 12,5 1c 12,5
EXT 11,6 1c 11,6
EXT 11,4 1c 11,4
PAL 4

ROOM 1c
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,35,37,34,0,a,0,q,0,c,0
0,0,0,0,0,0,31,32,33,0,a,0,r,0,c,0
0,0,0,0,0,0,30,2z,2y,0,s,0,0,0,c,0
0,0,0,0,0,0,0,0,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c6
ITM 11 9,2
ITM 12 9,3
ITM 13 9,4
ITM 14 9,5
ITM 16 7,2
ITM 17 6,2
ITM 18 8,2
ITM 31 10,5
EXT 11,3 1d 11,3
EXT 11,5 1d 11,5
EXT 12,6 1d 12,6
EXT 13,5 1d 13,5
EXT 13,3 1d 13,3
PAL 4

ROOM 1d
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,0,0,0,a,0,q,0,c,0
0,0,0,0,0,0,0,35,37,34,a,0,r,0,c,0
0,0,0,0,0,0,0,31,32,33,s,0,0,0,c,0
0,0,0,0,0,0,0,30,2z,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c7
ITM 1a 9,6
ITM 18 9,3
ITM 17 7,3
ITM 16 8,3
ITM 14 10,6
ITM 13 10,5
ITM 12 10,4
ITM 11 10,3
ITM 3d 11,4
EXT 13,4 1e 13,4
EXT 13,6 1e 13,6
EXT 12,5 1e 12,5
EXT 11,6 1e 11,6
EXT 11,4 1u 8,10
PAL 4

ROOM 1e
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,0,35,37,34,0,q,0,c,0
0,0,0,0,0,0,0,0,31,32,33,0,r,0,c,0
0,0,0,0,0,0,0,0,30,2z,2y,0,0,0,c,0
0,0,0,0,0,0,0,0,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c8
ITM 14 11,5
ITM 13 11,4
ITM 12 11,3
ITM 11 11,2
ITM 18 10,2
ITM 16 9,2
ITM 17 8,2
ITM 3d 11,5
EXT 13,5 1f 13,5
EXT 13,3 1f 13,3
EXT 12,6 1f 12,6
EXT 11,5 1v 8,10
PAL 4

ROOM 1f
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,q,0,c,0
0,0,0,0,0,0,0,0,0,35,37,34,r,0,c,0
0,0,0,0,0,0,0,0,0,31,32,33,0,0,c,0
0,0,0,0,0,0,0,0,0,c,0,2y,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME c9
ITM 1b 10,6
ITM 19 9,6
ITM 18 11,3
ITM 17 9,3
ITM 16 10,3
ITM 14 12,6
ITM 13 12,5
ITM 12 12,4
ITM 11 12,3
ITM 3d 13,4
EXT 13,6 1g 13,6
EXT 13,4 1w 8,10
EXT 12,5 1w 8,10
EXT 11,6 1w 8,10
PAL 4

ROOM 1g
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,35,37,34,0,c,0
0,0,0,0,0,0,0,0,0,0,31,32,33,0,c,0
0,0,0,0,0,0,0,0,0,0,30,2z,2y,0,c,0
0,0,0,0,0,0,0,0,0,c,0,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME ca
ITM 18 12,2
ITM 17 10,2
ITM 16 11,2
ITM 14 13,5
ITM 13 13,4
ITM 12 13,3
ITM 11 13,2
ITM 3d 12,6
ITM 3d 13,5
EXT 12,6 1h 8,10
EXT 13,5 1h 8,10
PAL 4

ROOM 1h
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,35,37,34,0,0
0,0,0,0,0,0,0,0,0,0,0,31,32,33,0,0
0,0,0,0,0,0,0,0,0,c,0,30,2z,2y,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME cb
ITM 14 14,6
ITM 13 14,5
ITM 12 14,4
ITM 11 14,3
ITM 16 12,3
ITM 17 11,3
ITM 18 13,3
EXT 8,9 1i 8,10
EXT 7,10 1i 8,10
EXT 8,11 1i 8,10
EXT 9,10 1i 8,10
PAL 7

ROOM 1i
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,35,37,34,0
0,0,0,0,0,0,0,0,0,c,0,0,31,32,33,0
0,0,0,0,d,0,0,d,d,0,0,d,d,2z,2y,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME cc
ITM 19 12,7
ITM 18 14,4
ITM 17 12,4
ITM 16 13,4
ITM 14 15,7
ITM 13 15,6
ITM 12 15,5
ITM 11 15,4
EXT 8,9 1j 8,10
EXT 7,10 1j 8,10
EXT 8,11 1j 8,10
EXT 9,10 1j 8,10
PAL 7

ROOM 1j
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,c,0
0,0,0,0,0,0,0,0,0,0,0,0,0,35,37,34
0,0,0,0,0,0,0,0,0,0,0,0,0,31,32,33
0,0,0,0,0,0,0,0,0,c,0,0,0,30,2z,2y
0,0,0,0,d,0,0,d,d,0,0,d,d,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME cd
ITM 16 14,3
ITM 17 13,3
ITM 18 15,3
EXT 8,9 1k 8,10
EXT 7,10 1k 8,10
EXT 8,11 1k 8,10
EXT 9,10 1k 8,10
PAL 7

ROOM 1k
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,35,37
0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,32
0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,2z
0,0,0,0,0,0,0,0,0,c,0,0,0,0,0,0
0,0,0,0,d,0,0,d,d,0,0,d,d,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME ce
ITM 17 14,2
ITM 16 15,2
EXT 9,10 1l 8,10
EXT 8,9 1l 8,10
EXT 7,10 1l 8,10
EXT 8,11 1l 8,10
PAL 7

ROOM 1l
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,35
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31
0,0,0,0,0,0,0,0,0,c,0,0,0,0,0,30
0,0,0,0,d,0,0,d,d,0,0,d,d,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME cf
ITM 17 15,3
EXT 9,10 1m 8,10
EXT 8,9 1m 8,10
EXT 7,10 1m 8,10
EXT 8,11 1m 8,10
PAL 7

ROOM 1m
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,c,0,0,0,0,0,0
0,0,0,0,d,0,0,d,d,0,0,d,d,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME cg
ITM 32 7,10
ITM 32 8,11
ITM 32 9,10
ITM 32 8,9
PAL 7

ROOM 1n
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,c,0,0,0,0,0,0
0,0,0,0,d,0,0,d,d,0,0,d,d,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,b,0
0,0,0,0,0,0,0,0,16,0,a,0,0,g,i,c
0,0,0,0,0,0,0,16,15,16,s,0,0,9i,9j,c
0,0,0,0,0,0,0,0,0,0,a,14,0,0,0,c
0,0,0,0,0,0,0,0,0,0,a,13,0,j,0,c
0,0,0,0,0,0,0,0,0,0,a,12,0,h,w,c
0,0,0,0,0,0,0,0,0,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME sis
ITM 1c 14,9
EXT 8,11 1o 14,10
PAL 6

ROOM 1o
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,c,0,0,0,0,0,0
0,0,0,0,d,0,0,d,d,0,0,d,d,0,0,0
0,0,0,0,0,0,0,0,0,0,0,b,b,b,b,0
0,0,0,0,0,0,0,0,0,0,a,0,0,g,i,c
0,0,0,0,0,0,0,0,0,0,s,0,0,9i,9j,c
0,0,0,0,0,0,0,0,0,0,a,14,0,0,0,c
0,0,0,0,0,0,0,0,0,0,a,13,0,j,0,c
0,0,0,0,0,0,0,0,0,0,a,12,0,h,w,c
0,0,0,0,0,0,0,0,0,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME sis
EXT 10,10 1p 8,10
PAL 8

ROOM 1p
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,1g,1h,1i,1j,0,0,0,0,0,0,0,0,0,0
0,0,1k,1o,1o,1l,0,0,0,c,0,0,0,0,0,0
0,0,1c,1n,1d,1e,0,d,d,0,0,d,d,0,0,0
0,0,b,39,38,o,p,b,b,0,0,b,b,b,b,0
0,a,0,3,0,m,n,0,0,c,a,0,0,g,i,c
0,a,6,9m,9l,9k,0,0,0,t,s,0,0,9i,9j,c
0,a,0,0,0,0,0,0,0,c,a,14,0,0,0,c
0,a,9o,9n,0,0,l,k,0,c,a,13,0,j,0,c
0,a,0,l,k,k,k,k,0,c,a,12,0,h,w,c
0,0,d,d,d,d,d,d,d,0,0,d,d,d,d,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME maras
ITM 1i 3,9
ITM 1j 4,9
ITM 1i 3,8
ITM 1j 4,8
ITM o 3,7
ITM p 4,7
ITM q 5,7
ITM r 5,6
ITM s 5,5
ITM u 2,6
ITM v 2,5
ITM w 3,5
ITM x 4,5
ITM 1k 3,12
ITM 35 6,9
ITM 35 5,9
ITM 3f 3,8
ITM 3f 3,9
ITM 3g 3,10
ITM 3h 4,8
ITM 3h 4,9
ITM 3i 4,10
ITM t 2,7
EXT 9,10 1p 11,10
EXT 10,10 1p 8,10
END undefined 3,12
PAL 8

ROOM 1q
0,0,0,0,0,0,0,0,0,0,0,0,0,3a,3b,0
3c,0,0,0,0,0,3d,3e,3f,0,0,0,3g,3h,3i,3j
3k,3l,3c,0,0,0,3m,3n,3o,3p,0,0,3q,3r,9f,3s
3t,3t,3u,3v,0,0,3w,3x,3x,3y,3z,0,0,40,d,d
0,41,42,0,43,0,44,0,45,45,46,39,47,48,49,4a
4b,4c,4d,4e,4f,4g,4h,4i,4j,4k,4l,4m,4n,4o,4p,4q
0,4r,4s,4t,4u,4v,4w,4x,4y,4z,50,51,52,53,54,55
0,0,0,0,0,0,0,0,0,0,56,57,58,59,3s,0
0,0,0,5a,5b,5c,5d,5e,5f,5g,5h,5i,5j,5k,0,0
0,0,5l,5m,5n,5o,5p,0,5q,5r,5s,5t,5u,5v,0,0
0,0,5w,0,5x,5y,5z,60,61,62,3s,63,64,65,0,0
0,66,67,68,0,0,0,0,0,0,0,69,6a,6b,0,0
6c,6d,9f,9f,6e,6f,6g,0,0,0,0,6h,9f,6i,6j,6k
6l,9f,9f,9f,6m,9f,6n,6f,48,0,0,6o,9f,9f,6d,6p
6q,6r,9f,9f,9f,9f,9f,9f,6s,6t,0,6u,6v,6w,6w,6w
0,6x,6y,6w,6w,6w,6w,6w,6w,6z,70,0,0,0,0,0
NAME becky
ITM 1l 15,13
ITM 1m 3,15
ITM 1m 4,15
ITM 1m 6,15
ITM 1m 5,15
ITM 1m 7,15
ITM 1m 8,15
ITM 1m 15,14
ITM 1m 14,14
ITM 1m 13,14
ITM 1n 15,12
ITM 1o 14,12
ITM 1p 14,13
ITM 1p 1,12
ITM 1q 13,12
ITM 1r 9,15
ITM 1s 12,14
ITM 1t 2,15
ITM 1u 7,1
ITM 1u 13,11
ITM 1v 12,11
ITM 1x 1,11
ITM 1w 11,11
ITM 1y 3,11
ITM 1z 6,1
ITM 20 2,11
ITM 21 0,12
ITM 22 0,13
ITM 23 4,12
ITM 24 4,13
ITM 25 0,14
ITM 26 1,14
ITM 27 1,15
ITM 29 6,12
ITM 28 5,12
ITM 28 7,13
ITM 2a 6,13
ITM 2b 8,14
ITM 2c 9,14
ITM 2d 11,13
ITM 2e 11,14
ITM 2f 11,12
ITM 2g 6,2
ITM 2h 6,3
ITM 2i 7,3
ITM 2i 8,3
ITM 2j 9,3
ITM 2k 9,2
ITM 2l 8,2
ITM 2m 7,2
ITM 2n 13,2
ITM 2o 12,2
ITM 2p 12,1
ITM 2r 13,0
ITM 2s 14,0
ITM 2t 14,1
ITM 2q 13,1
ITM 2u 15,1
ITM 2v 15,2
ITM 2w 1,3
ITM 2w 0,3
ITM 2x 2,3
ITM 2y 2,2
ITM 2z 1,2
ITM 30 0,2
ITM 2y 0,1
ITM 33 5,1
ITM 33 4,0
ITM 33 3,1
ITM 33 4,2
PAL 3

ROOM 1r
0,0,0,0,0,0,0,0,0,0,0,0,0,3a,3b,0
3c,0,0,0,0,0,3d,3e,3f,0,0,0,3g,3h,3i,3j
3k,3l,3c,0,0,0,3m,3n,3o,3p,0,0,3q,3r,9f,3s
3t,3t,3u,3v,0,0,3w,3x,3x,3y,3z,0,0,40,d,d
0,0,0,8b,0,0,8c,46,b,0,0,8d,8e,8f,8g,0
0,0,8h,8i,8j,8k,8l,8m,8n,8o,8p,8q,8r,8s,8t,0
0,8u,8v,8w,8x,8y,8z,90,91,92,93,94,95,96,97,0
0,98,0,0,99,0,9a,9b,0,98,0,9c,9d,9e,0,0
0,0,0,5a,5b,5c,5d,5e,5f,5g,5h,5i,5j,5k,0,0
0,0,5l,5m,5n,5o,5p,0,5q,5r,5s,5t,5u,5v,0,0
0,0,5w,0,5x,5y,5z,60,61,62,3s,63,64,65,0,0
0,66,67,68,0,0,0,0,0,0,0,69,6a,6b,0,0
6c,6d,9f,9f,6e,6f,6g,0,0,0,0,6h,9f,6i,6j,6k
6l,9f,9f,9f,6m,9f,6n,6f,48,0,0,6o,9f,9f,6d,6p
6q,6r,9f,9f,9f,9f,9f,9f,6s,6t,0,6u,6v,6w,6w,6w
0,6x,6y,6w,6w,6w,6w,6w,6w,6z,70,0,0,0,0,0
NAME mara
ITM 1l 15,13
ITM 1m 3,15
ITM 1m 4,15
ITM 1m 6,15
ITM 1m 5,15
ITM 1m 7,15
ITM 1m 8,15
ITM 1m 15,14
ITM 1m 14,14
ITM 1m 13,14
ITM 1n 15,12
ITM 1o 14,12
ITM 1p 14,13
ITM 1p 1,12
ITM 1q 13,12
ITM 1r 9,15
ITM 1s 12,14
ITM 1t 2,15
ITM 1u 7,1
ITM 1u 13,11
ITM 1v 12,11
ITM 1x 1,11
ITM 1w 11,11
ITM 1y 3,11
ITM 1z 6,1
ITM 20 2,11
ITM 21 0,12
ITM 22 0,13
ITM 23 4,12
ITM 24 4,13
ITM 25 0,14
ITM 26 1,14
ITM 27 1,15
ITM 29 6,12
ITM 28 5,12
ITM 28 7,13
ITM 2a 6,13
ITM 2b 8,14
ITM 2c 9,14
ITM 2d 11,13
ITM 2e 11,14
ITM 2f 11,12
ITM 2g 6,2
ITM 2h 6,3
ITM 2i 7,3
ITM 2i 8,3
ITM 2j 9,3
ITM 2k 9,2
ITM 2l 8,2
ITM 2m 7,2
ITM 2n 13,2
ITM 2o 12,2
ITM 2p 12,1
ITM 2r 13,0
ITM 2s 14,0
ITM 2t 14,1
ITM 2q 13,1
ITM 2u 15,1
ITM 2v 15,2
ITM 2w 1,3
ITM 2w 0,3
ITM 2x 2,3
ITM 2y 2,2
ITM 2z 1,2
ITM 30 0,2
ITM 2y 0,1
EXT 4,2 1n 8,10
EXT 5,1 1n 8,10
EXT 4,0 1n 8,10
EXT 3,1 1n 8,10
PAL 3

ROOM 1s
0,0,0,0,0,0,0,0,0,0,0,0,0,3a,3b,0
3c,0,0,0,0,0,3d,3e,3f,0,0,0,3g,3h,3i,3j
3k,3l,3c,0,0,0,3m,3n,3o,3p,0,0,3q,3r,9f,3s
3t,3t,3u,3v,0,0,3w,3x,3x,3y,3z,0,0,40,d,d
0,41,42,0,43,0,44,0,45,45,46,39,47,48,49,4a
4b,4c,4d,4e,4f,4g,4h,4i,4j,4k,4l,4m,4n,4o,4p,4q
0,4r,4s,4t,4u,4v,4w,4x,4y,4z,50,51,52,53,54,55
0,0,0,0,0,0,0,0,0,0,56,57,58,59,3s,0
0,0,0,5a,5b,5c,5d,5e,5f,5g,5h,5i,5j,5k,0,0
0,0,5l,5m,5n,5o,5p,0,5q,5r,5s,5t,5u,5v,0,0
0,0,5w,0,5x,5y,5z,60,61,62,3s,63,64,65,0,0
0,66,67,68,0,0,0,0,0,0,0,69,6a,6b,0,0
6c,6d,9f,9f,6e,6f,6g,0,0,0,0,6h,9f,6i,6j,6k
6l,9f,9f,9f,6m,9f,6n,6f,48,0,0,6o,9f,9f,6d,6p
6q,6r,9f,9f,9f,9f,9f,9f,6s,6t,0,6u,6v,6w,6w,6w
0,6x,6y,6w,6w,6w,6w,6w,6w,6z,70,0,0,0,0,0
NAME becky2
ITM 1l 15,13
ITM 1m 3,15
ITM 1m 4,15
ITM 1m 6,15
ITM 1m 5,15
ITM 1m 7,15
ITM 1m 8,15
ITM 1m 15,14
ITM 1m 14,14
ITM 1m 13,14
ITM 1n 15,12
ITM 1o 14,12
ITM 1p 14,13
ITM 1p 1,12
ITM 1q 13,12
ITM 1r 9,15
ITM 1s 12,14
ITM 1t 2,15
ITM 1u 7,1
ITM 1u 13,11
ITM 1v 12,11
ITM 1x 1,11
ITM 1w 11,11
ITM 1y 3,11
ITM 1z 6,1
ITM 20 2,11
ITM 21 0,12
ITM 22 0,13
ITM 23 4,12
ITM 24 4,13
ITM 25 0,14
ITM 26 1,14
ITM 27 1,15
ITM 29 6,12
ITM 28 5,12
ITM 28 7,13
ITM 2a 6,13
ITM 2b 8,14
ITM 2c 9,14
ITM 2d 11,13
ITM 2e 11,14
ITM 2f 11,12
ITM 2g 6,2
ITM 2h 6,3
ITM 2i 7,3
ITM 2i 8,3
ITM 2j 9,3
ITM 2k 9,2
ITM 2l 8,2
ITM 2m 7,2
ITM 2n 13,2
ITM 2o 12,2
ITM 2p 12,1
ITM 2r 13,0
ITM 2s 14,0
ITM 2t 14,1
ITM 2q 13,1
ITM 2u 15,1
ITM 2v 15,2
ITM 2w 1,3
ITM 2w 0,3
ITM 2x 2,3
ITM 2y 2,2
ITM 2z 1,2
ITM 30 0,2
ITM 2y 0,1
ITM 34 5,1
ITM 34 4,0
ITM 34 3,1
ITM 34 4,2
PAL 3

ROOM 1u
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,0,35,37,34,0,q,0,c,0
0,0,0,0,0,0,0,0,31,32,33,0,r,0,c,0
0,0,0,0,0,0,0,0,30,2z,2y,0,0,0,c,0
0,0,0,0,0,0,0,0,0,c,a,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME d8
ITM 11 11,2
ITM 12 11,3
ITM 13 11,4
ITM 14 11,5
ITM 16 9,2
ITM 17 8,2
ITM 18 10,2
EXT 9,10 1v 8,10
EXT 8,9 1v 8,10
EXT 7,10 1v 8,10
EXT 8,11 1v 8,10
PAL 7

ROOM 1v
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,b,b,b,0,0
0,a,0,0,0,0,0,0,0,0,0,0,q,0,c,0
0,0,0,0,0,0,0,0,0,35,37,34,r,0,c,0
0,0,0,0,0,0,0,0,0,31,32,33,0,0,c,0
0,0,0,0,0,0,0,0,0,c,0,2y,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME d9
ITM 18 11,3
ITM 19 9,6
ITM 1b 10,6
ITM 16 10,3
ITM 17 9,3
ITM 11 12,3
ITM 12 12,4
ITM 13 12,5
ITM 14 12,6
EXT 9,10 1w 8,10
EXT 8,9 1w 8,10
EXT 7,10 1w 8,10
EXT 8,11 1w 8,10
PAL 7

ROOM 1w
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,0,0,0,0,0,0,0,0,0,0,b,0,0
0,a,0,0,0,0,0,0,0,0,35,37,34,0,c,0
0,0,0,0,0,0,0,0,0,0,31,32,33,0,c,0
0,0,0,0,0,0,0,0,0,0,30,2z,2y,0,c,0
0,0,0,0,0,0,0,0,0,c,0,0,0,0,c,0
0,0,0,0,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME da
ITM 11 13,2
ITM 12 13,3
ITM 13 13,4
ITM 14 13,5
ITM 16 11,2
ITM 17 10,2
ITM 18 12,2
EXT 9,10 1h 8,10
EXT 8,9 1h 8,10
EXT 7,10 1h 8,10
EXT 8,11 1h 8,10
PAL 7

ROOM 1x
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 3t
EXT 3,4 2 3,4
PAL 0

ROOM 1y
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,b,b,b,0,0,0,0,0,0,b,b,b,0,0
0,a,x,y,z,c,0,u,b,0,a,0,q,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,r,0,c,0
0,a,0,0,0,t,s,0,0,t,s,0,0,0,c,0
0,a,0,0,0,c,a,0,0,c,a,0,0,0,c,0
0,0,d,v,d,0,0,d,d,0,0,d,d,d,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
NAME 3u
EXT 3,6 2 3,6
PAL 0

TIL 1
00101000
00101000
00001000
00000000
00000000
00000000
00000000
00000000
NAME trunks 1

TIL 2
00111100
00111100
00111100
00111100
00111100
00111100
00111100
00111100
NAME trunks 2
WAL true

TIL 3
00101000
00101000
00101000
00101000
00101000
00101000
00101000
00101000
NAME trunks 3
WAL true

TIL 4
00111100
01111100
01111100
01111110
01101110
01101111
01100111
01111111
NAME trunks 4

TIL 5
00000000
00000000
00000000
00000000
00000000
00000000
10000000
11100000
NAME trunks 5

TIL 6
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00000111
NAME trumk
COL 2

TIL 7
00101000
00111000
00111000
01111100
01111100
11011100
10011111
11111111
NAME trunks 7
WAL true

TIL 8
00111100
01111100
01111100
01111110
11101110
11101111
11100111
11111111
NAME trunks 8
WAL true

TIL 9
00111100
01111100
01111100
01111110
11101110
11101110
11100110
11111110
NAME trunks 9

TIL 10
00000000
01111110
10111101
10111101
10000001
10000001
11111111
10000001

TIL 11
10000001
10000001
10000001
10000001
10000001
01111110
00000000
00000000

TIL 12
00001000
11110000
00001000
00001000
00001000
00001000
00001000
00001000
WAL true

TIL 13
00001000
00001000
11110000
00001000
00001000
00001000
00001000
00001000
WAL true

TIL 14
00000000
00000000
00000000
11110000
00001000
00001000
00001000
00001000
WAL true

TIL 15
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 16
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
WAL true

TIL 17
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 18
00101000
00111000
00111000
01111100
01111100
01011100
00011111
01111111
NAME trunks 10

TIL 19
00111111
00111111
00111111
00111111
00111111
00111111
00111111
00111111
NAME bapp
WAL true
COL 5

TIL 20
11111111
11111111
11111111
11111111
11111111
11111111
01111111
01111111
NAME bapp
COL 5

TIL 21
11111110
11111110
11111110
11111110
11111110
11111111
11111111
11111111
NAME bapp
COL 5

TIL 22
00111111
00111111
00111111
00111111
00111111
01111111
01111111
01111111
NAME bapp
COL 5

TIL 23
11111100
11111100
11111100
11111100
11111100
11111110
11111110
11111110
NAME bapp
COL 5

TIL 24
01111111
01111111
01111111
01111111
01111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 25
11111111
11111111
11111111
11011111
11011111
10001111
10001111
00000111
NAME bapp
COL 5

TIL 26
10000000
11000001
11100011
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 27
00000001
10000011
11000111
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 28
11111111
11111111
11111111
11111011
11111011
11110001
11110001
11100000
NAME bapp
COL 5

TIL 29
11111111
11111111
11111110
11111110
11111110
11111110
11111110
11111110
NAME bapp
COL 5

TIL 30
00111111
00000011
00000011
00000011
00000011
00000000
00000000
00000000
NAME bapp
COL 5

TIL 31
00111000
00111000
00111000
00111000
00111100
00111100
00111110
00111111
NAME bapp
COL 5

TIL 32
11111111
01111111
00011111
00000000
00000000
00000000
00000000
10000000
NAME bapp
COL 5

TIL 33
11111111
11111110
11111000
00000000
00000000
00000000
00000000
00000001
NAME bapp
COL 5

TIL 34
11111111
11111001
11110000
11110110
11110110
11110000
11111001
11111111
NAME bapp
COL 5

TIL 35
00111111
00111111
00111111
00111111
00111111
00111111
00111111
00111101
NAME bapp
COL 5

TIL 36
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME empty
WAL true

TIL 37
11111111
11110011
11100001
11101101
11101101
11100001
11110011
11111111
NAME bapp
COL 5

TIL 38
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00001111
WAL true

TIL 39
00000000
00000000
00000000
00000000
00000000
00000000
00000000
10000000

TIL 40
00000011
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 27

TIL 41
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000011
NAME becky 28

TIL 42
00000000
00000000
00000000
00000000
00000000
00000000
00000000
11111000
NAME becky 29

TIL 43
00000000
00000000
00000000
00000000
00000000
00000000
00011100
01111110
NAME becky 30

TIL 44
00000000
00000000
00000000
00000000
00000000
00000000
00000000
01111111
NAME becky 31

TIL 45
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00110000
NAME becky 32

TIL 46
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000001
NAME becky 33

TIL 47
00000000
00000000
00000000
00000000
00000000
00000001
00000011
00100011
NAME becky 34

TIL 48
00000000
00000000
00000000
00000000
00000000
00000000
10000000
10000000
NAME becky 35

TIL 49
00000000
00000000
00000000
00000000
00000000
00000000
00000011
00011111
NAME becky 36

TIL 50
11100000
11000001
11000011
10000110
11111000
11100001
10000011
00000110
NAME becky 63

TIL 51
11000111
10000111
00011111
01111110
11001100
10011100
00111000
00110000
NAME becky 64

TIL 52
01100000
11000000
00000000
00000000
00000000
00000000
00000000
00000001
NAME becky 65

TIL 53
00000111
00000000
00000000
00000000
00000000
00000000
11000001
10111111
NAME becky 66

TIL 54
11111111
00000011
00000000
00000000
00000011
00011110
11111100
11110000
NAME becky 67

TIL 55
11100000
11100000
11100000
11000000
10000000
00000000
00000000
00000000
NAME becky 68

TIL 56
00000100
00001100
00001111
00001110
00000000
00000000
00000000
00000000
NAME becky 69

TIL 57
01100000
11000000
10000000
00000000
00000000
00000000
00000000
00000000
NAME becky 70

TIL 58
00000011
00000011
00000011
00000000
00000000
00000000
00000000
00000000
NAME becky 71

TIL 59
11111111
11111100
10000000
00000000
00000000
00000000
00000000
00000000
NAME becky 72

TIL 60
00000000
00000001
00000001
00000001
00000001
00000011
00000011
00000011
NAME becky 99

TIL 61
11111110
11110000
11000000
11000000
10000000
10000000
10000000
00000000
NAME becky 100

TIL 62
00000001
00000001
00000010
00000000
00000000
00000000
00000000
00000000
NAME becky 101

TIL 63
01111000
00010000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 102

TIL 64
11111111
00111111
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 103

TIL 65
11110000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 104

TIL 66
00000000
00000000
00000000
00000000
00000011
00001100
00010000
01100000
NAME becky 105

TIL 67
00000000
00000000
00000000
01111111
10000000
00000000
00000000
00000000
NAME becky 106

TIL 68
00000000
00000000
00000000
00000000
11100000
00011000
00000100
00000011
NAME becky 107

TIL 69
00000000
00000000
00000000
00000000
00000001
00000110
00001000
00010000
NAME becky 108

TIL 70
00000000
00000000
11100000
11111000
00000000
00000000
00000000
00000000
NAME becky 135

TIL 71
00000000
00000000
00000000
00000000
00000000
00000000
00000111
00011111
NAME becky 136

TIL 72
00000000
00000000
00000000
00000000
00000000
00000000
11000000
11110000
NAME becky 137

TIL 73
00000000
00000000
00000000
00000000
00000000
00000000
10000000
11000000
NAME becky 138

TIL 74
00000000
00000000
00000000
00000000
00000111
00011111
00111111
01111111
NAME becky 139

TIL 75
00000000
00000000
00000000
00000000
11000000
11110000
11111000
11111101
NAME becky 140

TIL 76
00000000
00000000
00000000
00000001
00000001
00000011
00000011
00000011
NAME becky 141

TIL 77
00111111
01111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME becky 142

TIL 78
11111000
11111100
11111110
11111111
11111111
11111111
11111111
11111111
NAME becky 143

TIL 79
00000000
00000000
00111100
11111111
11111111
11111111
11111111
11111111
NAME becky 144

TIL 80
11110000
11110000
11111000
11111000
11111111
11111111
11111111
11111111
NAME becky 171

TIL 81
11111111
11111111
01111111
01111111
01111111
00111111
00111111
00011111
NAME becky 172

TIL 82
00000111
00000111
00000011
00000011
00000001
00000000
00000000
00000000
NAME becky 173

TIL 83
11111111
11111111
11111111
11111111
11111111
11111111
11111111
01111111
NAME becky 174

TIL 84
11000000
11011110
11111111
11111111
11111111
11111111
11111111
11111111
NAME becky 175

TIL 85
00000000
00000000
10000000
11000000
11000000
11100000
11100000
11110000
NAME becky 176

TIL 86
00001111
00000111
00000001
00000000
00000000
00000000
00000000
00000000
NAME becky 177

TIL 87
11111111
11111111
11111111
00111111
00000000
00000000
00000000
00000000
NAME becky 178

TIL 88
00011111
00001111
00000011
00000000
00000000
00000000
00000000
00000000
NAME becky 179

TIL 89
11111111
11111111
11111111
01111111
00000000
00000000
00000000
00000000
NAME becky 180

TIL 90
00000100
00001101
00001000
00011000
00110000
00110000
01100000
01100000
NAME mara 26

TIL 91
11000000
11000000
11100000
11110000
11111000
01111111
00011110
00000000
NAME mara 27

TIL 92
00000000
00000011
00000111
01000001
11000001
10000011
00000111
00000110
NAME mara 28

TIL 93
00110000
11111111
11111111
10000000
10000000
00000000
00000000
00000000
NAME mara 29

TIL 94
11100000
11110000
11100000
11100000
11100000
01110000
01110000
00000000
NAME mara 30

TIL 95
00000011
00000000
00000000
00000000
00000000
00000000
01100000
11011111
NAME mara 31

TIL 96
11111111
00000001
00000000
00000000
00000001
00001111
11111110
11111000
NAME mara 32

TIL 97
11110000
11110000
01110000
01100000
11000000
00000000
00000000
00000000
NAME mara 33

TIL 98
00001100
00001100
00001000
00000000
00000000
00000000
00000000
00000000
NAME mara 34

TIL 99
00000110
00000110
00000100
00000000
00000000
00000000
00000000
00000000
NAME mara 35

TIL a
00000001
00000001
00000001
00000001
00000001
00000001
00000001
00000001
WAL true

TIL b
00000000
00000000
00000000
00000000
00000000
00000000
00000000
11111111
WAL true

TIL c
10000000
10000000
10000000
10000000
10000000
10000000
10000000
10000000
WAL true

TIL d
11111111
00000000
00000000
00000000
00000000
00000000
00000000
00000000
WAL true

TIL e
11111111
00000000
00000000
00000000
00000000
00000000
00000000
11111111

TIL f
10000001
10000001
10000001
10000001
10000001
10000001
10000001
10000001

TIL g
00000000
00011111
00100000
00100000
00100000
00100000
00100000
00100000

TIL h
10000001
11111111
10000001
10111101
10111101
10111101
01111110
00000000
WAL true

TIL i
00000000
11111100
01000010
01001110
01001110
01001110
01001110
01000010

TIL j
01111110
10000001
10000001
10000001
10000001
10000001
10000001
10000001
WAL true

TIL k
11111110
00000001
00000001
00000001
00000001
00000001
00000001
00000001
WAL true

TIL l
00000000
00000001
00000001
00000001
00000001
00000001
00000001
00000001

TIL m
00100000
00100000
00100000
00100000
00011111
00001100
00000000
00000000

TIL n
00000100
00000100
00000100
00000100
11111000
00110000
00000000
00000000
WAL false

TIL o
00000000
00000000
00000000
00000000
00000000
00011111
00100000
11100000

TIL p
00000000
00000000
00000000
00000000
00000000
11111000
00000100
00000111

TIL q
00000000
01111110
10111101
10111101
10111101
10000001
10000001
10000001

TIL r
10001111
11110001
10000001
10000001
10000001
01111110
00000000
00000000

TIL s
00000001
00000000
00000000
00000000
00000000
00000000
00000000
00000001

TIL t
10000000
00000000
00000000
00000000
00000000
00000000
00000000
10000000

TIL u
00000000
00000000
00000000
00000000
00000000
00000000
00000000
10000001

TIL v
10000001
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL w
00000000
00111100
00100100
00100100
00100100
00111100
00000000
00000000

TIL x
00000001
01110001
01010001
01110101
00000101
00001101
00000001
11111110
WAL true

TIL y
00000000
01101110
01101110
00000000
01110110
01110110
00000000
11111111
WAL true

TIL z
10000000
10001100
10001100
10100000
10010010
10110010
10000000
01111111
WAL true

TIL 1c
11000000
01000000
01100000
00110000
00011000
00001110
00000011
00000000
NAME crowns 2
WAL true
COL 3

TIL 1d
00000000
00000000
00000000
00000000
00000000
00000001
00000111
11111111
NAME crowns 3
WAL true
COL 3

TIL 1e
00001111
00011110
00011110
00111100
01111000
11110000
11000000
00000000
NAME crowns 4
WAL true
COL 3

TIL 1g
00000000
00000001
00000111
00001100
00011000
00110000
00100000
01100000
NAME crowns 6
WAL true
COL 3

TIL 1h
00111111
11100000
00000000
00000000
00000000
00000000
00000000
00000000
NAME crowns 7
WAL true
COL 3

TIL 1i
11111100
00001111
00000011
00000000
00000000
00000000
00000000
00000000
NAME crowns 8
WAL true
COL 3

TIL 1j
00000000
10000000
11100000
11110000
01111000
00111100
00111100
00011110
NAME crowns 9
WAL true
COL 3

TIL 1k
01000000
11000000
10000000
10000000
10000000
10000000
10000000
10000000
NAME crowns 10
WAL true
COL 3

TIL 1l
00011111
00001111
00001111
00001111
00001111
00001111
00001111
00001111
NAME crowns 11
WAL true
COL 3

TIL 1n
00000000
00000000
00000000
00000000
00000000
00000000
10000000
11111111
NAME crowns
WAL true
COL 3

TIL 1o
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME lg
WAL true
COL 4

TIL 1a
11000000
11000000
11000000
11000000
11000000
11000000
11000000
11000000
NAME bapp
WAL false
COL 5

TIL 1b
00000011
00000011
00000011
00000011
00000011
00000011
00000011
00000011
NAME bapp
COL 5

TIL 1f
11111100
11111100
11111100
11111100
11111100
11111100
11111100
11111100
NAME bapp
WAL true
COL 5

TIL 1m
00000000
00000000
00000000
00000000
00000011
00000011
00000011
00000011
NAME bapp
COL 5

TIL 1p
00000000
00000000
00000000
00000000
11111111
11111111
11111111
11111111
NAME bapp
WAL true
COL 5

TIL 1q
00111111
00111111
00111111
00111111
11111111
11111111
11111111
11111111
NAME bapp
WAL true
COL 5

TIL 1r
11000000
11000000
11000000
11000000
11111111
11111111
11111111
11111111
NAME bapp
WAL true
COL 5

TIL 1s
00000011
00000011
00000011
00000011
11111111
11111111
11111111
11111111
NAME bapp
WAL true
COL 5

TIL 1t
11111100
11111100
11111100
11111100
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 1u
00000000
00000000
00000000
00000000
11000000
11000000
11000000
11000000
NAME bapp
COL 5

TIL 1v
11111111
11111111
11111111
11111111
11111111
11111111
11111110
11111110
NAME bapp
COL 5

TIL 1w
11100011
11000001
10000000
00000000
00000000
00000000
00000000
00011100
NAME bapp
COL 5

TIL 1x
11111111
11111111
11111111
01111111
01111111
01111111
00111111
00111111
NAME bapp
COL 5

TIL 1y
11111111
11111111
11111111
11111110
11111110
11111110
11111100
11111100
NAME bapp
COL 5

TIL 1z
11000111
10000011
00000001
00000000
00000000
00000000
00000000
00111000
NAME bapp
COL 5

TIL 2a
00000111
00000011
00000011
00000000
00000000
00000000
00000000
00000000
NAME bapp
COL 5

TIL 2b
11111111
11111111
11111111
11111111
00011111
00011111
00000000
00000000
NAME bapp
COL 5

TIL 2c
11111111
11111111
11111111
11111111
11111111
11111111
11111111
00000000
NAME bapp
COL 5

TIL 2d
11111111
11111111
11111111
11111111
11111000
11111000
00000000
00000000
NAME bapp
COL 5

TIL 2e
11100000
11000000
11000000
00000000
00000000
00000000
00000000
00000000
NAME bapp
COL 5

TIL 2f
11111111
11111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME bapp
COL 5

TIL 2g
11111110
11111110
11111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2h
00000000
00000000
00000000
00000000
10000000
11000000
11100000
11110000
NAME bapp
COL 5

TIL 2i
00000000
00000000
00000000
00000000
00000001
00000011
00000111
00001111
NAME bapp
COL 5

TIL 2j
01111111
01111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2k
00000011
00000011
00000011
00000011
00000000
00000000
00000000
00000000
NAME bapp
COL 5

TIL 2l
11111111
11111111
11111111
11111111
00000000
00000000
00000000
00000000
NAME bapp
WAL true
COL 5

TIL 2m
11111111
11111111
11111111
11111111
00111111
00111111
00111111
00111111
NAME bapp
COL 5

TIL 2n
11111100
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2o
00000000
10000000
11111100
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2p
00000000
00000000
00000000
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2q
00000000
00000001
00111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2r
00111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
COL 5

TIL 2s
11111111
11111111
11111111
11111111
11111100
11111100
11111100
11111100
NAME bapp
COL 5

TIL 2t
11000000
11000000
11000000
11000000
00000000
00000000
00000000
00000000
NAME bapp
COL 5

TIL 2u
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
WAL false
COL 5

TIL 2v
01111100
01111100
01111100
01111100
01111100
00111000
00000000
00000000
NAME bapp
COL 5

TIL 2w
00111110
00111110
00111110
00111110
00111110
00011100
00000000
00000000
NAME bapp
COL 5

TIL 2x
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME bapp
WAL true
COL 5

TIL 2y
00001111
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME bapp
COL 5

TIL 2z
11110000
11111111
11111111
11111111
11111111
00000000
00000000
00000000
NAME bapp
COL 5

TIL 3a
00000000
00000000
00000000
00000000
00000000
00000000
00000111
00011000
NAME becky 1

TIL 3b
00000000
00000000
00000000
00000000
00000000
00000000
11000000
00110000
NAME becky 2

TIL 3c
00000000
00000000
00000000
00000000
00000000
00000000
10000000
01000000
NAME becky 3

TIL 3d
00000000
00000000
00000000
00000000
00000111
00011000
00100000
01000000
NAME becky 4

TIL 3e
00000000
00000000
00000000
00000000
11000000
00110000
00001000
00000101
NAME becky 5

TIL 3f
00000000
00000000
00000000
00000000
00000000
00000000
00000000
11100000
NAME becky 6

TIL 3g
00000000
00000000
00000000
00000001
00000001
00000010
00000010
00000010
NAME becky 7

TIL 3h
00100000
01000000
10000000
00000000
00000000
00000000
00000000
00000000
NAME becky 8

TIL 3i
00001000
00000100
00000010
00000001
00000001
00000000
00000000
00000000
NAME becky 9

TIL 3j
00000000
00000000
00111100
11000011
00000000
10000000
10000000
10000000
NAME becky 10

TIL 3k
00100000
00100111
00011000
00010000
00010000
00000000
00000000
00000000
NAME becky 11

TIL 3l
00000000
10000000
01100000
00010000
00010000
00001111
00001000
00001000
NAME becky 12

TIL 3m
01000000
10000000
10000000
10000000
10000000
10000000
01000000
01000000
NAME becky 13

TIL 3n
00000110
00000010
00000010
00000010
00000000
00000000
00000000
00000000
NAME becky 14

TIL 3o
00011000
00000100
00000100
00000011
00000010
00000000
00000000
00000000
NAME becky 15

TIL 3p
00000000
00000000
00000000
11000000
00100000
00010000
00011100
00010010
NAME becky 16

TIL 3q
00000010
00000010
00000001
00000001
00000000
00000000
00000000
00000000
NAME becky 17

TIL 3r
00000000
00000000
00000000
00000000
10000000
01000000
00100000
00011100
NAME becky 18

TIL 3s
10000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 19

TIL 3t
00000000
00000000
00000000
00000000
00000000
11111111
00000000
00000000
NAME becky 20

TIL 3u
01000000
00100000
00011000
00000100
00000011
11111111
00000000
00000000
NAME becky 21

TIL 3v
00000000
00000000
00000000
00000000
00000000
11000000
00000000
00000000
NAME becky 22

TIL 3w
00100000
00011000
00000111
00000000
00000000
00000000
00000000
00000000
NAME becky 23

TIL 3x
00000000
00000000
11111111
00000000
00000000
00000000
00000000
00000000
NAME becky 24

TIL 3y
00000010
00000001
11111111
00000000
00000000
00000000
00000000
00000000
NAME becky 25

TIL 3z
00000000
10000000
11100000
00000000
00000000
00000000
00000000
00000000
NAME becky 26

TIL 4a
00000000
00000000
00000000
00000000
00000000
00000000
11100000
11100000
NAME becky 37

TIL 4b
00000000
00000000
00000011
00000110
00000000
00000000
00000000
00000000
NAME becky 38

TIL 4c
00111111
11111111
11100000
00000001
00000011
00000011
00000111
00000111
NAME becky 39

TIL 4d
11111100
11111110
10011110
11001110
10001100
10011000
00110000
01111000
NAME becky 40

TIL 4e
00000000
00000000
00000000
00000000
00000000
00000001
00000111
00011110
NAME becky 41

TIL 4f
11100110
11110000
11110000
01111000
00111100
11111100
11111100
00000000
NAME becky 42

TIL 4g
00000011
00000110
00001000
00010000
00100000
01100000
11100000
11100000
NAME becky 43

TIL 4h
11111111
00000011
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 44

TIL 4i
10000000
00000000
00000000
00000001
00000001
00000011
00000011
00000011
NAME becky 45

TIL 4j
01100000
11100001
11100011
11000110
11001100
10011000
10110000
11100000
NAME becky 46

TIL 4k
01110000
11100000
10000000
00000000
00000000
00000000
00000000
00000000
NAME becky 47

TIL 4l
00000111
00001111
00001111
00011110
00011100
00111000
01110000
01100000
NAME becky 48

TIL 4m
10000000
00000001
00000011
00000111
00001101
00011011
00110011
01100011
NAME becky 49

TIL 4n
11100011
11100011
11000001
11000000
11000000
10000000
10000000
10000000
NAME becky 50

TIL 4o
10000000
00000011
00000111
00001100
00010000
00110000
00111111
00001111
NAME becky 51

TIL 4p
11111111
11110000
00000000
00000000
00000000
00000000
11111111
11111111
NAME becky 52

TIL 4q
11000000
10000000
00000000
00000000
00000000
00000000
00000000
11000000
NAME becky 53

TIL 4r
00000111
00001100
00001100
00011100
00011000
00011100
00111111
00001111
NAME becky 54

TIL 4s
11111110
00001111
00000111
00000111
00001110
00011100
11110000
10000000
NAME becky 55

TIL 4t
00111000
00111000
00111000
00111100
00011111
00011111
00000111
00000000
NAME becky 56

TIL 4u
00000000
00000000
00000000
00000000
00000000
11111110
11110000
00000000
NAME becky 57

TIL 4v
11100000
11110000
11111000
01111100
00111110
00011111
00000111
00000000
NAME becky 58

TIL 4w
00000000
00000000
00000000
00000001
00001111
11111100
11100000
00000000
NAME becky 59

TIL 4x
00000111
00000111
00001110
00001110
10011110
00011100
00011000
00000000
NAME becky 60

TIL 4y
11100000
11111000
01111000
00111100
00011110
00001111
00000111
00000000
NAME becky 61

TIL 4z
00000000
00000001
00000001
00010011
00110011
11100011
11000011
00000000
NAME becky 62

TIL 5a
00000000
00000000
00000000
00000000
00000000
00000001
00000011
00000111
NAME becky 73

TIL 5b
00000000
00000000
00010000
01110000
11110001
11110011
01100011
11100000
NAME becky 74

TIL 5c
00000000
00000000
00001111
01111111
11000000
10000000
00000000
00000000
NAME becky 75

TIL 5d
00000000
00000000
11100000
11111000
01111100
10011110
01001111
11000111
NAME becky 76

TIL 5e
00000000
00000000
00000000
00000111
00011100
00111000
00110000
00000000
NAME becky 77

TIL 5f
00000000
00000000
11111110
11111111
00000111
00001001
00000100
00001100
NAME becky 78

TIL 5g
00000000
00000000
00000000
10000000
11000000
11100000
11110000
01110000
NAME becky 79

TIL 5h
00000000
00000000
00000000
00000001
00000011
00000111
00001111
00011111
NAME becky 80

TIL 5i
00000000
01100000
11100000
11100000
11000000
10000000
10000000
00000000
NAME becky 81

TIL 5j
00000000
00000000
00000011
00000111
00000111
00000111
00000011
00000001
NAME becky 82

TIL 5k
00000000
11100000
11110000
00110000
10000000
10000000
11000000
11100000
NAME becky 83

TIL 5l
00000000
00000000
00000000
00000000
00000011
00000111
00000001
00000001
NAME becky 84

TIL 5m
00000110
00001100
00011000
00110000
11111111
11111111
10000000
10000000
NAME becky 85

TIL 5n
11100000
11100000
11100000
11100000
11110000
11100000
11100000
11100000
NAME becky 86

TIL 5o
00000001
00000001
00000001
00000011
00000011
00000111
00000110
00000110
NAME becky 87

TIL 5p
10000111
10000111
10000111
00000111
00001110
00011110
00111100
01111000
NAME becky 88

TIL 5q
00011000
00011000
00011000
00110000
00110000
01110001
01100011
01100111
NAME becky 89

TIL 5r
01110000
01110000
01110000
01110000
11100000
11100000
11000000
10000000
NAME becky 90

TIL 5s
00001110
00011100
00011000
00111000
01110000
01101111
11111111
11100011
NAME becky 91

TIL 5t
00000000
00000000
00000000
00000001
00000001
10000001
11110001
11111000
NAME becky 92

TIL 5u
00001111
00111111
11110000
11000000
11000000
11000000
11100000
11111000
NAME becky 93

TIL 5v
11100000
11100000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 94

TIL 5w
00000011
00000111
00000110
00001100
00001100
00001000
00000000
00000000
NAME becky 95

TIL 5x
01110000
01110000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 96

TIL 5y
00001111
00011111
00011100
00011100
00011000
00111000
00111000
00110000
NAME becky 97

TIL 5z
11100000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 98

TIL 6a
00000000
00000000
00000000
00111110
11000001
00000000
00000000
00000000
NAME becky 109

TIL 6b
00000000
00000000
00000000
00000000
11000000
00110000
00001000
00000100
NAME becky 110

TIL 6c
00000000
00000000
00000001
00000010
00000010
00000100
00000100
00000100
NAME becky 111

TIL 6d
10000000
10000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME becky 112

TIL 6e
10000000
10000000
01000000
00100011
00101100
00010000
00010000
00010000
NAME becky 113

TIL 6f
00000000
00000000
00000000
11111000
00000110
00000001
00000000
00000000
NAME becky 114

TIL 6g
00000000
00000000
00000000
00000000
00000000
10000000
01000000
00100000
NAME becky 115

TIL 6h
00100000
00100000
01000000
01000000
01000000
10000000
10000000
10000000
NAME becky 116

TIL 6i
00000010
00000010
00000001
00000001
00000001
00000000
00000000
00000000
NAME becky 117

TIL 6j
00000000
00111110
11000001
00000000
00000000
10000000
10000000
10000000
NAME becky 118

TIL 6k
00000000
00000000
10000000
01000000
00100000
00010000
00010000
00001011
NAME becky 119

TIL 6l
00001000
00001000
00001000
00001000
00001000
00001000
00001000
00000100
NAME becky 120

TIL 6m
00001000
00001000
00001000
00001000
00000000
00000000
00000000
00000000
NAME becky 121

TIL 6n
00010000
00010000
00001000
00001000
00000111
00000100
00000100
00000100
NAME becky 122

TIL 6o
10000000
10000000
01000000
01000000
01000000
00100000
00100000
00010000
NAME becky 123

TIL 6p
00001100
00001000
00001000
00000000
00000000
00000000
00000000
00000000
NAME becky 124

TIL 6q
00000100
00000100
00000010
00000010
00000001
00000000
00000000
00000000
NAME becky 125

TIL 6r
00000000
00000000
00000000
00000000
00000000
10000000
10000000
01100000
NAME becky 126

TIL 6s
01000000
01011110
00100001
00100000
00100000
00000000
00000000
00000000
NAME becky 127

TIL 6t
00000000
00000000
10000000
01000000
01000000
00100000
00100000
00010000
NAME becky 128

TIL 6u
00001000
00000110
00000001
00000000
00000000
00000000
00000000
00000000
NAME becky 129

TIL 6v
00000000
00000000
11000000
00111111
00000000
00000000
00000000
00000000
NAME becky 130

TIL 6w
00000000
00000000
00000000
11111111
00000000
00000000
00000000
00000000
NAME becky 131

TIL 6x
00010000
00001100
00000011
00000000
00000000
00000000
00000000
00000000
NAME becky 132

TIL 6y
00000000
00000000
10000000
01111111
00000000
00000000
00000000
00000000
NAME becky 133

TIL 6z
00001100
00000011
00000000
11111111
00000000
00000000
00000000
00000000
NAME becky 134

TIL 7a
11100000
11100111
11111111
11111111
11111111
11111111
11111111
11111111
NAME becky 145

TIL 7b
00000000
10000000
11100000
11110000
11110000
11111111
11111111
11111111
NAME becky 146

TIL 7c
01111111
11111111
11111111
11111111
11111111
11111111
01111111
01111111
NAME becky 147

TIL 7d
11111000
11111100
11111100
11111111
11111111
11111111
11111111
11111111
NAME becky 148

TIL 7e
00000000
00000000
00000000
11000000
11100000
11110000
11111100
11111110
NAME becky 149

TIL 7f
00000011
00000011
00000001
00000001
00000000
00000000
00000000
00000000
NAME becky 150

TIL 7g
11111111
11111111
11111111
11111111
11111111
01111111
00111111
00011111
NAME becky 151

TIL 7h
11111111
11111111
11111111
11111111
11111111
11111111
00000000
00000000
NAME becky 152

TIL 7i
11000000
11100000
11111000
11111100
11111111
11111111
00000000
00000000
NAME becky 153

TIL 7j
00111111
00011111
00000111
00000000
00000000
00000000
00000000
00000000
NAME becky 154

TIL 7k
11111111
11111111
11111111
00000000
00000000
00000000
00000000
00000000
NAME becky 155

TIL 7l
11111110
11111111
11111111
00000000
00000000
00000000
00000000
00000000
NAME becky 156

TIL 7m
00000000
00000000
00000000
00000000
00000011
00001111
00011111
01111111
NAME becky 157

TIL 7n
00000000
00000000
00000000
01111111
11111111
11111111
11111111
11111111
NAME becky 158

TIL 7o
00000000
00000000
00000000
00000000
11100000
11111000
11111100
11111111
NAME becky 159

TIL 7p
00000000
00000000
00000000
00000000
00000001
00000111
00001111
00011111
NAME becky 160

TIL 7q
00000000
00000000
00000000
00111110
11111111
11111111
11111111
11111111
NAME becky 161

TIL 7r
00000000
00000000
00000000
00000000
11000000
11110000
11111000
11111100
NAME becky 162

TIL 7s
00000000
00000000
00000001
00000011
00000011
00000111
00000111
00000111
NAME becky 163

TIL 7t
10000000
10000000
11000000
11100011
11101111
11111111
11111111
11111111
NAME becky 164

TIL 7u
00000000
00000000
00000000
11111000
11111110
11111111
11111111
11111111
NAME becky 165

TIL 7v
00000000
00000000
00000000
00000000
00000000
10000000
11000000
11100000
NAME becky 166

TIL 7w
00111111
00111111
01111111
01111111
01111111
11111111
11111111
11111111
NAME becky 167

TIL 7x
00000000
00111110
11111111
11111111
11111111
11111111
11111111
11111111
NAME becky 168

TIL 7y
00000000
00000000
10000000
11000000
11100000
11110000
11110000
11111011
NAME becky 169

TIL 7z
00001111
00001111
00001111
00001111
00001111
00001111
00001111
00000111
NAME becky 170

TIL 8a
11111100
11111111
11111111
11111111
00000000
00000000
00000000
00000000
NAME becky 181

TIL 8b
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00100000
NAME mara 1

TIL 8c
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00001000
NAME mara 2

TIL 8d
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00010001
NAME mara 3

TIL 8e
00000000
00000000
00000000
00000000
00000000
10000000
11000000
11000000
NAME mara 4

TIL 8f
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00001111
NAME mara 5

TIL 8g
00000000
00000000
00000000
00000000
00000000
00000000
11110000
11110000
NAME mara 6

TIL 8h
00000000
00000000
00000001
00000011
00000110
00001100
00001000
00011001
NAME mara 7

TIL 8i
01100000
11110000
11110000
11100001
11100011
11100110
11001101
11001101
NAME mara 8

TIL 8j
00000000
00000000
11000000
11100000
11100000
11000000
11000000
11000000
NAME mara 9

TIL 8k
00000000
00000000
00000000
00000001
00000011
00000011
00000110
00001100
NAME mara 10

TIL 8l
00111000
01111000
11111000
10110000
11110000
01110000
01110000
01110000
NAME mara 11

TIL 8m
00111111
01111111
01110000
10000000
00000001
00000011
00000011
00000110
NAME mara 12

TIL 8n
11111111
11111111
11000001
11000000
10000001
00001110
01110000
11000000
NAME mara 13

TIL 8o
11000000
11000000
11000000
10000000
00000000
00000000
00000000
00000000
NAME mara 14

TIL 8p
00000000
00000000
00000001
00000011
00000111
00000110
00001100
00011000
NAME mara 15

TIL 8q
01110001
11110001
11110000
01100000
11100000
11100000
11100000
11100000
NAME mara 16

TIL 8r
11000000
10000001
10000011
00000110
00001000
00011000
00011111
00000111
NAME mara 17

TIL 8s
01111111
11111000
10000000
00000000
00000000
00000000
11111111
11111111
NAME mara 18

TIL 8t
11100000
01000000
00000000
00000000
00000000
00000000
10000000
11100000
NAME mara 19

TIL 8u
00000000
00000000
00000000
00000001
00000001
00000011
00000110
00001110
NAME mara 20

TIL 8v
00110001
01100001
11000001
10000011
10000011
00000011
00000000
00000000
NAME mara 21

TIL 8w
11011011
10110011
11100011
11100111
11000111
10000111
00000111
00000000
NAME mara 22

TIL 8x
10000000
10000001
10000011
00000000
01000000
11000001
10000011
00000011
NAME mara 23

TIL 8y
00011000
11111111
11111111
11000000
11000000
10000000
10000000
00000000
NAME mara 24

TIL 8z
01110000
11111000
11110000
01110000
01110000
00111000
00111000
00000000
NAME mara 25

TIL 9a
00000000
00000000
00000001
00000000
00000000
00000000
00000000
00000000
NAME mara 36

TIL 9b
11000000
11000000
11000000
00000000
00000000
00000000
00000000
00000000
NAME mara 37

TIL 9c
00000001
00000001
00000001
00000000
00000000
00000000
00000000
00000000
NAME mara 38

TIL 9d
11111111
11111110
11000000
00000000
00000000
00000000
00000000
00000000
NAME mara 39

TIL 9e
11000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME mara 40

TIL 9f
11111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111
NAME cloud
COL 2

TIL 9g
11111110
00000001
00000001
00000001
00000001
00000001
00000001
00000001
WAL false

TIL 9h
00111100
01111100
01111000
01110000
11100000
11000000
11000000
10000000
WAL true

TIL 9i
00011111
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 9j
11111100
00000000
00000000
00000000
00000000
00000000
00000000
00000000

TIL 9k
00000000
00000000
00000000
00000000
00000000
00000000
10000000
11100000
NAME trumk
COL 2

TIL 9l
00111100
01111100
01111100
01111110
11101110
11101111
11100111
11111111
NAME trumk
WAL true
COL 2

TIL 9m
00101000
00111000
00111000
01111100
01111100
11011100
10011111
11111111
NAME trumk
WAL true
COL 2

TIL 9n
01101100
10010010
00000001
00000101
00000101
00001001
10000010
01111100
NAME outline
COL 8

TIL 9o
00000000
00000000
00000001
00000001
00000001
00000001
00000000
00000000
NAME outline
COL 8

TIL 9p
00000000
00000000
00000000
00000000
00000000
00000000
00000001
00000111
NAME trumk

SPR A
00000000
00011000
00011000
00000000
00111100
00011000
00111100
01111110
POS 1q 4,1
COL 6

SPR a
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
>
00001100
00001100
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom
DLG SPR_1
POS 2 2,5
COL 3

SPR b
00000000
00011000
00011000
00000000
00111100
00011000
00011000
00100100

SPR c
00000000
00000000
00011000
00011000
00000000
00111100
00000000
00000000
NAME db
COL 7

SPR f
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME undressed
DLG SPR_0
POS c 6,9

SPR h
00000000
00000001
00000001
00000000
00000011
00000001
00000001
00000010
NAME porple
POS m 11,12
COL 4

SPR i
00000000
10000000
10000000
00000000
11000000
10000000
10000000
01000000
NAME porple
POS m 12,12
COL 4

SPR j
00111100
00111100
00011000
00111100
00011000
00000000
00000000
00000000
NAME tvsis
DLG SPR_6
POS r 6,13
COL 4

SPR k
00010101
00001010
00010101
00001010
00000000
00000000
00000000
00000000
>
00001010
00010101
00001010
00010101
00000000
00000000
00000000
00000000
NAME  SOLID
DLG SPR_7
POS r 5,9

SPR l
01010000
10101000
01010000
10101000
00000000
00000000
00000000
00000000
>
10101000
01010000
10101000
01010000
00000000
00000000
00000000
00000000
NAME  SOLID
DLG SPR_8
POS r 6,9

SPR m
00000000
00000000
00000000
00000000
00000000
00000000
01010000
10101000
>
00000000
00000000
00000000
00000000
00000000
00000000
10101000
01010000
POS r 6,8

SPR n
00000000
00000000
00000000
00000000
00000000
00000000
00010101
00001010
>
00000000
00000000
00000000
00000000
00000000
00000000
00001010
00010101
POS r 5,8

SPR o
00000000
00000000
00000000
00100000
00101100
00101100
00100000
00000000
NAME sleepsis
DLG SPR_2
POS 0 14,9
COL 4

SPR p
00000000
00000000
00000000
00100000
00101100
00101100
00100000
00000000
NAME sleepsis2
DLG SPR_5
POS g 14,9
COL 4

SPR q
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME sleep
DLG SPR_3
POS 0 13,9

SPR r
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME sleep2
DLG SPR_4
POS g 13,9

SPR s
00000000
01101100
11111110
10110110
11111110
11001110
01111100
00000000
NAME apple
DLG SPR_9
POS 10 9,7
COL 5

SPR t
00000000
00110110
01111111
01101101
01111111
01110011
00111110
00000000
NAME apple
DLG SPR_a
POS 11 4,7
COL 5

SPR u
00000000
01110110
11111111
10110111
10010011
11111111
11001111
01111110
NAME apple
DLG SPR_e
POS 11 10,12
COL 5

SPR v
00000000
01101100
11011010
11011010
11111110
11100110
01111100
00000000
NAME apple
DLG SPR_f
POS 10 1,9
COL 5

SPR w
00000000
00000000
00000000
00111100
00011000
00111100
01111110
00000000
NAME dresss
DLG SPR_b
POS 14 13,6
COL 6

SPR x
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
>
00001100
00001100
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom
DLG SPR_c
POS 1x 2,5
COL 3

SPR y
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
>
00001100
00001100
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom
DLG SPR_d
POS 1y 2,5
COL 3

SPR z
00000000
00000000
00011000
00011000
00000000
00111100
00000000
00000000

ITM 0
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom SOLID
DLG ITM_8
COL 3

ITM 1
00000000
00011000
00011000
00000000
00111100
00011000
00011000
00100100
NAME becky
COL 7

ITM 2
00000000
00000000
00000000
00111100
00011000
00111100
01111110
00000000
NAME db
COL 7

ITM 3
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME getdress
DLG ITM_1

ITM 4
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME checkbed SOLID
DLG ITM_0

ITM 5
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME notout SOLID
DLG ITM_6

ITM 6
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME notleave SOLID

ITM 7
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
>
00001100
00001100
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom SOLID
COL 3

ITM 8
00000000
00011000
00011000
00000000
00111100
00011000
00011000
00100100
NAME mara
COL 4

ITM 10
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME bigapple
DLG ITM_f

ITM 11
00000000
00000000
00000000
00000000
00000000
11000000
11000000
11000000
NAME bapp
COL 5

ITM 12
11111100
11111100
11111100
11111100
11111100
11111100
11111100
10111100
NAME bapp
COL 5

ITM 13
00011100
00011100
00011100
00011100
00111100
00111100
01111100
11111100
NAME bapp
COL 5

ITM 14
11111100
11000000
11000000
11000000
11000000
00000000
00000000
00000000
NAME bapp
COL 5

ITM 16
00000000
00000000
00000000
00000000
00000000
11111100
11111100
11111100
NAME bapp
COL 5

ITM 17
00000000
00000000
00000000
00000000
00000000
00000011
00000011
00000011
NAME bapp
COL 5

ITM 18
00000000
00000000
00000000
00000000
00000000
00111111
00111111
00111111
NAME bapp
COL 5

ITM 19
00111111
00000011
00000011
00000011
00000011
00000000
00000000
00000000

ITM 20
00000000
00000000
00000000
00000000
01111111
11111111
11111111
11111111

ITM 21
00000000
00000000
00000000
00000001
00000001
00000011
00000011
00000011

ITM 22
00000111
00000111
00000111
00000111
00000111
00000111
00000111
00000011

ITM 23
00000000
00000000
10000000
11000000
11000011
11101111
11101111
11101111

ITM 24
11110111
11110111
11110111
11110111
11111111
11111111
11111111
11111111

ITM 25
00000011
00000011
00000001
00000001
00000000
00000000
00000000
00000000

ITM 26
11111111
11111111
11111111
11111111
11111111
01111111
01111111
00011111

ITM 27
00001111
00000011
00000000
00000000
00000000
00000000
00000000
00000000

ITM 28
00000000
00000000
00000000
00000000
11111000
11111110
11111111
11111111

ITM 29
00000000
00000000
00000000
00000000
00000000
00000000
10000000
11000000

ITM 30
11000000
11000000
11100111
11101111
11101111
11111111
11111111
11111111

ITM 31
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME noback SOLID
DLG ITM_h

ITM 32
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME mara SOLID
DLG ITM_i
COL 4

ITM 33
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME wakeup SOLID
DLG ITM_j

ITM 34
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME wakeup2 SOLID
DLG ITM_k

ITM 35
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME tv SOLID
DLG ITM_l

ITM 36
11000000
11000000
11000000
11000000
11000000
11000000
11000000
10000000
NAME lp

ITM 37
11000000
10000000
10000000
10000000
00000000
00000000
00000000
00000000
NAME lp

ITM 38
00111100
01111100
01111000
01110000
11100000
11000000
11000000
10000000
NAME tronk
COL 1

ITM 39
10000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000

ITM a
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME madsis SOLID
DLG ITM_b

ITM b
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME talkto SOLID
DLG ITM_2

ITM c
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
>
00001100
00001100
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom SOLID
DLG ITM_c
COL 3

ITM d
00011000
00011000
00000000
00111100
01011010
00111100
01111110
11111111
NAME mom SOLID
DLG ITM_d
COL 3

ITM h
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME wakeup SOLID
DLG ITM_7

ITM k
10000000
10000000
10000000
10000000
10000000
10000000
10000000
10000000
NAME wall

ITM l
00101000
00101000
00001000
00001000
00000000
00000000
00000000
00000000
NAME trunk
COL 1

ITM m
00111100
00111100
00111000
00110000
00100000
00000000
00000000
00000000
NAME trunk
COL 1

ITM n
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME lg
COL 4

ITM o
11111111
11111111
11111111
11111111
11111111
11111111
01111111
00000000
NAME lg
COL 4

ITM p
11111111
11111111
11111111
11111111
11111111
11111110
11111000
00000000
NAME lg
COL 4

ITM q
11110000
11100000
11100000
11000000
10000000
00000000
00000000
00000000
NAME lg
COL 4

ITM r
11100000
11110000
11110000
11110000
11110000
11110000
11110000
11110000
NAME lg
COL 4

ITM s
00000000
00000000
00000000
00000000
10000000
11000000
11000000
11100000
NAME lg
COL 4

ITM t
00111111
00111111
00011111
00001111
00000111
00000001
00000000
00000000
NAME lg
COL 4

ITM u
00111111
00111111
01111111
01111111
01111111
01111111
01111111
01111111
NAME lg
COL 4

ITM v
00000000
00000000
00000000
00000011
00000111
00001111
00011111
00011111
NAME lg
COL 4

ITM w
00000000
00011111
11111111
11111111
11111111
11111111
11111111
11111111
NAME lg
COL 4

ITM x
00000000
11110000
11111100
11111111
11111111
11111111
11111111
11111111
NAME lg
COL 4

ITM y
00111100
00111100
00011100
00001100
00000100
00000000
00000000
00000000
NAME trunk
COL 1

ITM z
00000000
01101100
11111110
11111110
10010010
11111110
01111100
00000000
NAME apple
DLG ITM_e
COL 5

ITM 1a
00001111
11111111
11111111
11111111
11111111
00000000
00000000
00000000

ITM 1b
11110000
11111111
11111111
11111111
11111111
00000000
00000000
00000000

ITM 1c
00000000
00000000
00000000
00100000
00101100
00101100
00100000
00000000
NAME marasl
COL 4

ITM 1d
00000000
00011000
00011000
00000000
00111100
00011000
00111100
01111110
NAME porple
COL 4

ITM 1e
00010111
00010111
00010111
00010111
00010111
00010111
00010111
00010111
NAME lp

ITM 1f
11000000
11000000
11000000
11000000
11000000
11000000
11000000
11000000

ITM 1g
11000000
10000000
10000000
10000000
00010000
00010000
00011000
00000000

ITM 1h
00010111
00000111
00000111
00000011
00000011
00100011
01100000
00000000

ITM 1i
00101000
00101000
00101000
00101000
00101000
00101000
00101000
00101000

ITM 1j
00111100
00111100
00111100
00111100
00111100
00111100
00111100
00111100

ITM 1k
00000000
01101100
11111110
11111010
11111010
11110110
01111100
00000000
NAME gapple
COL 7

ITM 1l
11110011
11110111
11110111
11111111
11111111
11111111
11111111
11111111

ITM 1m
11111111
11111111
11111111
00000000
00000000
00000000
00000000
00000000

ITM 1n
00000000
00000000
00000000
10000000
11000000
11100000
11100000
11110000

ITM 1o
00000000
00000000
00111110
11111111
11111111
01111111
01111111
01111111

ITM 1p
01111111
01111111
11111111
11111111
11111111
11111111
11111111
11111111

ITM 1q
11111100
11111100
11111110
11111110
11111110
11111111
11111111
11111111

ITM 1r
11110000
11111100
11111111
00000000
00000000
00000000
00000000
00000000

ITM 1s
11111111
11111111
00111111
00000000
00000000
00000000
00000000
00000000

ITM 1t
11111111
11111111
01111111
00000000
00000000
00000000
00000000
00000000

ITM 1u
00000000
00000000
00000000
00000000
00000000
11000000
11110000
11111000

ITM 1v
00000000
00000000
00000000
00000000
00111110
11111111
11111111
11111111

ITM 1w
00000000
00000000
00000000
00000000
00000000
00000001
00000111
00001111

ITM 1x
00000000
00000000
00000000
00000000
00000000
00000011
00001111
00011111

ITM 1y
00000000
00000000
00000000
00000000
00000000
11100000
11111000
11111100

ITM 1z
00000000
00000000
00000000
00000000
00000000
00000111
00011111
00111111

ITM 2a
11100000
11100000
11110000
11110000
11111000
11111011
11111011
11111011

ITM 2b
10000000
10000000
11011110
11011111
11011111
11111111
11111111
11111111

ITM 2c
00000000
00000000
00000000
10000000
10000000
11000000
11000000
11100000

ITM 2d
01111111
01111111
00111111
00111111
00111111
00011111
00011111
00001111

ITM 2e
00000111
00000001
00000000
00000000
00000000
00000000
00000000
00000000

ITM 2f
00011111
00011111
00111111
00111111
00111111
01111111
01111111
01111111

ITM 2g
00111111
01111111
01111111
01111111
01111111
01111111
00111111
00111111

ITM 2h
00011111
00000111
00000000
00000000
00000000
00000000
00000000
00000000

ITM 2i
11111111
11111111
00000000
00000000
00000000
00000000
00000000
00000000

ITM 2j
11111100
11111110
00000000
00000000
00000000
00000000
00000000
00000000

ITM 2k
00000000
00000000
00000000
00000000
11000000
11100000
11100000
11101100

ITM 2l
11100000
11111000
11111000
11111100
11111101
11111111
11111111
11111111

ITM 2m
11111001
11111101
11111101
11111101
11111111
11111111
11111111
11111111

ITM 2n
11111111
11111111
11111111
11111111
01111111
00111111
00011111
00000011

ITM 2o
00000001
00000001
00000000
00000000
00000000
00000000
00000000
00000000

ITM 2p
00000000
00000000
00000000
00000000
00000000
00000001
00000001
00000001

ITM 2q
00011111
00111111
01111111
11111111
11111111
11111111
11111111
11111111

ITM 2r
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000111

ITM 2s
00000000
00000000
00000000
00000000
00000000
00000000
00000000
11000000

ITM 2t
11110000
11111000
11111100
11111110
11111110
11111111
11111111
11111111

ITM 2u
00000000
00000000
00000000
00111100
11111111
01111111
01111111
01111111

ITM 2v
01111111
11111111
11111111
11111111
11111111
11111111
11111111
11111111

ITM 2w
11111111
11111111
11111111
11111111
11111111
00000000
00000000
00000000

ITM 2x
10000000
11000000
11100000
11111000
11111100
00000000
00000000
00000000

ITM 2y
00000000
00000000
00000000
00000000
00000000
00000000
00000000
10000000

ITM 2z
00000000
00000000
10000000
11100000
11100000
11110000
11110111
11110111

ITM 3a
11000000
01000000
00000000
00000000
00000000
00000000
00000000
00000000

ITM 3b
00000011
00000000
00000000
00000000
00000000
00000000
00000000
00000000

ITM 3c
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME locked SOLID
DLG ITM_3

ITM 3d
00000000
00000000
00000000
00000000
00000000
00000000
00000000
00000000
NAME crunch

ITM 3e
00111100
00111100
00111100
00111100
00111100
00111100
00111100
00111100

ITM 3f
00010111
00010111
00010111
00010111
00010111
00010111
00010111
00010111
NAME pwink
COL 6

ITM 3g
00010111
00000111
00000111
00000011
00000011
00100011
01100000
00000000
NAME pwink
COL 6

ITM 3h
11000000
11000000
11000000
11000000
11000000
11000000
11000000
11000000
NAME pwink
COL 6

ITM 3i
11000000
10000000
10000000
10000000
00010000
00010000
00011000
00000000
NAME pwink
COL 6

ITM 3j
00000000
00000000
00011000
00011000
00000000
00111100
00000000
00000000
NAME db
COL 7

DLG ITM_0
{becky}I can't go back to bed now, mom is waiting...{becky}

DLG SPR_0
{becky}I can't go out yet, I'm not dressed...{becky}

DLG ITM_1
{becky}I'll wear a dress today...{becky}

DLG ITM_2
{mom}Don't leave, I'm trying to talk to you!{mom}

DLG SPR_1
"""
{mom}Finally up, huh? Do you know what time it is?{mom}
{becky}sorry...{becky}

{mom}Go wake up your sister!{mom}(exit "3b,3,5")
"""

DLG ITM_6
{becky}I can't go outside, mom wants me...{becky}

DLG ITM_7
{becky}I should hurry and wake up Mara...{becky}

DLG ITM_8
{mom}Well? Go wake her up!{mom}

DLG SPR_2
"""
{becky}hey Mara, wake up{becky}

{mara}mmmghghh...{mara}

{mara}ok, just get out{mara} (exit "5b,14,10")
"""

DLG SPR_4
{mara}I'll get up, ok? Just leave!{mara}

DLG SPR_5
{mara}I'll get up, ok? Just leave!{mara}

DLG ITM_b
{mara}Don't come in here, I'm getting dressed!{mara}

DLG ITM_c
"""
{mom}You wake her up yet?{mom}

{becky}yes mom...{becky}

{mom}Ok, now go get some apples from the orchard.
Five should be enough.{mom} (exit "getapples,3,5")
"""

DLG ITM_d
"""
{
  - {item "apple"} < 5 ?
    {mom}Well? Go get five apples!{mom}
  - else ?
    {becky}I brought the apples, mom...{becky}
    
    {mom}This one is smushed! Go find one more!{mom}
}
"""

DLG SPR_6
{mara}get away, you're in front of the tv!{mara}

DLG SPR_7
the tv is on. looks like static

DLG SPR_8
the tv is on. looks like static

DLG SPR_9
"""
{shuffle
  - No, don't pick me! N-not yet!

  - Please no, I have so much left to live for!
  - Oh no! I don't want to die!

  - Please, I have children! They'll miss me so much!
  - Let me live! I'm begging you!

  - Stay back! I'll defend myself!

}
{becky}hm, can't pick this one...{becky}
"""

DLG SPR_a
"""
{shuffle
  - No, don't pick me! N-not yet!

  - Please no, I have so much left to live for!
  - Oh no! I don't want to die!

  - Please, I have children! They'll miss me so much!
  - Let me live! I'm begging you!

  - Stay back! I'll defend myself!

}
hm, can't pick this one...
"""

DLG ITM_e
"""
{sequence
  - {becky}great, I found an apple{becky}
  - {becky}I'll pick this, it isn't moving.{becky}
  - {becky}it looks a bit smushed, maybe it's dead.{becky}
    I guess it still works.
  - {becky}this one is shivering, but it stays silent. {becky}
  - {becky}ok, that's five apples. time to go back.{becky}
}
"""

DLG ITM_f
yeeeeeeeessss...  come take a bite of this apple... (exit "becky2,4,1")

DLG SPR_b
{becky}oh, I guess I'm already wearing my dress?{becky}

DLG ITM_h
"""
no...
I won't go back there
"""

DLG ITM_i
"""
...sis?

...mom?(exit "mara,4,1")
"""

DLG ITM_j
BECKY! WAKE UP!!! (exit "sleep,7,9")

DLG ITM_k
BECKY! WAKE UP!!! (exit "sleep2,7,9")

DLG ITM_l
the tv's turned off...

DLG SPR_3
"""
{becky}hey Mara, wake up{becky}

{mara}mmmghghh...{mara}

{mara}ok, just get out{mara} (exit "5b,12,9")
"""

DLG SPR_c
"""
{mom}Finally up, huh? Do you know what time it is?{mom}
{becky}sorry...{becky}

{mom}Go wake up your sister!{mom}(exit "3b,2,4")
"""

DLG SPR_d
"""
{mom}Finally up, huh? Do you know what time it is?{mom}
{becky}sorry...{becky}

{mom}Go wake up your sister!{mom}(exit "3b,2,6")
"""

DLG SPR_e
"""
{shuffle
  - No, don't pick me! N-not yet!

  - Please no, I have so much left to live for!
  - Oh no! I don't want to die!

  - Please, I have children! They'll miss me so much!
  - Let me live! I'm begging you!

  - Stay back! I'll defend myself!

}
hm, can't pick this one...
"""

DLG SPR_f
"""
{shuffle
  - No, don't pick me! N-not yet!

  - Please no, I have so much left to live for!
  - Oh no! I don't want to die!

  - Please, I have children! They'll miss me so much!
  - Let me live! I'm begging you!

  - Stay back! I'll defend myself!

}
hm, can't pick this one...
"""

DLG ITM_3
it's locked...

END 0


END undefined
ah, the golden apple.{br}of course...

VAR dest
3b,3,5


</script>

<style>
html {
	margin:0px;
	padding:0px;
}

body {
	margin:0px;
	padding:0px;
	overflow:hidden;
	background:#ffc2c2;
}

#game {
	background:black;
	width:100vw;
	max-width:100vh;
	margin:auto;
	display:block;

	/* https://caniuse.com/#search=image-render */
  	-ms-interpolation-mode: nearest-neighbor; /* IE */
  	image-rendering: -moz-crisp-edges; /* FF 6.0+ */
  	image-rendering: pixelated; /* Chrome, Safari */
}

</style>

<!-- SCRIPTS -->
<script>
function startExportedGame() {
	attachCanvas( document.getElementById("game") );
	load_game( document.getElementById("exportedGameData").text.slice(1) );
}
</script>

<script>
//hex-to-rgb method borrowed from stack overflow
function hexToRgb(hex) {
	// Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
	var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
	hex = hex.replace(shorthandRegex, function(m, r, g, b) {
		return r + r + g + g + b + b;
	});

	var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
	return result ? {
		r: parseInt(result[1], 16),
		g: parseInt(result[2], 16),
		b: parseInt(result[3], 16)
	} : null;
}
function componentToHex(c) {
    var hex = c.toString(16);
    return hex.length == 1 ? "0" + hex : hex;
}
function rgbToHex(r, g, b) {
    return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}

function hslToHex(h,s,l) {
    var rgbArr = hslToRgb(h,s,l);
    return rgbToHex( Math.floor(rgbArr[0]), Math.floor(rgbArr[1]), Math.floor(rgbArr[2]) );
}

function hexToHsl(hex) {
    var rgb = hexToRgb(hex);
    return rgbToHsl(rgb.r, rgb.g, rgb.b);
}

// really just a vector distance
function colorDistance(a1,b1,c1,a2,b2,c2) {
    return Math.sqrt( Math.pow(a1 - a2, 2) + Math.pow(b1 - b2, 2) + Math.pow(c1 - c2, 2) );
}

function hexColorDistance(hex1,hex2) {
    var color1 = hexToRgb(hex1);
    var color2 = hexToRgb(hex2);
    return rgbColorDistance(color1.r, color1.g, color1.b, color2.r, color2.g, color2.b);
}


// source : http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c
/* accepts parameters
 * h  Object = {h:x, s:y, v:z}
 * OR 
 * h, s, v
*/
function HSVtoRGB(h, s, v) {
    var r, g, b, i, f, p, q, t;
    if (arguments.length === 1) {
        s = h.s, v = h.v, h = h.h;
    }
    i = Math.floor(h * 6);
    f = h * 6 - i;
    p = v * (1 - s);
    q = v * (1 - f * s);
    t = v * (1 - (1 - f) * s);
    switch (i % 6) {
        case 0: r = v, g = t, b = p; break;
        case 1: r = q, g = v, b = p; break;
        case 2: r = p, g = v, b = t; break;
        case 3: r = p, g = q, b = v; break;
        case 4: r = t, g = p, b = v; break;
        case 5: r = v, g = p, b = q; break;
    }
    return {
        r: Math.round(r * 255),
        g: Math.round(g * 255),
        b: Math.round(b * 255)
    };
}

/* accepts parameters
 * r  Object = {r:x, g:y, b:z}
 * OR 
 * r, g, b
*/
function RGBtoHSV(r, g, b) {
    if (arguments.length === 1) {
        g = r.g, b = r.b, r = r.r;
    }
    var max = Math.max(r, g, b), min = Math.min(r, g, b),
        d = max - min,
        h,
        s = (max === 0 ? 0 : d / max),
        v = max / 255;

    switch (max) {
        case min: h = 0; break;
        case r: h = (g - b) + d * (g < b ? 6: 0); h /= 6 * d; break;
        case g: h = (b - r) + d * 2; h /= 6 * d; break;
        case b: h = (r - g) + d * 4; h /= 6 * d; break;
    }

    return {
        h: h,
        s: s,
        v: v
    };
}

// source : https://gist.github.com/mjackson/5311256
/**
 * Converts an HSL color value to RGB. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes h, s, and l are contained in the set [0, 1] and
 * returns r, g, and b in the set [0, 255].
 *
 * @param   Number  h       The hue
 * @param   Number  s       The saturation
 * @param   Number  l       The lightness
 * @return  Array           The RGB representation
 */
function hslToRgb(h, s, l) {
  var r, g, b;

  if (s == 0) {
    r = g = b = l; // achromatic
  } else {
    function hue2rgb(p, q, t) {
      if (t < 0) t += 1;
      if (t > 1) t -= 1;
      if (t < 1/6) return p + (q - p) * 6 * t;
      if (t < 1/2) return q;
      if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
      return p;
    }

    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
    var p = 2 * l - q;

    r = hue2rgb(p, q, h + 1/3);
    g = hue2rgb(p, q, h);
    b = hue2rgb(p, q, h - 1/3);
  }

  return [ r * 255, g * 255, b * 255 ];
}

/**
 * From: http://stackoverflow.com/questions/2353211/hsl-to-rgb-color-conversion
 *
 * Converts an RGB color value to HSL. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes r, g, and b are contained in the set [0, 255] and
 * returns h, s, and l in the set [0, 1].
 *
 * @param   {number}  r       The red color value
 * @param   {number}  g       The green color value
 * @param   {number}  b       The blue color value
 * @return  {Array}           The HSL representation
 */
function rgbToHsl(r, g, b){
    r /= 255, g /= 255, b /= 255;
    var max = Math.max(r, g, b), min = Math.min(r, g, b);
    var h, s, l = (max + min) / 2;

    if(max == min){
        h = s = 0; // achromatic
    }else{
        var d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch(max){
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }

    return [h, s, l];
}
</script>

<script>
function Font() {


this.getData = function() {
	return fontdata;
}

var charSize = 6 * 8;
var unicodeToAsciiExtended = "\u0000\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\u00B6\u00A7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC\u0020\u0021\u0022\u0023\u0024\u0025\u0026\u0027\u0028\u0029\u002a\u002b\u002c\u002d\u002e\u002f\u0030\u0031\u0032\u0033\u0034\u0035\u0036\u0037\u0038\u0039\u003a\u003b\u003c\u003d\u003e\u003f\u0040\u0041\u0042\u0043\u0044\u0045\u0046\u0047\u0048\u0049\u004a\u004b\u004c\u004d\u004e\u004f\u0050\u0051\u0052\u0053\u0054\u0055\u0056\u0057\u0058\u0059\u005a\u005b\u005c\u005d\u005e\u005f\u0060\u0061\u0062\u0063\u0064\u0065\u0066\u0067\u0068\u0069\u006a\u006b\u006c\u006d\u006e\u006f\u0070\u0071\u0072\u0073\u0074\u0075\u0076\u0077\u0078\u0079\u007a\u007b\u007c\u007d\u007e\u007f\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00a2\u00a3\u00a5\u20a7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u2310\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u00df\u0393\u03c0\u03a3\u03c3\u00b5\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u03c6\u03b5\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u00a0".split("").reduce(function(obj, char, idx){
    obj[char] = idx;
    return obj;
}, {});

this.getChar = function(char) {
    var startIndex = unicodeToAsciiExtended[char] * charSize;
    return fontdata.slice( startIndex, startIndex + charSize );
}

var fontdata = [/*default.png*/0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,1,0,1,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1,1,0,0,1,1,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,1,0,1,1,0,0,1,1,1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,1,0,0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,1,1,1,0,0,0,1,0,0,0,1,1,1,1,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,1,1,0,0,0,0,1,0,1,0,0,0,0,1,1,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,1,1,1,0,0,0,1,0,0,0,1,1,1,1,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,1,1,1,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,1,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,1,1,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,1,1,1,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,1,0,1,0,0,1,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,1,0,1,0,1,1,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,0,1,1,1,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,1,1,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,0,1,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,1,1,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,1,1,1,0,0,1,1,0,1,1,0,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,1,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,1,0,1,0,0,1,0,1,1,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,0,1,0,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,0,1,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,1,1,0,1,0,0,0,0,0,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,0,0,1,1,0,1,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,0,1,1,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,1,0,0,1,0,1,1,1,1,1,1,0,1,0,0,1,0,0,1,0,0,1,0,1,1,1,1,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];


} // Font()
</script>

<script>
function Script() {

this.CreateInterpreter = function() {
	return new Interpreter();
};

this.CreateUtils = function() {
	return new Utils();
};

var Interpreter = function() {
	var env = new Environment();
	var parser = new Parser( env );

	this.SetDialogBuffer = function(buffer) { env.SetDialogBuffer( buffer ); };

	// TODO -- maybe this should return a string instead othe actual script??
	this.Compile = function(scriptName, scriptStr) {
		// console.log("COMPILE");
		var script = parser.Parse( scriptStr );
		env.SetScript( scriptName, script );
	}
	this.Run = function(scriptName, exitHandler) { // Runs pre-compiled script
		// console.log("RUN");
		env.GetScript( scriptName )
			.Eval( env, function() { if(exitHandler!=null) exitHandler(); } );

		// console.log("SERIALIZE!!!!");
		// console.log( env.GetScript( scriptName ).Serialize() );
	}
	this.Interpret = function(scriptStr, exitHandler) { // Compiles and runs code immediately
		// console.log("INTERPRET");
		var script = parser.Parse( scriptStr );
		script.Eval( env, function() { if(exitHandler!=null) exitHandler(); } );
	}
	this.HasScript = function(name) { return env.HasScript(name); };

	this.ResetEnvironment = function() {
		env = new Environment();
		parser = new Parser( env );
	}

	// TODO : move to utils?
	// for reading in dialog from the larger file format
	this.ReadDialogScript = function(lines, i) {
		return parser.ReadDialogScript(lines,i);
	}

	this.Parse = function(scriptStr) { // parses a script but doesn't save it
		return parser.Parse( scriptStr );
	}
	this.Eval = function(scripTree, exitHandler) { // runs a script stored externally
		scripTree.Eval( env, function() { if(exitHandler!=null) exitHandler(); } );
	}

	this.CreateExpression = function(expStr) {
		return parser.CreateExpression( expStr );
	}

	this.SetVariable = function(name,value,useHandler) {
		env.SetVariable(name,value,useHandler);
	}

	this.DeleteVariable = function(name,useHandler) {
		env.DeleteVariable(name,useHandler);
	}
	this.HasVariable = function(name) {
		return env.HasVariable(name);
	}

	this.SetOnVariableChangeHandler = function(onVariableChange) {
		env.SetOnVariableChangeHandler(onVariableChange);
	}
	this.GetVariableNames = function() {
		return env.GetVariableNames();
	}
	this.GetVariable = function(name) {
		return env.GetVariable(name);
	}
}


var Utils = function() {
	// for editor ui
	this.CreateDialogBlock = function(children,doIndentFirstLine) {
		if(doIndentFirstLine === undefined) doIndentFirstLine = true;
		var block = new BlockNode( BlockMode.Dialog, doIndentFirstLine );
		for(var i = 0; i < children.length; i++) {
			block.AddChild( children[i] );
		}
		return block;
	}

	this.ChangeSequenceType = function(oldSequence,type) {
		if(type === "sequence") {
			return new SequenceNode( oldSequence.options );
		}
		else if(type === "cycle") {
			return new CycleNode( oldSequence.options );
		}
		else if(type === "shuffle") {
			return new ShuffleNode( oldSequence.options );
		}
		return oldSequence;
	}

	this.CreateSequenceBlock = function() {
		var option1 = new BlockNode( BlockMode.Dialog, false /*doIndentFirstLine*/ );
		var option2 = new BlockNode( BlockMode.Dialog, false /*doIndentFirstLine*/ );
		var sequence = new SequenceNode( [ option1, option2 ] );
		var block = new BlockNode( BlockMode.Code );
		block.AddChild( sequence );
		return block;
	}

	this.CreateIfBlock = function() {
		var leftNode = new BlockNode( BlockMode.Code );
		leftNode.AddChild( new FuncNode("item", [new LiteralNode("0")] ) );
		var rightNode = new LiteralNode( 1 );
		var condition1 = new ExpNode("==", leftNode, rightNode );

		var condition2 = new ElseNode();

		var result1 = new BlockNode( BlockMode.Dialog );
		var result2 = new BlockNode( BlockMode.Dialog );

		var ifNode = new IfNode( [ condition1, condition2 ], [ result1, result2 ] );
		var block = new BlockNode( BlockMode.Code );
		block.AddChild( ifNode );
		return block;
	}
}


/* BUILT-IN FUNCTIONS */ // TODO: better way to encapsulate these?
function sayFunc(environment,parameters,onReturn) {
	// console.log("SAY FUNC");
	// console.log(parameters);
	if( parameters[0] != undefined && parameters[0] != null ) {
		// console.log(parameters[0]);
		// console.log(parameters[0].toString());
		// var textStr = parameters[0].toString();
		var textStr = "" + parameters[0];
		// console.log(textStr);
		var onFinishHandler = function() {
			// console.log("FINISHED PRINTING ---- SCRIPT");
			onReturn(null);
		}; // called when dialog is finished printing
		environment.GetDialogBuffer().AddText( textStr, onFinishHandler );
	}
	else
		onReturn(null);
}

function linebreakFunc(environment,parameters,onReturn) {
	// console.log("LINEBREAK FUNC");
	environment.GetDialogBuffer().AddLinebreak();
	onReturn(null);
}

function itemFunc(environment,parameters,onReturn) {
	var itemId = parameters[0];
	if(names.item.has(itemId)) itemId = names.item.get(itemId); // id is actually a name
	var itemCount = player().inventory[itemId] ? player().inventory[itemId] : 0; // TODO : ultimately the environment should include a reference to the game state
	// console.log("ITEM FUNC " + itemId + " " + itemCount);
	onReturn(itemCount);
}

function addOrRemoveTextEffect(environment,name) {
	if( environment.GetDialogBuffer().HasTextEffect(name) )
		environment.GetDialogBuffer().RemoveTextEffect(name);
	else
		environment.GetDialogBuffer().AddTextEffect(name);
}

function rainbowFunc(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"rbw");
	onReturn(null);
}

// TODO : should the colors use a parameter instead of special names?
function color1Func(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"clr1");
	onReturn(null);
}

function color2Func(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"clr2");
	onReturn(null);
}

function color3Func(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"clr3");
	onReturn(null);
}

function wavyFunc(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"wvy");
	onReturn(null);
}

function shakyFunc(environment,parameters,onReturn) {
	addOrRemoveTextEffect(environment,"shk");
	onReturn(null);
}

/* BUILT-IN OPERATORS */
function setExp(environment,left,right,onReturn) {
	// console.log("SET " + left.name);

	if(left.type != "variable") {
		// not a variable! return null and hope for the best D:
		onReturn( null );
		return;
	}

	right.Eval(environment,function(rVal) {
		environment.SetVariable( left.name, rVal );
		// console.log("VAL " + environment.GetVariable( left.name ) );
		left.Eval(environment,function(lVal) {
			onReturn( lVal );
		});
	});
}
function equalExp(environment,left,right,onReturn) {
	// console.log("EVAL EQUAL");
	// console.log(left);
	// console.log(right);
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal === rVal );
		});
	});
}
function greaterExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal > rVal );
		});
	});
}
function lessExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal < rVal );
		});
	});
}
function greaterEqExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal >= rVal );
		});
	});
}
function lessEqExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal <= rVal );
		});
	});
}
function multExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal * rVal );
		});
	});
}
function divExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal / rVal );
		});
	});
}
function addExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal + rVal );
		});
	});
}
function subExp(environment,left,right,onReturn) {
	right.Eval(environment,function(rVal){
		left.Eval(environment,function(lVal){
			onReturn( lVal - rVal );
		});
	});
}

/* ENVIRONMENT */
var Environment = function() {
	var dialogBuffer = null;
	this.SetDialogBuffer = function(buffer) { dialogBuffer = buffer; };
	this.GetDialogBuffer = function() { return dialogBuffer; };

	var functionMap = new Map();
	functionMap.set("say", sayFunc);
	functionMap.set("br", linebreakFunc);
	functionMap.set("item", itemFunc);
	functionMap.set("rbw", rainbowFunc);
	functionMap.set("clr1", color1Func);
	functionMap.set("clr2", color2Func);
	functionMap.set("clr3", color3Func);
	functionMap.set("wvy", wavyFunc);
	functionMap.set("shk", shakyFunc);

	this.HasFunction = function(name) { return functionMap.has(name); };
	this.EvalFunction = function(name,parameters,onReturn) {
		// console.log(functionMap);
		// console.log(name);
		functionMap.get( name )( this, parameters, onReturn );
	}

	var variableMap = new Map();

	// Borksy modification
	// Makes bitsy varaibles are globally available
	window.bitsyVariableMap = variableMap;

	this.HasVariable = function(name) { return variableMap.has(name); };
	this.GetVariable = function(name) { return variableMap.get(name); };
	this.SetVariable = function(name,value,useHandler) {
		// console.log("SET VARIABLE " + name + " = " + value);
		if(useHandler === undefined) useHandler = true;
		variableMap.set(name, value);
		if(onVariableChangeHandler != null && useHandler)
			onVariableChangeHandler(name);
	};
	this.DeleteVariable = function(name,useHandler) {
		if(useHandler === undefined) useHandler = true;
		if(variableMap.has(name)) {
			variableMap.delete(name);
			if(onVariableChangeHandler != null && useHandler)
				onVariableChangeHandler(name);
		}
	};

	var operatorMap = new Map();
	operatorMap.set("=", setExp);
	operatorMap.set("==", equalExp);
	operatorMap.set(">", greaterExp);
	operatorMap.set("<", lessExp);
	operatorMap.set(">=", greaterEqExp);
	operatorMap.set("<=", lessEqExp);
	operatorMap.set("*", multExp);
	operatorMap.set("/", divExp);
	operatorMap.set("+", addExp);
	operatorMap.set("-", subExp);

	this.HasOperator = function(sym) { return operatorMap.get(sym); };
	this.EvalOperator = function(sym,left,right,onReturn) {
		operatorMap.get( sym )( this, left, right, onReturn );
	}

	var scriptMap = new Map();
	this.HasScript = function(name) { return scriptMap.has(name); };
	this.GetScript = function(name) { return scriptMap.get(name); };
	this.SetScript = function(name,script) { scriptMap.set(name, script); };

	var onVariableChangeHandler = null;
	this.SetOnVariableChangeHandler = function(onVariableChange) {
		onVariableChangeHandler = onVariableChange;
	}
	this.GetVariableNames = function() {
		return Array.from( variableMap.keys() );
	}
}

function leadingWhitespace(depth) {
	var str = "";
	for(var i = 0; i < depth; i++) {
		str += "  "; // two spaces per indent
	}
	// console.log("WHITESPACE " + depth + " ::" + str + "::");
	return str;
}

/* NODES */
var TreeRelationship = function() {
	this.parent = null;
	this.children = [];
	this.AddChild = function(node) {
		this.children.push( node );
		node.parent = this;
	};

	this.VisitAll = function(visitor) {
		visitor.Visit( this );
		for( var i = 0; i < this.children.length; i++ ) {
			this.children[i].VisitAll( visitor );
		}
	};
}

var BlockMode = {
	Code : "code",
	Dialog : "dialog"
};

var BlockNode = function(mode, doIndentFirstLine) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "block";
	this.mode = mode;

	this.Eval = function(environment,onReturn) {
		// console.log("EVAL BLOCK " + this.children.length);

		if( this.onEnter != null ) this.onEnter();

		var lastVal = null;
		var i = 0;
		function evalChildren(children,done) {
			if(i < children.length) {
				// console.log(">> CHILD " + i);
				children[i].Eval( environment, function(val) {
					// console.log("<< CHILD " + i);
					lastVal = val;
					i++;
					evalChildren(children,done);
				} );
			}
			else {
				done();
			}
		};
		var self = this;
		evalChildren( this.children, function() {
			if( self.onExit != null ) self.onExit();
			onReturn(lastVal);
		} );
	}

	if(doIndentFirstLine === undefined) doIndentFirstLine = true; // This is just for serialization

	this.Serialize = function(depth) {
		if(depth === undefined) depth = 0;

		console.log("SERIALIZE BLOCK!!!");
		console.log(depth);
		console.log(doIndentFirstLine);

		var str = "";
		var lastNode = null;
		if (this.mode === BlockMode.Code) str += "{"; // todo: increase scope of Sym?
		for (var i = 0; i < this.children.length; i++) {

			var curNode = this.children[i];

			if(curNode.type === "block" && lastNode && lastNode.type === "block" && !isBlockWithNoNewline(curNode) && !isBlockWithNoNewline(lastNode))
				str += "\n";

			var shouldIndentFirstLine = (i == 0 && doIndentFirstLine);
			var shouldIndentAfterLinebreak = (lastNode && lastNode.type === "function" && lastNode.name === "br");
			if(this.mode === BlockMode.Dialog && (shouldIndentFirstLine || shouldIndentAfterLinebreak))
				str += leadingWhitespace(depth);
			str += curNode.Serialize(depth);
			lastNode = curNode;
		}
		if (this.mode === BlockMode.Code) str += "}";
		return str;
	}
}

function isBlockWithNoNewline(node) {
	return isTextEffectBlock(node) || isMultilineListBlock(node);
}

function isTextEffectBlock(node) {
	if(node.type === "block") {
		if(node.children.length > 0 && node.children[0].type === "function") {
			var func = node.children[0];
			if(func.name === "clr1" || func.name === "clr2" || func.name === "clr3" || func.name === "wvy" || func.name === "shk" || func.name === "rbw") {
				return true;
			}
		}
	}
	return false;
}

function isMultilineListBlock(node) {
	if(node.type === "block") {
		if(node.children.length > 0) {
			var child = node.children[0];
			if(child.type === "sequence" || child.type === "cycle" || child.type === "shuffle" || child.type === "if") {
				return true;
			}
		}
	}
	return false;
}

var FuncNode = function(name,arguments) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "function";
	this.name = name;
	this.arguments = arguments;

	this.Eval = function(environment,onReturn) {

		if( this.onEnter != null ) this.onEnter();

		// console.log("FUNC");
		// console.log(this.arguments);
		var argumentValues = [];
		var i = 0;
		function evalArgs(arguments,done) {
			if(i < arguments.length) {
				// Evaluate each argument
				arguments[i].Eval( environment, function(val) {
					argumentValues.push( val );
					i++;
					evalArgs(arguments,done);
				} );
			}
			else {
				done();
			}
		};
		var self = this; // hack to deal with scope
		evalArgs( this.arguments, function() {
			// Then evaluate the function
			// console.log("ARGS");
			// console.log(argumentValues);

			if( self.onExit != null ) self.onExit();

			environment.EvalFunction( self.name, argumentValues, onReturn );
		} );
	}

	this.Serialize = function(depth) {
		var isDialogBlock = this.parent.mode && this.parent.mode === BlockMode.Dialog;
		if(isDialogBlock && this.name === "say") {
			// TODO this could cause problems with "real" say functions
			return this.arguments[0].value; // first argument should be the text of the {say} func
		}
		else if(isDialogBlock && this.name === "br") {
			return "\n";
		}
		else {
			var str = "";
			str += this.name;
			for(var i = 0; i < this.arguments.length; i++) {
				str += " ";
				str += this.arguments[i].Serialize(depth);
			}
			return str;
		}
	}
}

var LiteralNode = function(value) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "literal";
	this.value = value;

	this.Eval = function(environment,onReturn) {
		onReturn(this.value);
	}

	this.Serialize = function(depth) {
		var str = "";

		if(this.value === null)
			return str;

		if(typeof this.value === "string") str += '"';
		str += this.value;
		if(typeof this.value === "string") str += '"';

		return str;
	}
}

var VarNode = function(name) {
	Object.assign( this, new TreeRelationship() );
	// Object.assign( this, new Runnable() );
	this.type = "variable";
	this.name = name;

	this.Eval = function(environment,onReturn) {
		// console.log("EVAL " + this.name + " " + environment.HasVariable(this.name) + " " + environment.GetVariable(this.name));
		if( environment.HasVariable(this.name) )
			onReturn( environment.GetVariable( this.name ) );
		else
			onReturn(null); // not a valid variable -- return null and hope that's ok
	} // TODO: might want to store nodes in the variableMap instead of values???

	this.Serialize = function(depth) {
		var str = "" + this.name;
		return str;
	}
}

var ExpNode = function(operator, left, right) {
	Object.assign( this, new TreeRelationship() );
	this.type = "operator";
	this.operator = operator;
	this.left = left;
	this.right = right;

	this.Eval = function(environment,onReturn) {
		// console.log("EVAL " + this.operator);
		var self = this; // hack to deal with scope
		environment.EvalOperator( this.operator, this.left, this.right, 
			function(val){
				// console.log("EVAL EXP " + self.operator + " " + val);
				onReturn(val);
			} );
		// NOTE : sadly this pushes a lot of complexity down onto the actual operator methods
	}

	this.Serialize = function(depth) {
		var isNegativeNumber = this.operator === "-" && this.left.type === "literal" && this.left.value === null;

		if(!isNegativeNumber) {
			var str = "";
			str += this.left.Serialize(depth);
			str += " " + this.operator + " ";
			str += this.right.Serialize(depth);
			return str;
		}
		else {
			return this.operator + this.right.Serialize(depth); // hacky but seems to work
		}
	}

	this.VisitAll = function(visitor) {
		visitor.Visit( this );
		if(this.left != null)
			this.left.VisitAll( visitor );
		if(this.right != null)
			this.right.VisitAll( visitor );
	};
}

var SequenceBase = function() {
	this.Serialize = function(depth) {
		var str = "";
		str += this.type + "\n";
		for (var i = 0; i < this.options.length; i++) {
			// console.log("SERIALIZE SEQUENCE ");
			// console.log(depth);
			str += leadingWhitespace(depth + 1) + Sym.List + " " + this.options[i].Serialize(depth + 2) + "\n";
		}
		str += leadingWhitespace(depth);
		return str;
	}

	this.VisitAll = function(visitor) {
		visitor.Visit( this );
		for( var i = 0; i < this.options.length; i++ ) {
			this.options[i].VisitAll( visitor );
		}
	};
}

var SequenceNode = function(options) {
	Object.assign( this, new TreeRelationship() );
	Object.assign( this, new SequenceBase() );
	this.type = "sequence";
	this.options = options;

	var index = 0;
	this.Eval = function(environment,onReturn) {
		// console.log("SEQUENCE " + index);
		this.options[index].Eval( environment, onReturn );

		var next = index + 1;
		if(next < this.options.length)
			index = next;
	}
}

var CycleNode = function(options) {
	Object.assign( this, new TreeRelationship() );
	Object.assign( this, new SequenceBase() );
	this.type = "cycle";
	this.options = options;

	var index = 0;
	this.Eval = function(environment,onReturn) {
		// console.log("CYCLE " + index);
		this.options[index].Eval( environment, onReturn );

		var next = index + 1;
		if(next < this.options.length)
			index = next;
		else
			index = 0;
	}
}

var ShuffleNode = function(options) {
	Object.assign( this, new TreeRelationship() );
	Object.assign( this, new SequenceBase() );
	this.type = "shuffle";
	this.options = options;

	var optionsShuffled = [];
	function shuffle(options) {
		optionsShuffled = [];
		var optionsUnshuffled = options.slice();
		while(optionsUnshuffled.length > 0) {
			var i = Math.floor( Math.random() * optionsUnshuffled.length );
			optionsShuffled.push( optionsUnshuffled.splice(i,1)[0] );
		}
	}
	shuffle(this.options);

	var index = 0;
	this.Eval = function(environment,onReturn) {
		// OLD RANDOM VERSION
		// var index = Math.floor(Math.random() * this.options.length);
		// this.options[index].Eval( environment, onReturn );

		optionsShuffled[index].Eval( environment, onReturn );
		
		index++;
		if (index >= this.options.length) {
			shuffle(this.options);
			index = 0;
		}
	}
}

var IfNode = function(conditions, results, isSingleLine) {
	Object.assign( this, new TreeRelationship() );
	this.type = "if";
	this.conditions = conditions;
	this.results = results;

	this.Eval = function(environment,onReturn) {
		// console.log("EVAL IF");
		var i = 0;
		var self = this;
		function TestCondition() {
			// console.log("EVAL " + i);
			self.conditions[i].Eval(environment, function(val) {
				// console.log(val);
				if(val == true) {
					self.results[i].Eval(environment, onReturn);
				}
				else if(i+1 < self.conditions.length) {
					i++;
					TestCondition(); // test next condition
				}
				else {
					onReturn(null); // out of conditions and none were true
				}
			});
		};
		TestCondition();
	}

	if(isSingleLine === undefined) isSingleLine = false; // This is just for serialization

	this.Serialize = function(depth) {
		var str = "";
		if(isSingleLine) {
			str += this.conditions[0].Serialize() + " ? " + this.results[0].Serialize();
			if(this.conditions.length > 1 && this.conditions[1].type === "else")
				str += " : " + this.results[1].Serialize();
		}
		else {
			str += "\n";
			for (var i = 0; i < this.conditions.length; i++) {
				str += leadingWhitespace(depth + 1) + Sym.List + " " + this.conditions[i].Serialize(depth) + " ?\n";
				str += this.results[i].Serialize(depth + 2) + "\n";
			}
			str += leadingWhitespace(depth);
		}
		return str;
	}

	this.IsSingleLine = function() {
		return isSingleLine;
	}

	this.VisitAll = function(visitor) {
		visitor.Visit( this );
		for( var i = 0; i < this.conditions.length; i++ ) {
			this.conditions[i].VisitAll( visitor );
		}
		for( var i = 0; i < this.results.length; i++ ) {
			this.results[i].VisitAll( visitor );
		}
	};
}

var ElseNode = function() {
	Object.assign( this, new TreeRelationship() );
	this.type = "else";

	this.Eval = function(environment,onReturn) {
		onReturn(true);
	}

	this.Serialize = function() {
		return "else";
	}
}

var Sym = {
	// DialogOpen : "/\"",
	// DialogClose : "\"/",
	DialogOpen : '"""',
	DialogClose : '"""',
	CodeOpen : "{",
	CodeClose : "}",
	Linebreak : "\n", // just call it "break" ?
	Separator : ":",
	List : "-",
	String : '"'
};

var Parser = function(env) {
	var environment = env;

	this.Parse = function(scriptStr) {
		// console.log("NEW PARSE!!!!!!");

		// TODO : make this work for single-line, no dialog block scripts

		var state = new ParserState( new BlockNode(BlockMode.Dialog), scriptStr );

		if( state.MatchAhead(Sym.DialogOpen) ) {
			// multi-line dialog block
			var dialogStr = state.ConsumeBlock( Sym.DialogOpen, Sym.DialogClose );
			state = new ParserState( new BlockNode(BlockMode.Dialog), dialogStr );
			state = ParseDialog( state );
		}
		// else if( state.MatchAhead(Sym.CodeOpen) ) { // NOTE: This causes problems when you lead with a code block
		// 	// code-block: should this ever happen?
		// 	state = ParseCodeBlock( state );
		// }
		else {
			// single-line dialog block
			state = ParseDialog( state );
		}

		// console.log( state.rootNode );
		return state.rootNode;
	};

	this.ReadDialogScript = function(lines, i) {
		var scriptStr = "";
		if (lines[i] === Sym.DialogOpen) {
			scriptStr += lines[i] + "\n";
			i++;
			while(lines[i] != Sym.DialogClose) {
				scriptStr += lines[i] + "\n";
				i++;
			}
			scriptStr += lines[i];
			i++;
		}
		else {
			scriptStr += lines[i];
		}
		return { script:scriptStr, index:i };
	}

	var ParserState = function( rootNode, str ) {
		this.rootNode = rootNode;
		this.curNode = this.rootNode;

		var sourceStr = str;
		var i = 0;
		this.Index = function() { return i; };
		this.Count = function() { return sourceStr.length; };
		this.Done = function() { return i >= sourceStr.length; };
		this.Char = function() { return sourceStr[i]; };
		this.Step = function(n) { if(n===undefined) n=1; i += n; };
		this.MatchAhead = function(str) {
			// console.log(str);
			str = "" + str; // hack to turn single chars into strings
			// console.log(str);
			// console.log(str.length);
			for(var j = 0; j < str.length; j++) {
				if( i + j >= sourceStr.length )
					return false;
				else if( str[j] != sourceStr[i+j] )
					return false;
			}
			return true;
		}
		this.Peak = function(end) {
			var str = "";
			var j = i;
			// console.log(j);
			while(j < sourceStr.length && end.indexOf( sourceStr[j] ) == -1 ) {
				str += sourceStr[j];
				j++;
			}
			// console.log("PEAK ::" + str + "::");
			return str;
		}
		this.ConsumeBlock = function( open, close ) {
			var startIndex = i;

			var matchCount = 0;
			if( this.MatchAhead( open ) ) {
				matchCount++;
				this.Step( open.length );
			}

			while( matchCount > 0 && !this.Done() ) {
				if( this.MatchAhead( close ) ) {
					matchCount--;
					this.Step( close.length );
				}
				else if( this.MatchAhead( open ) ) {
					matchCount++;
					this.Step( open.length );
				}
				else {
					this.Step();
				}
			}

			// console.log("!!! " + startIndex + " " + i);

			return sourceStr.slice( startIndex + open.length, i - close.length );
		}
		this.Print = function() {console.log(sourceStr);};
	};

	function ParseDialog(state) {
		// console.log("PARSE DIALOG");
		state.Print();

		// for linebreak logic: add linebreaks after lines with dialog or empty lines (if it's not the very first line)
		var hasBlock = false;
		var hasDialog = false;
		var isFirstLine = true;

		// console.log("---- PARSE DIALOG ----");

		var text = "";
		var addTextNode = function() {
			// console.log("TEXT " + text.length);
			if (text.length > 0) {
				// console.log("TEXT " + text);
				// console.log("text!!");
				// console.log([text]);

				state.curNode.AddChild( new FuncNode( "say", [new LiteralNode(text)] ) );
				text = "";

				hasDialog = true;
			}
		}

		while ( !state.Done() ) {

			if( state.MatchAhead(Sym.CodeOpen) ) {
				addTextNode();
				state = ParseCodeBlock( state );

				// console.log("CODE");

				var len = state.curNode.children.length;
				if(len > 0 && state.curNode.children[len-1].type === "block") {
					var block = state.curNode.children[len-1];
					if(isMultilineListBlock(block))
						hasDialog = true; // hack to get correct newline behavior for multiline blocks
				}

				hasBlock = true;
			}
			// NOTE: nested dialog blocks disabled for now
			// else if( state.MatchAhead(Sym.DialogOpen) ) {
			// 	addTextNode();
			// 	state = ParseDialogBlock( state ); // These can be nested (should they though???)

			// 	hasBlock = true;
			// }
			else {
				if ( state.MatchAhead(Sym.Linebreak) ) {
					addTextNode();

					/*
					NOTES:
					linebreaks SHOULD happen on
					- lines with text (including the first or last line)
					- empty lines (that are NOT the first or last line)
					linebreaks should NOT happen on
					- lines with only CODE blocks
					- empty FIRST or LAST lines

					also, apparently:
					- NEVER line break on the last line
					*/
					var isLastLine = (state.Index() + 1) == state.Count();
					// console.log("block " + hasBlock);
					// console.log("dialog " + hasDialog);
					var isEmptyLine = !hasBlock && !hasDialog;
					// console.log("empty " + isEmptyLine);
					var isValidEmptyLine = isEmptyLine && !(isFirstLine || isLastLine);
					// console.log("valid empty " + isValidEmptyLine);
					var shouldAddLinebreak = (hasDialog || isValidEmptyLine) && !isLastLine; // last clause is a hack (but it works - why?)
					// console.log("LINEBREAK? " + shouldAddLinebreak);
					if( shouldAddLinebreak ) {
						// console.log("NEWLINE");
						// console.log("empty? " + isEmptyLine);
						// console.log("dialog? " + hasDialog);
						state.curNode.AddChild( new FuncNode( "br", [] ) ); // use function or character?
					}

					// linebreak logic
					isFirstLine = false;
					hasBlock = false;
					hasDialog = false;

					text = "";
				}
				else {
					text += state.Char();
				}
				state.Step();
			}

		}
		addTextNode();

		// console.log("---- PARSE DIALOG ----");

		// console.log(state);
		return state;
	}

	function ParseDialogBlock(state) {
		var dialogStr = state.ConsumeBlock( Sym.DialogOpen, Sym.DialogClose );

		var dialogState = new ParserState( new BlockNode(BlockMode.Dialog), dialogStr );
		dialogState = ParseDialog( dialogState );

		state.curNode.AddChild( dialogState.rootNode );

		return state;
	}

	function ParseIf(state) {
		var conditionStrings = [];
		var resultStrings = [];
		var curIndex = -1;
		var isNewline = true;
		var isConditionDone = false;
		var codeBlockCount = 0;

		while( !state.Done() ) {
			if(state.Char() === Sym.CodeOpen)
				codeBlockCount++;
			else if(state.Char() === Sym.CodeClose)
				codeBlockCount--;

			var isWhitespace = (state.Char() === " " || state.Char() === "\t");
			var isSkippableWhitespace = isNewline && isWhitespace;
			var isNewListItem = isNewline && (codeBlockCount <= 0) && (state.Char() === Sym.List);

			if(isNewListItem) {
				curIndex++;
				isConditionDone = false;
				conditionStrings[curIndex] = "";
				resultStrings[curIndex] = "";
			}
			else if(curIndex > -1) {
				if(!isConditionDone) {
					if(state.Char() === "?" || state.Char() === "\n") { // TODO: use Sym
						// end of condition
						isConditionDone = true;
					}
					else {
						// read in condition
						conditionStrings[curIndex] += state.Char();
					}
				}
				else {
					// read in result
					if(!isSkippableWhitespace)
						resultStrings[curIndex] += state.Char();
				}
			}

			isNewline = (state.Char() === Sym.Linebreak) || isSkippableWhitespace || isNewListItem;

			state.Step();
		}

		// console.log("PARSE IF:");
		// console.log(conditionStrings);
		// console.log(resultStrings);

		var conditions = [];
		for(var i = 0; i < conditionStrings.length; i++) {
			var str = conditionStrings[i].trim();
			if(str === "else") {
				conditions.push( new ElseNode() );
			}
			else {
				var exp = CreateExpression( str );
				conditions.push( exp );
			}
		}

		var results = [];
		for(var i = 0; i < resultStrings.length; i++) {
			var str = resultStrings[i];
			var dialogBlockState = new ParserState( new BlockNode(BlockMode.Dialog), str );
			dialogBlockState = ParseDialog( dialogBlockState );
			var dialogBlock = dialogBlockState.rootNode;
			results.push( dialogBlock );
		}

		state.curNode.AddChild( new IfNode( conditions, results ) );

		return state;
	}

	function IsSequence(str) {
		// console.log("IsSequence? " + str);
		return str === "sequence" || str === "cycle" || str === "shuffle";
	}

	// TODO: don't forget about eating whitespace
	function ParseSequence(state, sequenceType) {
		// console.log("SEQUENCE " + sequenceType);
		state.Print();

		var isNewline = false;
		var itemStrings = [];
		var curItemIndex = -1; // -1 indicates not reading an item yet
		var codeBlockCount = 0;

		while( !state.Done() ) {
			if(state.Char() === Sym.CodeOpen)
				codeBlockCount++;
			else if(state.Char() === Sym.CodeClose)
				codeBlockCount--;

			var isWhitespace = (state.Char() === " " || state.Char() === "\t");
			var isSkippableWhitespace = isNewline && isWhitespace;
			var isNewListItem = isNewline && (codeBlockCount <= 0) && (state.Char() === Sym.List);

			if(isNewListItem) {
				// console.log("found next list item");
				curItemIndex++;
				itemStrings[curItemIndex] = "";
			}
			else if(curItemIndex > -1) {
				if(!isSkippableWhitespace)
					itemStrings[curItemIndex] += state.Char();
			}

			isNewline = (state.Char() === Sym.Linebreak) || isSkippableWhitespace || isNewListItem;

			// console.log(state.Char());
			state.Step();
		}
		// console.log(itemStrings);
		// console.log("SEQUENCE DONE");

		var options = [];
		for(var i = 0; i < itemStrings.length; i++) {
			var str = itemStrings[i];
			var dialogBlockState = new ParserState( new BlockNode( BlockMode.Dialog, false /* doIndentFirstLine */ ), str );
			dialogBlockState = ParseDialog( dialogBlockState );
			var dialogBlock = dialogBlockState.rootNode;
			options.push( dialogBlock );
		}

		// console.log(options);

		if(sequenceType === "sequence")
			state.curNode.AddChild( new SequenceNode( options ) );
		else if(sequenceType === "cycle")
			state.curNode.AddChild( new CycleNode( options ) );
		else if(sequenceType === "shuffle")
			state.curNode.AddChild( new ShuffleNode( options ) );

		return state;
	}

	function ParseFunction(state, funcName) {
		var args = [];

		var curSymbol = "";
		function OnSymbolEnd() {
			curSymbol = curSymbol.trim();
			console.log("PARAMTER " + curSymbol);
			args.push( StringToValue(curSymbol) );
			console.log(args);
			curSymbol = "";
		}

		while( !( state.Char() === "\n" || state.Done() ) ) {
			if( state.MatchAhead(Sym.CodeOpen) ) {
				var codeBlockState = new ParserState( new BlockNode(BlockMode.Code), state.ConsumeBlock( Sym.CodeOpen, Sym.CodeClose ) );
				codeBlockState = ParseCode( codeBlockState );
				var codeBlock = codeBlockState.rootNode;
				args.push( codeBlock );
				curSymbol = "";
			}
			else if( state.MatchAhead(Sym.String) ) {
				/* STRING LITERAL */
				var str = state.ConsumeBlock(Sym.String, Sym.String);
				// console.log("STRING " + str);
				args.push( new LiteralNode(str) );
				curSymbol = "";
			}
			else if(state.Char() === " " && curSymbol.length > 0) {
				OnSymbolEnd();
			}
			else {
				curSymbol += state.Char();
			}
			state.Step();
		}

		if(curSymbol.length > 0) {
			OnSymbolEnd();
		}

		state.curNode.AddChild( new FuncNode( funcName, args ) );

		return state;
	}

	function IsValidVariableName(str) {
		var reg = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;
		var isValid = reg.test(str);
		console.log("VALID variable??? " + isValid);
		return isValid;
	}

	function StringToValue(valStr) {
		if(valStr[0] === Sym.CodeOpen) {
			// CODE BLOCK!!!
			var codeStr = (new ParserState( null, valStr )).ConsumeBlock(Sym.CodeOpen, Sym.CodeClose); //hacky
			var codeBlockState = new ParserState( new BlockNode( BlockMode.Code ), codeStr );
			codeBlockState = ParseCode( codeBlockState );
			return codeBlockState.rootNode;
		}
		else if(valStr[0] === Sym.String) {
			// STRING!!
			console.log("STRING");
			var str = "";
			var i = 1;
			while (i < valStr.length && valStr[i] != Sym.String) {
				str += valStr[i];
				i++;
			}
			console.log(str);
			return new LiteralNode( str );
		}
		else if(valStr === "true") {
			// BOOL
			return new LiteralNode( true );
		}
		else if(valStr === "false") {
			// BOOL
			return new LiteralNode( false );
		}
		else if( !isNaN(parseFloat(valStr)) ) {
			// NUMBER!!
			// console.log("NUMBER!!! " + valStr);
			return new LiteralNode( parseFloat(valStr) );
		}
		else if(IsValidVariableName(valStr)) {
			// VARIABLE!!
			// console.log("VARIABLE");
			return new VarNode(valStr); // TODO : check for valid potential variables
		}
		else {
			// uh oh
			return new LiteralNode(null);
		}
	}

	var setSymbol = "=";
	var ifSymbol = "?";
	var elseSymbol = ":";
	// var operatorSymbols = ["==", ">", "<", ">=", "<=", "*", "/", "+", "-"];
	var operatorSymbols = ["-", "+", "/", "*", "<=", ">=", "<", ">", "=="]; // operators need to be in reverse order
	function CreateExpression(expStr) {
		expStr = expStr.trim();

		function IsInsideString(index) {
			var inString = false;
			for(var i = 0; i < expStr.length; i++) {
				if(expStr[i] === Sym.String)
					inString = !inString;

				if(index === i)
					return inString;
			}
			return false;
		}

		function IsInsideCode(index) {
			var count = 0;
			for(var i = 0; i < expStr.length; i++) {
				if(expStr[i] === Sym.CodeOpen)
					count++;
				else if(expStr[i] === Sym.CodeClose)
					count--;

				if(index === i)
					return count > 0;
			}
			return false;
		}
	
		var operator = null;

		// set is special because other operator can look like it, and it has to go first in the order of operations
		var setIndex = expStr.indexOf(setSymbol);
		if( setIndex > -1 && !IsInsideString(setIndex) && !IsInsideCode(setIndex) ) { // it might be a set operator
			if( expStr[setIndex+1] != "=" && expStr[setIndex-1] != ">" && expStr[setIndex-1] != "<" ) {
				// ok it actually IS a set operator and not ==, >=, or <=
				operator = setSymbol;
				var variableName = expStr.substring(0,setIndex).trim(); // TODO : valid variable name testing
				var left = IsValidVariableName(variableName) ? new VarNode( variableName ) : new LiteralNode(null);
				var right = CreateExpression( expStr.substring(setIndex+setSymbol.length) );
				var exp = new ExpNode( operator, left, right );
				return exp;
			}
		}

		// special if "expression" for single-line if statements
		var ifIndex = expStr.indexOf(ifSymbol);
		if( ifIndex > -1 && !IsInsideString(ifIndex) && !IsInsideCode(ifIndex) ) {
			operator = ifSymbol;
			var conditionStr = expStr.substring(0,ifIndex).trim();
			var conditions = [ CreateExpression(conditionStr) ];

			var resultStr = expStr.substring(ifIndex+ifSymbol.length);
			var results = [];
			function AddResult(str) {
				var dialogBlockState = new ParserState( new BlockNode(BlockMode.Dialog), str );
				dialogBlockState = ParseDialog( dialogBlockState );
				var dialogBlock = dialogBlockState.rootNode;
				results.push( dialogBlock );
			}

			var elseIndex = resultStr.indexOf(elseSymbol); // does this need to test for strings?
			if(elseIndex > -1) {
				conditions.push( new ElseNode() );

				var elseStr = resultStr.substring(elseIndex+elseSymbol.length);
				var resultStr = resultStr.substring(0,elseIndex);

				AddResult( resultStr.trim() );
				AddResult( elseStr.trim() );
			}
			else {
				AddResult( resultStr.trim() );
			}

			return new IfNode( conditions, results, true /*isSingleLine*/ );
		}

		for( var i = 0; (operator == null) && (i < operatorSymbols.length); i++ ) {
			var opSym = operatorSymbols[i];
			var opIndex = expStr.indexOf( opSym );
			if( opIndex > -1 && !IsInsideString(opIndex) && !IsInsideCode(opIndex) ) {
				operator = opSym;
				var left = CreateExpression( expStr.substring(0,opIndex) );
				var right = CreateExpression( expStr.substring(opIndex+opSym.length) );
				var exp = new ExpNode( operator, left, right );
				return exp;
			}
		}

		if( operator == null ) {
			return StringToValue(expStr);
		}
	}
	this.CreateExpression = CreateExpression;

	function ParseExpression(state) {
		var line = state.Peak( [Sym.Linebreak] );
		// console.log("EXPRESSION " + line);
		var exp = CreateExpression( line );
		// console.log(exp);
		state.curNode.AddChild( exp );
		state.Step( line.length );
		return state;
	}

	function ParseCode(state) {
		// TODO : how do I do this parsing??? one expression per block? or per line?
		while ( !state.Done() ) {

			if( state.Char() === " " || state.Char() === "\t" || state.Char() === "\n" ) { // TODO: symbols? IsWhitespace func?
				state.Step(); // consume whitespace
			}
			else if( state.MatchAhead(Sym.CodeOpen) ) {
				state = ParseCodeBlock( state );
			}
			// NOTE: nested dialog blocks disabled for now
			// else if( state.MatchAhead(Sym.DialogOpen) ) {
			// 	state = ParseDialogBlock( state ); // These can be nested (should they though???)
			// }
			else if( state.Char() === Sym.List && (state.Peak([]).indexOf("?") > -1) ) { // TODO : symbols? matchahead?
				// console.log("PEAK IF " + state.Peak( ["?"] ));
				state = ParseIf( state );
			}
			else if( environment.HasFunction( state.Peak( [" "] ) ) ) { // TODO --- what about newlines???
				var funcName = state.Peak( [" "] );
				state.Step( funcName.length );
				state = ParseFunction( state, funcName );
			}
			else if( IsSequence( state.Peak( [" ", Sym.Linebreak] ) ) ) {
				var sequenceType = state.Peak( [" ", Sym.Linebreak] );
				state.Step( sequenceType.length );
				state = ParseSequence( state, sequenceType );
			}
			else {
				state = ParseExpression( state );
			}
		}

		return state;
	}

	function ParseCodeBlock(state) {
		var codeStr = state.ConsumeBlock( Sym.CodeOpen, Sym.CodeClose );

		// console.log("PARSE CODE");
		// console.log(codeStr);

		var codeState = new ParserState( new BlockNode(BlockMode.Code), codeStr );
		codeState = ParseCode( codeState );
		
		state.curNode.AddChild( codeState.rootNode );

		return state;
	}

}

} // Script()
</script>

<script>
function Dialog() {

this.CreateRenderer = function() {
	return new DialogRenderer();
};

this.CreateBuffer = function() {
	return new DialogBuffer();
};

var DialogRenderer = function() {
	var textboxInfo = {
		img : null,
		width : 104,
		height : 8+4+2+5, //8 for text, 4 for top-bottom padding, 2 for line padding, 5 for arrow
		top : 12,
		left : 12,
		bottom : 12, //for drawing it from the bottom
	};
	
	var font = new Font();

	var context = null;
	this.AttachContext = function(c) {
		context = c;
	};

	this.ClearTextbox = function() {
		if(context == null) return;

		//create new image none exists
		if(textboxInfo.img == null)
			textboxInfo.img = context.createImageData(textboxInfo.width*scale, textboxInfo.height*scale);

		// fill text box with black
		for (var i=0;i<textboxInfo.img.data.length;i+=4)
		{
			textboxInfo.img.data[i+0]=0;
			textboxInfo.img.data[i+1]=0;
			textboxInfo.img.data[i+2]=0;
			textboxInfo.img.data[i+3]=255;
		}
	};

	var isCentered = false;
	this.SetCentered = function(centered) {
		isCentered = centered;
	};

	this.DrawTextbox = function() {
		if(context == null) return;
		if (isCentered) {
			context.putImageData(textboxInfo.img, textboxInfo.left*scale, ((height/2)-(textboxInfo.height/2))*scale);
		}
		else if (player().y < mapsize/2) {
			//bottom
			context.putImageData(textboxInfo.img, textboxInfo.left*scale, (height-textboxInfo.bottom-textboxInfo.height)*scale);
		}
		else {
			//top
			context.putImageData(textboxInfo.img, textboxInfo.left*scale, textboxInfo.top*scale);
		}
	};

	var arrowdata = [
		1,1,1,1,1,
		0,1,1,1,0,
		0,0,1,0,0
	];
	this.DrawNextArrow = function() {
		// console.log("draw arrow!");
		var top = (textboxInfo.height-5) * scale;
		var left = (textboxInfo.width-(5+4)) * scale;
		for (var y = 0; y < 3; y++) {
			for (var x = 0; x < 5; x++) {
				var i = (y * 5) + x;
				if (arrowdata[i] == 1) {
					//scaling nonsense
					for (var sy = 0; sy < scale; sy++) {
						for (var sx = 0; sx < scale; sx++) {
							var pxl = 4 * ( ((top+(y*scale)+sy) * (textboxInfo.width*scale)) + (left+(x*scale)+sx) );
							textboxInfo.img.data[pxl+0] = 255;
							textboxInfo.img.data[pxl+1] = 255;
							textboxInfo.img.data[pxl+2] = 255;
							textboxInfo.img.data[pxl+3] = 255;
						}
					}
				}
			}
		}
	};

	var text_scale = 2; //using a different scaling factor for text feels like cheating... but it looks better
	this.DrawChar = function(char, row, col) {
		char.offset = {x:0, y:0};
		char.SetPosition(row,col);
		char.ApplyEffects(effectTime);
		var charData = font.getChar( char.char );
		var top = (4 * scale) + (row * 2 * scale) + (row * 8 * text_scale) + Math.floor( char.offset.y );
		var left = (4 * scale) + (col * 6 * text_scale) + Math.floor( char.offset.x );
		for (var y = 0; y < 8; y++) {
			for (var x = 0; x < 6; x++) {
				var i = (y * 6) + x;
				if ( charData[i] == 1 ) {

					//scaling nonsense
					for (var sy = 0; sy < text_scale; sy++) {
						for (var sx = 0; sx < text_scale; sx++) {
							var pxl = 4 * ( ((top+(y*text_scale)+sy) * (textboxInfo.width*scale)) + (left+(x*text_scale)+sx) );
							textboxInfo.img.data[pxl+0] = char.color.r;
							textboxInfo.img.data[pxl+1] = char.color.g;
							textboxInfo.img.data[pxl+2] = char.color.b;
							textboxInfo.img.data[pxl+3] = char.color.a;
						}
					}

					
				}
			}
		}
		
		// call printHandler for character
		char.OnPrint();
	};

	var effectTime = 0; // TODO this variable should live somewhere better
	this.Draw = function(buffer,dt) { // TODO move out of the buffer?? (into say a dialog box renderer)
		effectTime += dt;

		this.ClearTextbox();

		buffer.ForEachActiveChar( this.DrawChar );

		if( buffer.CanContinue() )
			this.DrawNextArrow();

		this.DrawTextbox();

		if( buffer.DidPageFinishThisFrame() && onPageFinish != null )
			onPageFinish();
	};

	/* this is a hook for GIF rendering */
	var onPageFinish = null;
	this.SetPageFinishHandler = function(handler) {
		onPageFinish = handler;
	};

	this.Reset = function() {
		effectTime = 0;
		// TODO - anything else?
	}
}


var DialogBuffer = function() {
	var buffer = [[[]]]; // holds dialog in an array buffer
	var pageIndex = 0;
	var rowIndex = 0;
	var charIndex = 0;
	var nextCharTimer = 0;
	var nextCharMaxTime = 50; // in milliseconds
	var isDialogReadyToContinue = false;
	var activeTextEffects = [];
	
	this.CurPage = function() { return buffer[ pageIndex ]; };
	this.CurRow = function() { return this.CurPage()[ rowIndex ]; };
	this.CurChar = function() { return this.CurRow()[ charIndex ]; };
	this.CurPageCount = function() { return buffer.length; };
	this.CurRowCount = function() { return this.CurPage().length; };
	this.CurCharCount = function() { return this.CurRow().length; };

	this.ForEachActiveChar = function(handler) { // Iterates over visible characters on the active page
		var rowCount = rowIndex + 1;
		for (var i = 0; i < rowCount; i++) {
			var row = this.CurPage()[i];
			var charCount = (i == rowIndex) ? charIndex+1 : row.length;
			// console.log(charCount);
			for(var j = 0; j < charCount; j++) {
				var char = row[j];
				if(char)
					handler( char, i /*rowIndex*/, j /*colIndex*/ );
			}
		}
	}

	this.Reset = function() {
		buffer = [[[]]];
		pageIndex = 0;
		rowIndex = 0;
		charIndex = 0;
		isDialogReadyToContinue = false;

		activeTextEffects = [];

		isActive = false;
	};

	this.DoNextChar = function() {
		// console.log("DO NEXT CHAR");

		nextCharTimer = 0; //reset timer

		//time to update characters
		if (charIndex + 1 < this.CurCharCount()) {
			//add char to current row
			charIndex++;
		}
		else if (rowIndex + 1 < this.CurRowCount()) {
			//start next row
			rowIndex++;
			charIndex = 0;
		}
		else {
			//the page is full!
			isDialogReadyToContinue = true;
			didPageFinishThisFrame = true;

			// console.log("WAITING FOR INPUT");
		}

		// console.log(this.CurChar());
		if(this.CurChar() != null)
			this.CurChar().OnPrint(); // make sure we hit the callback before we run out of text
	};

	this.Update = function(dt) {
		didPageFinishThisFrame = false;
		didFlipPageThisFrame = false;
		// this.Draw(dt); // TODO move into a renderer object
		if (isDialogReadyToContinue) {
			return; //waiting for dialog to be advanced by player
		}

		nextCharTimer += dt; //tick timer

		if (nextCharTimer > nextCharMaxTime) {
			this.DoNextChar();
		}
	};

	this.Skip = function() {
		console.log("SKIPPP");
		didPageFinishThisFrame = false;
		didFlipPageThisFrame = false;
		// add new characters until you get to the end of the current line of dialog
		while (rowIndex < this.CurRowCount()) {
			this.DoNextChar();

			if(isDialogReadyToContinue) {
				//make sure to push the rowIndex past the end to break out of the loop
				rowIndex++;
				charIndex = 0;
			}
		}
		rowIndex = this.CurRowCount()-1;
		charIndex = this.CurCharCount()-1;
	};

	this.FlipPage = function() {
		didFlipPageThisFrame = true;
		isDialogReadyToContinue = false;
		pageIndex++;
		rowIndex = 0;
		charIndex = 0;
	}

	this.EndDialog = function() {
		console.log("END!!!!");
		isActive = false; // no more text to show... this should be a sign to stop rendering dialog
	}

	this.Continue = function() {
		console.log("CONTINUE");
		if (pageIndex + 1 < this.CurPageCount()) {
			//start next page
			this.FlipPage();
			return true; /* hasMoreDialog */
		}
		else {
			//end dialog mode
			this.EndDialog();
			return false; /* hasMoreDialog */
		}
	};

	var isActive = false;
	this.IsActive = function() { return isActive; };

	this.CanContinue = function() { return isDialogReadyToContinue; };

	function DialogChar(char,effectList) {
		this.char = char;
		this.effectList = effectList.slice(); // clone effect list (since it can change between chars)

		this.color = { r:255, g:255, b:255, a:255 };
		this.offset = { x:0, y:0 }; // in pixels (screen pixels?)
		this.row = 0;
		this.col = 0;
		this.SetPosition = function(row,col) {
			this.row = row;
			this.col = col;
		};

		this.ApplyEffects = function(time) {
			for(var i = 0; i < this.effectList.length; i++) {
				var effectName = this.effectList[i];
				TextEffects[ effectName ].DoEffect( this, time );
			}
		}

		var printHandler = null; // optional function to be called once on printing character
		this.SetPrintHandler = function(handler) {
			printHandler = handler;
		}
		this.OnPrint = function() {
			if (printHandler != null) {
				console.log("PRINT HANDLER ---- DIALOG BUFFER");
				printHandler();
				printHandler = null; // only call handler once (hacky)
			}
		}
	};

	function AddWordToCharArray(charArray,word,effectList) {
		for(var i = 0; i < word.length; i++) {
			charArray.push( new DialogChar( word[i], effectList ) );
		}
		return charArray;
	}

	var charsPerRow = 32;
	this.AddText = function(textStr,onFinishHandler) {
		console.log("ADD TEXT " + textStr);

		//process dialog so it's easier to display
		var words = textStr.split(" ");

		// var curPageIndex = this.CurPageCount() - 1;
		// var curRowIndex = this.CurRowCount() - 1;
		// var curRowArr = this.CurRow();

		var curPageIndex = buffer.length - 1;
		var curRowIndex = buffer[curPageIndex].length - 1;
		var curRowArr = buffer[curPageIndex][curRowIndex];

		for (var i = 0; i < words.length; i++) {
			var word = words[i];
			var wordLength = word.length + ((i == 0) ? 0 : 1);
			if (curRowArr.length + wordLength <= charsPerRow || curRowArr.length <= 0) {
				//stay on same row
				var wordWithPrecedingSpace = ((i == 0) ? "" : " ") + word;
				curRowArr = AddWordToCharArray( curRowArr, wordWithPrecedingSpace, activeTextEffects );
			}
			else if (curRowIndex == 0) {
				//start next row
				buffer[ curPageIndex ][ curRowIndex ] = curRowArr;
				buffer[ curPageIndex ].push( [] );
				curRowIndex++;
				curRowArr = buffer[ curPageIndex ][ curRowIndex ];
				curRowArr = AddWordToCharArray( curRowArr, word, activeTextEffects );
			}
			else {
				//start next page
				buffer[ curPageIndex ][ curRowIndex ] = curRowArr;
				buffer.push( [] );
				curPageIndex++;
				buffer[ curPageIndex ].push( [] );
				curRowIndex = 0;
				curRowArr = buffer[ curPageIndex ][ curRowIndex ];
				curRowArr = AddWordToCharArray( curRowArr, word, activeTextEffects );
			}
		}

		//destroy any empty stuff
		var lastPage = buffer[ buffer.length-1 ];
		var lastRow = lastPage[ lastPage.length-1 ];
		if( lastRow.length == 0 )
			lastPage.splice( lastPage.length-1, 1 );
		if( lastPage.length == 0 )
			buffer.splice( buffer.length-1, 1 );

		//finish up 
		lastPage = buffer[ buffer.length-1 ];
		lastRow = lastPage[ lastPage.length-1 ];
		if( lastRow.length > 0 ) {
			var lastChar = lastRow[ lastRow.length-1 ];
			lastChar.SetPrintHandler( onFinishHandler );
		}

		console.log(buffer);

		isActive = true;
	};

	this.AddLinebreak = function() {
		var lastPage = buffer[ buffer.length-1 ];
		if( lastPage.length <= 1 ) {
			console.log("LINEBREAK - NEW ROW ");
			// add new row
			lastPage.push( [] );
		}
		else {
			// add new page
			buffer.push( [[]] );
		}
		console.log(buffer);

		isActive = true;
	}

	/* new text effects */
	this.HasTextEffect = function(name) {
		return activeTextEffects.indexOf( name ) > -1;
	}
	this.AddTextEffect = function(name) {
		activeTextEffects.push( name );
	}
	this.RemoveTextEffect = function(name) {
		activeTextEffects.splice( activeTextEffects.indexOf( name ), 1 );
	}

	/* this is a hook for GIF rendering */
	var didPageFinishThisFrame = false;
	this.DidPageFinishThisFrame = function(){ return didPageFinishThisFrame; };

	var didFlipPageThisFrame = false;
	this.DidFlipPageThisFrame = function(){ return didFlipPageThisFrame; };
};

/* NEW TEXT EFFECTS */
var TextEffects = new Map();

var RainbowEffect = function() { // TODO - should it be an object or just a method?
	this.DoEffect = function(char,time) {
		var h = Math.abs( Math.sin( (time / 600) - (char.col / 8) ) );
		var rgb = hslToRgb( h, 1, 0.5 );
		char.color.r = rgb[0];
		char.color.g = rgb[1];
		char.color.b = rgb[2];
		char.color.a = 255;
	}
};
TextEffects["rbw"] = new RainbowEffect();

var ColorEffect = function(index) {
	this.DoEffect = function(char) {
		var pal = getPal( curPal() );
		var color = pal[ parseInt( index ) ];
		console.log(color);
		char.color.r = color[0];
		char.color.g = color[1];
		char.color.b = color[2];
		char.color.a = 255;
	}
};
TextEffects["clr1"] = new ColorEffect(0);
TextEffects["clr2"] = new ColorEffect(1); // TODO : should I use parameters instead of special names?
TextEffects["clr3"] = new ColorEffect(2);

var WavyEffect = function() {
	this.DoEffect = function(char,time) {
		char.offset.y += Math.sin( (time / 250) - (char.col / 2) ) * 4;
	}
};
TextEffects["wvy"] = new WavyEffect();

var ShakyEffect = function() {
	function disturb(func,time,offset,mult1,mult2) {
		return func( (time * mult1) - (offset * mult2) );
	}

	this.DoEffect = function(char,time) {
		char.offset.y += 3
						* disturb(Math.sin,time,char.col,0.1,0.5)
						* disturb(Math.cos,time,char.col,0.3,0.2)
						* disturb(Math.sin,time,char.row,2.0,1.0);
		char.offset.x += 3
						* disturb(Math.cos,time,char.row,0.1,1.0)
						* disturb(Math.sin,time,char.col,3.0,0.7)
						* disturb(Math.cos,time,char.col,0.2,0.3);
	}
};
TextEffects["shk"] = new ShakyEffect();

} // Dialog()
</script>

<script>
var xhr;
var canvas;
var context;
var ctx;

var title = "";
var room = {};
var tile = {};
var sprite = {};
var item = {};
var dialog = {};
var palette = {
	"0" : [[0,0,0],[255,0,0],[255,255,255]] //start off with a default palette (can be overriden)
};
var ending = {};
var variable = {}; // these are starting variable values -- they don't update (or I don't think they will)
var playerId = "A";

var names = {
	room : new Map(),
	tile : new Map(), // Note: Not currently enabled in the UI
	sprite : new Map(),
	item : new Map(),
	/*dialog : new Map()*/ // TODO
	/*ending : new Map()*/ // TODO
};
function updateNamesFromCurData() {
	names.room = new Map();
	for(id in room) {
		if(room[id].name != undefined && room[id].name != null)
			names.room.set( room[id].name, id );
	}
	names.tile = new Map();
	for(id in tile) {
		if(tile[id].name != undefined && tile[id].name != null)
			names.tile.set( tile[id].name, id );
	}
	names.sprite = new Map();
	for(id in sprite) {
		if(sprite[id].name != undefined && sprite[id].name != null)
			names.sprite.set( sprite[id].name, id );
	}
	names.item = new Map();
	for(id in item) {
		if(item[id].name != undefined && item[id].name != null)
			names.item.set( item[id].name, id );
	}
}

//stores all image data for tiles, sprites, drawings
var imageStore = {
	source: {},
	render: {}
};

var spriteStartLocations = {};

/* VERSION */
var version = {
	major: 4, // for file format / engine changes
	minor: 8 // for editor changes and bugfixes
};
function getEngineVersion() {
	return version.major + "." + version.minor;
}

/* FLAGS */
var flags;
function resetFlags() {
	flags = {
		ROOM_FORMAT : 0 // 0 = non-comma separated, 1 = comma separated
	};
}
resetFlags(); //init flags on load script

function clearGameData() {
	title = "";
	room = {};
	tile = {};
	sprite = {};
	item = {};
	dialog = {};
	palette = { //start off with a default palette (can be overriden)
		"0" : {
			name : null,
			colors : [[0,0,0],[255,0,0],[255,255,255]]
		}
	};
	ending = {};
	isEnding = false; //todo - correct place for this?
	variable = {};

	//stores all image data for tiles, sprites, drawings
	imageStore = {
		source: {},
		render: {}
	};

	spriteStartLocations = {};

	names = {
		room : new Map(),
		tile : new Map(),
		sprite : new Map(),
		item : new Map()
	};
}

var width = 128;
var height = 128;
var scale = 4; //this is stupid but necessary
var tilesize = 8;
var mapsize = 16;

var curRoom = "0";

var key = {
	left : 37,
	right : 39,
	up : 38,
	down : 40,
	space : 32,
	enter : 13,
	w : 87,
	a : 65,
	s : 83,
	d : 68,
	r : 82
};

var prevTime = 0;
var deltaTime = 0;

//methods used to trigger gif recording
var didPlayerMoveThisFrame = false;
var onPlayerMoved = null;
// var didDialogUpdateThisFrame = false;
var onDialogUpdate = null;

//inventory update UI handles
var onInventoryChanged = null;
var onVariableChanged = null;

var isPlayerEmbeddedInEditor = false;

function getGameNameFromURL() {
	var game = window.location.hash.substring(1);
	// console.log("game name --- " + game);
	return game;
}

function attachCanvas(c) {
	canvas = c;
	canvas.width = width * scale;
	canvas.height = width * scale;
	ctx = canvas.getContext("2d");
	dialogRenderer.AttachContext(ctx);
}

var curGameData = null;
function load_game(game_data, startWithTitle) {
	curGameData = game_data; //remember the current game (used to reset the game)
	dialogBuffer.Reset();
	scriptInterpreter.ResetEnvironment(); // ensures variables are reset -- is this the best way?
	// console.log(dialog);
	parseWorld(game_data);
	// console.log(dialog);
	setInitialVariables();
	renderImages();
	onready(startWithTitle);
	// console.log(dialog);
}

function reset_cur_game() {
	if (curGameData == null) return; //can't reset if we don't have the game data
	stopGame();
	clearGameData();
	load_game(curGameData);
}

var update_interval = null;
function onready(startWithTitle) {
	if(startWithTitle === undefined || startWithTitle === null) startWithTitle = true;

	clearInterval(loading_interval);

	document.addEventListener('keydown', onkeydown);
	document.addEventListener('keyup', onkeyup);

	canvas.addEventListener('touchstart', ontouchstart);
	canvas.addEventListener('touchmove', ontouchmove);
	canvas.addEventListener('touchend', ontouchend);

	update_interval = setInterval(update,-1);

	console.log("TITLE ??? " + startWithTitle);
	if(startWithTitle) // used by editor
		startNarrating(title);
}

function setInitialVariables() {
	for(id in variable) {
		var value = variable[id]; // default to string
		if(value === "true") {
			value = true;
		}
		else if(value === "false") {
			value = false;
		}
		else if(!isNaN(parseFloat(value))) {
			value = parseFloat(value);
		}
		scriptInterpreter.SetVariable(id,value);
	}
	scriptInterpreter.SetOnVariableChangeHandler( onVariableChanged );
}

// OLD VERSION: DEPRECATED
// function onTouch(e) {
// 	console.log("MOUSEDOWN");

// 	//dialog mode
// 	// if (isDialogMode) {
// 	if(dialogBuffer.IsActive()) {

// 		if (dialogBuffer.CanContinue()) {
// 			var hasMoreDialog = dialogBuffer.Continue();
// 			if(!hasMoreDialog) {
// 				onExitDialog();
// 			}
// 		}
// 		else {
// 			dialogBuffer.Skip();
// 		}

// 		return;
// 	}

// 	if (isEnding) {
// 		reset_cur_game();
// 		return;
// 	}

// 	//walking mode
// 	var off = getOffset(e);
// 	var x = Math.floor(off.x / (tilesize*scale));
// 	var y = Math.floor(off.y / (tilesize*scale));
	
// 	//abort if you touch the square you're already on
// 	if (player().x == x && player().y == y) {
// 		return;
// 	}

// 	//did we touch a sprite?
// 	var touchedSprite = null;
// 	for (id in sprite) {
// 		var spr = sprite[id];
// 		if (spr.room === curRoom) {
// 			if (spr.x == x && spr.y == y) {
// 				touchedSprite = id;
// 			}
// 		}
// 	}

// 	//respond to sprite touch
// 	if (touchedSprite) {
// 		var spr = sprite[touchedSprite];
// 		// console.log(Math.abs(player().x - spr.x));
// 		// console.log(Math.abs(player().y - spr.y));
// 		if ( Math.abs(player().x - spr.x) == 0
// 				&& Math.abs(player().y - spr.y) == 1 )
// 		{
// 			//touched a sprite next to you
// 		}
// 		else if ( Math.abs(player().y - spr.y) == 0
// 				&& Math.abs(player().x - spr.x) == 1 )
// 		{
// 			//touched a sprite next to you
// 		}
// 		else
// 		{
// 			return; //oh no! touched a sprite that's out of range
// 		}

// 		startSpriteDialog( touchedSprite /*spriteId*/ );

// 		return;
// 	}

// 	//did we touch an open square?
// 	var row = room[curRoom].tilemap[y];
// 	// console.log(row);
// 	var til = row[x];
// 	// console.log(til);
// 	if ( room[curRoom].walls.indexOf(til) != -1 ) {
// 		//touched a wall
// 		return;
// 	}

// 	//find path to open square, if there is one
// 	var map = collisionMap(curRoom);
// 	var path = breadthFirstSearch( map, {x:player().x, y:player().y}, {x:x,y:y} );
// 	path = path.slice(1); //remove player's start square

// 	//console.log( pathToString(path) );

// 	player().walkingPath = path;
// }

// TODO: this is likely broken
function breadthFirstSearch(map, from, to) {
	from.trail = [];
	var visited = [];
	var queue = [from];
	visited.push( posToString(from) );

	//console.log( "~ bfs ~");
	//console.log( posToString(from) + " to " + posToString(to) );

	while ( queue.length > 0 ) {

		//grab pos from queue and mark as visited
		var curPos = queue.shift();

		//console.log( posToString(curPos) );
		//console.log( ".. " + pathToString(curPos.trail) );
		//console.log( visited );

		if (curPos.x == to.x && curPos.y == to.y) {
			//found a path!
			var path = curPos.trail.splice(0);
			path.push( curPos );
			return path;
		}

		//look at neighbors
		neighbors(curPos).forEach( function(n) {
			var inBounds = (n.x >= 0 && n.x < 16 && n.y >= 0 && n.y < 16);
			if (inBounds) {
				var noCollision = map[n.y][n.x] <= 0;
				var notVisited = visited.indexOf( posToString(n) ) == -1;
				if (noCollision && notVisited) {
					n.trail = curPos.trail.slice();
					n.trail.push(curPos);
					queue.push( n );
					visited.push( posToString(n) );
				}
			}
		});

	}

	return []; // no path found
}

function posToString(pos) {
	return pos.x + "," + pos.y;
}

function pathToString(path) {
	var s = "";
	for (i in path) {
		s += posToString(path[i]) + " ";
	}
	return s;
}

function neighbors(pos) {
	var neighborList = [];
	neighborList.push( {x:pos.x+1, y:pos.y+0} );
	neighborList.push( {x:pos.x-1, y:pos.y+0} );
	neighborList.push( {x:pos.x+0, y:pos.y+1} );
	neighborList.push( {x:pos.x+0, y:pos.y-1} );
	return neighborList;
}

function collisionMap(roomId) {
	var map = [
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
	];

	for (r in room[roomId].tilemap) {
		var row = room[roomId].tilemap[r];
		for (var c = 0; c < row.length; c++) {
			if (room[roomId].walls.indexOf( row[x] ) != -1) {
				map[r][c] = 1;
			}
		}
	}

	for (id in sprite) {
		var spr = sprite[id];
		if (spr.room === roomId) {
			map[spr.y][spr.x] = 2;
		}
	}

	return map;
}

function getOffset(evt) {
	var offset = { x:0, y:0 };

	var el = evt.target;
	var rect = el.getBoundingClientRect();

	offset.x += rect.left + el.scrollLeft;
	offset.y += rect.top + el.scrollTop;

	offset.x = evt.clientX - offset.x;
	offset.y = evt.clientY - offset.y;

	return offset;
}

function stopGame() {
	console.log("stop GAME!");

	document.removeEventListener('keydown', onkeydown);
	document.removeEventListener('keyup', onkeyup);

	canvas.removeEventListener('touchstart', ontouchstart);
	canvas.removeEventListener('touchmove', ontouchmove);
	canvas.removeEventListener('touchend', ontouchend);

	clearInterval(update_interval);
}

/* loading animation */
var loading_anim_data = [
	[
		0,1,1,1,1,1,1,0,
		0,0,1,1,1,1,0,0,
		0,0,1,1,1,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,0,0,1,0,0,
		0,0,1,0,0,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,1,1,1,1,1,1,0,
		0,0,1,0,0,1,0,0,
		0,0,1,1,1,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,0,0,1,0,0,
		0,0,1,1,1,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,1,1,1,1,1,1,0,
		0,0,1,0,0,1,0,0,
		0,0,1,0,0,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,1,1,1,0,0,
		0,0,1,1,1,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,1,1,1,1,1,1,0,
		0,0,1,0,0,1,0,0,
		0,0,1,0,0,1,0,0,
		0,0,0,1,1,0,0,0,
		0,0,0,1,1,0,0,0,
		0,0,1,1,1,1,0,0,
		0,0,1,1,1,1,0,0,
		0,1,1,1,1,1,1,0,
	],
	[
		0,0,0,0,0,0,0,0,
		1,0,0,0,0,0,0,1,
		1,1,1,0,0,1,1,1,
		1,1,1,1,1,0,0,1,
		1,1,1,1,1,0,0,1,
		1,1,1,0,0,1,1,1,
		1,0,0,0,0,0,0,1,
		0,0,0,0,0,0,0,0,
	]
];
var loading_anim_frame = 0;
var loading_anim_speed = 500;
var loading_interval = null;

function loadingAnimation() {
	//create image
	var loadingAnimImg = ctx.createImageData(8*scale, 8*scale);
	//draw image
	for (var y = 0; y < 8; y++) {
		for (var x = 0; x < 8; x++) {
			var i = (y * 8) + x;
			if (loading_anim_data[loading_anim_frame][i] == 1) {
				//scaling nonsense
				for (var sy = 0; sy < scale; sy++) {
					for (var sx = 0; sx < scale; sx++) {
						var pxl = 4 * ( (((y*scale)+sy) * (8*scale)) + ((x*scale)+sx) );
						loadingAnimImg.data[pxl+0] = 255;
						loadingAnimImg.data[pxl+1] = 255;
						loadingAnimImg.data[pxl+2] = 255;
						loadingAnimImg.data[pxl+3] = 255;
					}
				}
			}
		}
	}
	//put image on canvas
	ctx.putImageData(loadingAnimImg,scale*(width/2 - 4),scale*(height/2 - 4));
	//update frame
	loading_anim_frame++;
	if (loading_anim_frame >= 5) loading_anim_frame = 0;
}

function update() {
	var curTime = Date.now();
	deltaTime = curTime - prevTime;

	if (!isNarrating && !isEnding) {
		updateAnimation();
		drawRoom( room[curRoom] ); // draw world if game has begun
	}
	else {
		//make sure to still clear screen
		ctx.fillStyle = "rgb(" + getPal(curPal())[0][0] + "," + getPal(curPal())[0][1] + "," + getPal(curPal())[0][2] + ")";
		ctx.fillRect(0,0,canvas.width,canvas.height);
	}

	// if (isDialogMode) { // dialog mode
	if(dialogBuffer.IsActive()) {
		dialogRenderer.Draw( dialogBuffer, deltaTime );
		dialogBuffer.Update( deltaTime );
	}
	else if (!isEnding) {
		moveSprites();

		if (player().walkingPath.length > 0) {
			var dest = player().walkingPath[ player().walkingPath.length - 1 ];
			ctx.fillStyle = "#fff";
			ctx.globalAlpha = 0.5;
			ctx.fillRect( dest.x * tilesize*scale, dest.y * tilesize*scale, tilesize*scale, tilesize*scale );
			ctx.globalAlpha = 1;
		}
	}

	// keep moving avatar if player holds down button
	if( !dialogBuffer.IsActive() && !isEnding )
	{
		if( curPlayerDirection != Direction.None ) {
			playerHoldToMoveTimer -= deltaTime;

			if( playerHoldToMoveTimer <= 0 )
			{
				movePlayer( curPlayerDirection );
				playerHoldToMoveTimer = 150;
			}
		}
	}

	prevTime = curTime;

	//for gif recording
	if (didPlayerMoveThisFrame && onPlayerMoved != null) onPlayerMoved();
	didPlayerMoveThisFrame = false;
	// if (didDialogUpdateThisFrame && onDialogUpdate != null) onDialogUpdate();
	// didDialogUpdateThisFrame = false;
	/* hacky replacement */
	if (onDialogUpdate != null)
		dialogRenderer.SetPageFinishHandler( onDialogUpdate );
}

var animationCounter = 0;
var animationTime = 400;
function updateAnimation() {
	animationCounter += deltaTime;

	if ( animationCounter >= animationTime ) {

		// animate sprites
		for (id in sprite) {
			var spr = sprite[id];
			if (spr.animation.isAnimated) {
				spr.animation.frameIndex = ( spr.animation.frameIndex + 1 ) % spr.animation.frameCount;
			}
		}

		// animate tiles
		for (id in tile) {
			var til = tile[id];
			if (til.animation.isAnimated) {
				til.animation.frameIndex = ( til.animation.frameIndex + 1 ) % til.animation.frameCount;
			}
		}

		// animate items
		for (id in item) {
			var itm = item[id];
			if (itm.animation.isAnimated) {
				itm.animation.frameIndex = ( itm.animation.frameIndex + 1 ) % itm.animation.frameCount;
			}
		}

		// reset counter
		animationCounter = 0;

	}
}

var moveCounter = 0;
var moveTime = 200;
function moveSprites() {
	moveCounter += deltaTime;

	if (moveCounter >= moveTime) {

		for (id in sprite) {
			var spr = sprite[id];
			if (spr.walkingPath.length > 0) {
				//move sprite
				var nextPos = spr.walkingPath.shift();
				spr.x = nextPos.x;
				spr.y = nextPos.y;


				var end = getEnding( spr.room, spr.x, spr.y );
				var ext = getExit( spr.room, spr.x, spr.y );
				var itmIndex = getItemIndex( spr.room, spr.x, spr.y );
				if (end) { //if the sprite hits an ending
					if (id === playerId) { // only the player can end the game
						startNarrating( ending[end.id], true /*isEnding*/ );
					}
				}
				else if (ext) { //if the sprite hits an exit
					//move it to another scene
					spr.room = ext.dest.room;
					spr.x = ext.dest.x;
					spr.y = ext.dest.y;
					if (id === playerId) {
						//if the player changes scenes, change the visible scene
						curRoom = ext.dest.room;
					}
				}
				else if(itmIndex > -1) {
					var itm = room[ spr.room ].items[ itmIndex ];
					room[ spr.room ].items.splice( itmIndex, 1 );
					if( spr.inventory[ itm.id ] )
						spr.inventory[ itm.id ] += 1;
					else
						spr.inventory[ itm.id ] = 1;

					if(onInventoryChanged != null)
						onInventoryChanged( itm.id );

					if(id === playerId)
						startItemDialog( itm.id  /*itemId*/ );

					// stop moving : is this a good idea?
					spr.walkingPath = [];
				}

				if (id === playerId) didPlayerMoveThisFrame = true;
			}
		}

		moveCounter = 0;
	}

}

function getSpriteAt(x,y) {
	for (id in sprite) {
		var spr = sprite[id];
		if (spr.room === curRoom) {
			if (spr.x == x && spr.y == y) {
				return id;
			}
		}
	}
	return null;
}

var Direction = {
	None : -1,
	Up : 0,
	Down : 1,
	Left : 2,
	Right : 3
};

var curPlayerDirection = Direction.None;
var playerHoldToMoveTimer = 0;

var keyDownList = [];

function onkeydown(e) {
	if(e.keyCode == key.left || e.keyCode == key.right || e.keyCode == key.up || e.keyCode == key.down || !isPlayerEmbeddedInEditor)
		e.preventDefault();

	if( keyDownList.indexOf( e.keyCode ) != -1 ) {
		// key already down --- do nothing
		return;
	}

	curPlayerDirection = Direction.None;

	if( dialogBuffer.IsActive() ) {
		/* CONTINUE DIALOG */
		if (dialogBuffer.CanContinue()) {
			var hasMoreDialog = dialogBuffer.Continue();
			if(!hasMoreDialog) {
				console.log("EXIT DIALOG --- onkeydown")
				onExitDialog();
			}
		}
		else {
			dialogBuffer.Skip();
		}
	}
	else if ( isEnding ) {
		/* RESTART GAME */
		reset_cur_game();
	}
	else {
		/* WALK */
		if ( e.keyCode == key.left || e.keyCode == key.a ) {
			curPlayerDirection = Direction.Left;
		}
		else if ( e.keyCode == key.right || e.keyCode == key.d ) {
			curPlayerDirection = Direction.Right;
		}
		else if ( e.keyCode == key.up || e.keyCode == key.w ) {
			curPlayerDirection = Direction.Up;
		}
		else if ( e.keyCode == key.down || e.keyCode == key.s ) {
			curPlayerDirection = Direction.Down;
		}
		movePlayer( curPlayerDirection );

		if( curPlayerDirection != Direction.None )
		{
			playerHoldToMoveTimer = 500;
		}

		/* RESTART GAME */
		if ( e.keyCode === key.r && ( e.getModifierState("Control") || e.getModifierState("Meta") ) ) {
			if ( confirm("Restart the game?") ) {
				reset_cur_game();
			}
		}
	}

	if( keyDownList.indexOf( e.keyCode ) == -1 )
		keyDownList.push( e.keyCode );

	console.log("KEY DOWN " + keyDownList.length );
	console.log(keyDownList);
}

function movePlayer(direction) {
	var spr = null;

	if ( curPlayerDirection == Direction.Left && !(spr = getSpriteLeft()) && !isWallLeft()) {
		player().x -= 1;
		didPlayerMoveThisFrame = true;
	}
	else if ( curPlayerDirection == Direction.Right && !(spr = getSpriteRight()) && !isWallRight()) {
		player().x += 1;
		didPlayerMoveThisFrame = true;
	}
	else if ( curPlayerDirection == Direction.Up && !(spr = getSpriteUp()) && !isWallUp()) {
		player().y -= 1;
		didPlayerMoveThisFrame = true;
	}
	else if ( curPlayerDirection == Direction.Down && !(spr = getSpriteDown()) && !isWallDown()) {
		player().y += 1;
		didPlayerMoveThisFrame = true;
	}
	
	var ext = getExit( player().room, player().x, player().y );
	var end = getEnding( player().room, player().x, player().y );
	var itmIndex = getItemIndex( player().room, player().x, player().y );

	// do items first, because you can pick up an item AND go through a door
	if (itmIndex > -1) {
		// TODO pick up items (what about touch?)
		// console.log("HIT ITM ");
		// console.log( itmIndex );
		var itm = room[ player().room ].items[ itmIndex ];
		// console.log(itm);
		room[ player().room ].items.splice( itmIndex, 1 );
		if( player().inventory[ itm.id ] )
			player().inventory[ itm.id ] += 1;
		else
			player().inventory[ itm.id ] = 1;

		if(onInventoryChanged != null)
			onInventoryChanged( itm.id );

		startItemDialog( itm.id  /*itemId*/ );

		// console.log( player().inventory );
	}

	if (end) {
		startNarrating( ending[end.id], true /*isEnding*/ );
	}
	else if (ext) {
		player().room = ext.dest.room;
		player().x = ext.dest.x;
		player().y = ext.dest.y;
		curRoom = ext.dest.room;
	}
	else if (spr) {
		startSpriteDialog( spr /*spriteId*/ );
	}
}

function onkeyup(e) {

	if(e.keyCode == key.left || e.keyCode == key.right || e.keyCode == key.up || e.keyCode == key.down || !isPlayerEmbeddedInEditor)
		e.preventDefault();

	if( keyDownList.indexOf( e.keyCode ) != -1 )
		keyDownList.splice( keyDownList.indexOf( e.keyCode ), 1 );

	// todo is this robust enough?
	if( keyDownList.length <= 0 )
		curPlayerDirection = Direction.None;

	console.log(e.keyCode);
	console.log("KEY UP " + keyDownList.length );
	console.log(keyDownList);
	console.log("_____");
}

var touchInfo = {
	isDown : false,
	startX : 0,
	startY : 0,
	curX : 0,
	curY : 0
};

function ontouchstart(e) {
	e.preventDefault();

	if( e.changedTouches.length > 0 ) {
		touchInfo.isDown = true;

		console.log(e);

		touchInfo.startX = touchInfo.curX = e.changedTouches[0].clientX;
		touchInfo.startY = touchInfo.curY = e.changedTouches[0].clientY;

		console.log("MOUSE DOWN");
		console.log(touchInfo);

		curPlayerDirection = Direction.None;
	}
}

var swipeDistance = 30;
function ontouchmove(e) {
	e.preventDefault();

	console.log("MOUSE MOVE");
	console.log(touchInfo);

	if( !dialogBuffer.IsActive() && touchInfo.isDown && e.changedTouches.length > 0 ) {
		touchInfo.curX = e.changedTouches[0].clientX;
		touchInfo.curY = e.changedTouches[0].clientY;

		var prevDirection = curPlayerDirection;

		console.log( touchInfo.curX - touchInfo.startX );

		if( touchInfo.curX - touchInfo.startX <= -swipeDistance ) {
			curPlayerDirection = Direction.Left;
		}
		else if( touchInfo.curX - touchInfo.startX >= swipeDistance ) {
			curPlayerDirection = Direction.Right;
		}
		else if( touchInfo.curY - touchInfo.startY <= -swipeDistance ) {
			curPlayerDirection = Direction.Up;
		}
		else if( touchInfo.curY - touchInfo.startY >= swipeDistance ) {
			curPlayerDirection = Direction.Down;
		}

		if( curPlayerDirection != prevDirection ) {
			movePlayer( curPlayerDirection );
			playerHoldToMoveTimer = 300;
			// reset center
			touchInfo.startX = touchInfo.curX;
			touchInfo.startY = touchInfo.curY;
		}
	}
}

function ontouchend(e) {
	e.preventDefault();

	console.log("MOUSE UP");
	console.log(touchInfo);

	touchInfo.isDown = false;

	if( curPlayerDirection == Direction.None ) {
		// tap!
		if( dialogBuffer.IsActive() ) {
			/* CONTINUE DIALOG */
			if (dialogBuffer.CanContinue()) {
				var hasMoreDialog = dialogBuffer.Continue();
				if(!hasMoreDialog) {
					console.log("EXIT DIALOG --- onkeydown")
					onExitDialog();
				}
			}
			else {
				dialogBuffer.Skip();
			}
		}
		else if ( isEnding ) {
			/* RESTART GAME */
			reset_cur_game();
		}
	}

	curPlayerDirection = Direction.None;
}

function getItemIndex( roomId, x, y ) {
	for( var i = 0; i < room[roomId].items.length; i++ ) {
		var itm = room[roomId].items[i];
		if ( itm.x == x && itm.y == y)
			return i;
	}
	return -1;
}

function getSpriteLeft() { //repetitive?
	return getSpriteAt( player().x - 1, player().y );
}

function getSpriteRight() {
	return getSpriteAt( player().x + 1, player().y );
}

function getSpriteUp() {
	return getSpriteAt( player().x, player().y - 1 );
}

function getSpriteDown() {
	return getSpriteAt( player().x, player().y + 1 );
}

function isWallLeft() {
	return (player().x - 1 < 0) || isWall( player().x - 1, player().y );
}

function isWallRight() {
	return (player().x + 1 >= 16) || isWall( player().x + 1, player().y );
}

function isWallUp() {
	return (player().y - 1 < 0) || isWall( player().x, player().y - 1 );
}

function isWallDown() {
	return (player().y + 1 >= 16) || isWall( player().x, player().y + 1 );
}

function isWall(x,y,roomId) {
	if(roomId == undefined || roomId == null)
		roomId = curRoom;

	var tileId = getTile( x, y );

	if( tileId === '0' )
		return false; // Blank spaces aren't walls, ya doofus

	if( tile[tileId].isWall === undefined || tile[tileId].isWall === null ) {
		// No wall-state defined: check room-specific walls
		var i = room[roomId].walls.indexOf( getTile(x,y) );
		return i > -1;
	}

	// Otherwise, use the tile's own wall-state
	return tile[tileId].isWall;
}

function getItem(roomId,x,y) {
	for (i in room[roomId].items) {
		var item = room[roomId].items[i];
		if (x == item.x && y == item.y) {
			return item;
		}
	}
	return null;
}

function getExit(roomId,x,y) {
	for (i in room[roomId].exits) {
		var e = room[roomId].exits[i];
		if (x == e.x && y == e.y) {
			return e;
		}
	}
	return null;
}

function getEnding(roomId,x,y) {
	for (i in room[roomId].endings) {
		var e = room[roomId].endings[i];
		if (x == e.x && y == e.y) {
			return e;
		}
	}
	return null;
}

function getTile(x,y) {
	// console.log(x + " " + y);
	var t = getRoom().tilemap[y][x];
	return t;
}

function player() {
	return sprite[playerId];
}

// Sort of a hack for legacy palette code (when it was just an array)
function getPal(id) {
	return palette[ id ].colors;
}

function getRoom() {
	return room[curRoom];
}

function isSpriteOffstage(id) {
	return sprite[id].room == null;
}

function parseWorld(file) {
	resetFlags();

	var lines = file.split("\n");
	var i = 0;
	while (i < lines.length) {
		var curLine = lines[i];

		// console.log(lines[i]);

		if (i == 0) {
			i = parseTitle(lines, i);
		}
		else if (curLine.length <= 0 || curLine.charAt(0) === "#") {
			//skip blank lines & comments
			i++;
		}
		else if (getType(curLine) == "PAL") {
			i = parsePalette(lines, i);
		}
		else if (getType(curLine) === "ROOM" || getType(curLine) === "SET") { //SET for back compat
			i = parseRoom(lines, i);
		}
		else if (getType(curLine) === "TIL") {
			i = parseTile(lines, i);
		}
		else if (getType(curLine) === "SPR") {
			i = parseSprite(lines, i);
		}
		else if (getType(curLine) === "ITM") {
			i = parseItem(lines, i);
		}
		else if (getType(curLine) === "DRW") {
			i = parseDrawing(lines, i);
		}
		else if (getType(curLine) === "DLG") {
			i = parseDialog(lines, i);
		}
		else if (getType(curLine) === "END") {
			i = parseEnding(lines, i);
		}
		else if (getType(curLine) === "VAR") {
			i = parseVariable(lines, i);
		}
		else if (getType(curLine) === "!") {
			i = parseFlag(lines, i);
		}
		else {
			i++;
		}
	}
	placeSprites();
	if (player().room != null) {
		curRoom = player().room;
	}

	// console.log(names);
}

//TODO this is in progress and doesn't support all features
function serializeWorld() {
	var worldStr = "";
	/* TITLE */
	worldStr += title + "\n";
	worldStr += "\n";
	/* VERSION */
	worldStr += "# BITSY VERSION " + getEngineVersion() + "\n"; // add version as a comment for debugging purposes
	worldStr += "\n";
	/* FLAGS */
	for (f in flags) {
		worldStr += "! " + f + " " + flags[f] + "\n";
	}
	worldStr += "\n"
	/* PALETTE */
	for (id in palette) {
		worldStr += "PAL " + id + "\n";
		if( palette[id].name != null )
			worldStr += "NAME " + palette[id].name + "\n";
		for (i in getPal(id)) {
			for (j in getPal(id)[i]) {
				worldStr += getPal(id)[i][j];
				if (j < 2) worldStr += ",";
			}
			worldStr += "\n";
		}
		worldStr += "\n";
	}
	/* ROOM */
	for (id in room) {
		worldStr += "ROOM " + id + "\n";
		if ( flags.ROOM_FORMAT == 0 ) {
			// old non-comma separated format
			for (i in room[id].tilemap) {
				for (j in room[id].tilemap[i]) {
					worldStr += room[id].tilemap[i][j];	
				}
				worldStr += "\n";
			}
		}
		else if ( flags.ROOM_FORMAT == 1 ) {
			// new comma separated format
			for (i in room[id].tilemap) {
				for (j in room[id].tilemap[i]) {
					worldStr += room[id].tilemap[i][j];
					if (j < room[id].tilemap[i].length-1) worldStr += ","
				}
				worldStr += "\n";
			}
		}
		if (room[id].name != null) {
			/* NAME */
			worldStr += "NAME " + room[id].name + "\n";
		}
		if (room[id].walls.length > 0) {
			/* WALLS */
			worldStr += "WAL ";
			for (j in room[id].walls) {
				worldStr += room[id].walls[j];
				if (j < room[id].walls.length-1) {
					worldStr += ",";
				}
			}
			worldStr += "\n";
		}
		if (room[id].items.length > 0) {
			/* ITEMS */
			for (j in room[id].items) {
				var itm = room[id].items[j];
				worldStr += "ITM " + itm.id + " " + itm.x + "," + itm.y;
				worldStr += "\n";
			}
		}
		if (room[id].exits.length > 0) {
			/* EXITS */
			for (j in room[id].exits) {
				var e = room[id].exits[j];
				if ( isExitValid(e) ) {
					worldStr += "EXT " + e.x + "," + e.y + " " + e.dest.room + " " + e.dest.x + "," + e.dest.y;
					worldStr += "\n";
				}
			}
		}
		if (room[id].endings.length > 0) {
			/* ENDINGS */
			for (j in room[id].endings) {
				var e = room[id].endings[j];
				// todo isEndingValid
				worldStr += "END " + e.id + " " + e.x + "," + e.y;
				worldStr += "\n";
			}
		}
		if (room[id].pal != null) {
			/* PALETTE */
			worldStr += "PAL " + room[id].pal + "\n";
		}
		worldStr += "\n";
	}
	/* TILES */
	for (id in tile) {
		worldStr += "TIL " + id + "\n";
		worldStr += serializeDrawing( "TIL_" + id );
		if (tile[id].name != null && tile[id].name != undefined) {
			/* NAME */
			worldStr += "NAME " + tile[id].name + "\n";
		}
		if (tile[id].isWall != null && tile[id].isWall != undefined) {
			/* WALL */
			worldStr += "WAL " + tile[id].isWall + "\n";
		}
		if (tile[id].col != null && tile[id].col != undefined && tile[id].col != 1) {
			/* COLOR OVERRIDE */
			worldStr += "COL " + tile[id].col + "\n";
		}
		worldStr += "\n";
	}
	/* SPRITES */
	for (id in sprite) {
		worldStr += "SPR " + id + "\n";
		worldStr += serializeDrawing( "SPR_" + id );
		if (sprite[id].name != null && sprite[id].name != undefined) {
			/* NAME */
			worldStr += "NAME " + sprite[id].name + "\n";
		}
		if (sprite[id].dlg != null) {
			worldStr += "DLG " + sprite[id].dlg + "\n";
		}
		if (sprite[id].room != null) {
			/* SPRITE POSITION */
			worldStr += "POS " + sprite[id].room + " " + sprite[id].x + "," + sprite[id].y + "\n";
		}
		if (sprite[id].inventory != null) {
			for(itemId in sprite[id].inventory) {
				worldStr += "ITM " + itemId + " " + sprite[id].inventory[itemId] + "\n";
			}
		}
		if (sprite[id].col != null && sprite[id].col != undefined && sprite[id].col != 2) {
			/* COLOR OVERRIDE */
			worldStr += "COL " + sprite[id].col + "\n";
		}
		worldStr += "\n";
	}
	/* ITEMS */
	for (id in item) {
		worldStr += "ITM " + id + "\n";
		worldStr += serializeDrawing( "ITM_" + id );
		if (item[id].name != null && item[id].name != undefined) {
			/* NAME */
			worldStr += "NAME " + item[id].name + "\n";
		}
		if (item[id].dlg != null) {
			worldStr += "DLG " + item[id].dlg + "\n";
		}
		if (item[id].col != null && item[id].col != undefined && item[id].col != 2) {
			/* COLOR OVERRIDE */
			worldStr += "COL " + item[id].col + "\n";
		}
		worldStr += "\n";
	}
	/* DIALOG */
	for (id in dialog) {
		worldStr += "DLG " + id + "\n";
		worldStr += dialog[id] + "\n";
		worldStr += "\n";
	}
	/* ENDINGS */
	for (id in ending) {
		worldStr += "END " + id + "\n";
		worldStr += ending[id] + "\n";
		worldStr += "\n";
	}
	/* VARIABLES */
	for (id in variable) {
		worldStr += "VAR " + id + "\n";
		worldStr += variable[id] + "\n";
		worldStr += "\n";
	}
	return worldStr;
}

function serializeDrawing(drwId) {
	var drwStr = "";
	for (f in imageStore.source[drwId]) {
		for (y in imageStore.source[drwId][f]) {
			var rowStr = "";
			for (x in imageStore.source[drwId][f][y]) {
				rowStr += imageStore.source[drwId][f][y][x];
			}
			drwStr += rowStr + "\n";
		}
		if (f < (imageStore.source[drwId].length-1)) drwStr += ">\n";
	}
	return drwStr;
}

function isExitValid(e) {
	var hasValidStartPos = e.x >= 0 && e.x < 16 && e.y >= 0 && e.y < 16;
	var hasDest = e.dest != null;
	var hasValidRoomDest = (e.dest.room != null && e.dest.x >= 0 && e.dest.x < 16 && e.dest.y >= 0 && e.dest.y < 16);
	return hasValidStartPos && hasDest && hasValidRoomDest;
}

function placeSprites() {
	for (id in spriteStartLocations) {
		//console.log(id);
		//console.log( spriteStartLocations[id] );
		//console.log(sprite[id]);
		sprite[id].room = spriteStartLocations[id].room;
		sprite[id].x = spriteStartLocations[id].x;
		sprite[id].y = spriteStartLocations[id].y;
		//console.log(sprite[id]);
	}
}

/* ARGUMENT GETTERS */
function getType(line) {
	return getArg(line,0);
}

function getId(line) {
	return getArg(line,1);
}

function getArg(line,arg) {
	return line.split(" ")[arg];
}

function getCoord(line,arg) {
	return getArg(line,arg).split(",");
}

function parseTitle(lines, i) {
	title = lines[i];
	i++;
	return i;
}

function parseRoom(lines, i) {
	var id = getId(lines[i]);
	room[id] = {
		id : id,
		tilemap : [],
		walls : [],
		exits : [],
		endings : [],
		items : [],
		pal : null,
		name : null
	};
	i++;

	// create tile map
	if ( flags.ROOM_FORMAT == 0 ) {
		// old way: no commas, single char tile ids
		var end = i + mapsize;
		var y = 0;
		for (; i<end; i++) {
			room[id].tilemap.push( [] );
			for (x = 0; x<mapsize; x++) {
				room[id].tilemap[y].push( lines[i].charAt(x) );
			}
			y++;
		}
	}
	else if ( flags.ROOM_FORMAT == 1 ) {
		// new way: comma separated, multiple char tile ids
		var end = i + mapsize;
		var y = 0;
		for (; i<end; i++) {
			room[id].tilemap.push( [] );
			var lineSep = lines[i].split(",");
			for (x = 0; x<mapsize; x++) {
				room[id].tilemap[y].push( lineSep[x] );
			}
			y++;
		}
	}

	while (i < lines.length && lines[i].length > 0) { //look for empty line
		// console.log(getType(lines[i]));
		if (getType(lines[i]) === "SPR") {
			/* NOTE SPRITE START LOCATIONS */
			var sprId = getId(lines[i]);
			if (sprId.indexOf(",") == -1 && lines[i].split(" ").length >= 3) { //second conditional checks for coords
				/* PLACE A SINGLE SPRITE */
				var sprCoord = lines[i].split(" ")[2].split(",");
				spriteStartLocations[sprId] = {
					room : id,
					x : parseInt(sprCoord[0]),
					y : parseInt(sprCoord[1])
				};
			}
			else if ( flags.ROOM_FORMAT == 0 ) { // TODO: right now this shortcut only works w/ the old comma separate format
				/* PLACE MULTIPLE SPRITES*/ 
				//Does find and replace in the tilemap (may be hacky, but its convenient)
				var sprList = sprId.split(",");
				for (row in room[id].tilemap) {
					for (s in sprList) {
						var col = room[id].tilemap[row].indexOf( sprList[s] );
						//if the sprite is in this row, replace it with the "null tile" and set its starting position
						if (col != -1) {
							room[id].tilemap[row][col] = "0";
							spriteStartLocations[ sprList[s] ] = {
								room : id,
								x : parseInt(col),
								y : parseInt(row)
							};
						}
					}
				}
			}
		}
		else if (getType(lines[i]) === "ITM") {
			var itmId = getId(lines[i]);
			var itmCoord = lines[i].split(" ")[2].split(",");
			var itm = {
				id: itmId,
				x : parseInt(itmCoord[0]),
				y : parseInt(itmCoord[1])
			};
			room[id].items.push( itm );
		}
		else if (getType(lines[i]) === "WAL") {
			/* DEFINE COLLISIONS (WALLS) */
			room[id].walls = getId(lines[i]).split(",");
		}
		else if (getType(lines[i]) === "EXT") {
			/* ADD EXIT */
			var exitArgs = lines[i].split(" ");
			//arg format: EXT 10,5 M 3,2 [AVA:7 LCK:a,9] [AVA 7 LCK a 9]
			var exitCoords = exitArgs[1].split(",");
			var destName = exitArgs[2];
			var destCoords = exitArgs[3].split(",");
			var ext = {
				x : parseInt(exitCoords[0]),
				y : parseInt(exitCoords[1]),
				dest : {
					room : destName,
					x : parseInt(destCoords[0]),
					y : parseInt(destCoords[1])
				}
			};
			room[id].exits.push(ext);
		}
		else if (getType(lines[i]) === "END") {
			/* ADD ENDING */
			var endId = getId( lines[i] );
			var endCoords = getCoord( lines[i], 2 );
			var end = {
				id : endId,
				x : parseInt( endCoords[0] ),
				y : parseInt( endCoords[1] )
			};
			room[id].endings.push(end);
		}
		else if (getType(lines[i]) === "PAL") {
			/* CHOOSE PALETTE (that's not default) */
			room[id].pal = getId(lines[i]);
		}
		else if (getType(lines[i]) === "NAME") {
			var name = lines[i].split(/\s(.+)/)[1];
			room[id].name = name;
			names.room.set( name, id);
		}
		i++;
	}
	return i;
}

function parsePalette(lines,i) { //todo this has to go first right now :(
	var id = getId(lines[i]);
	i++;
	var colors = [];
	var name = null;
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		var args = lines[i].split(" ");
		if(args[0] === "NAME") {
			name = lines[i].split(/\s(.+)/)[1];
		}
		else {
			var col = [];
			lines[i].split(",").forEach(function(i) {
				col.push(parseInt(i));
			});
			colors.push(col);
		}
		i++;
	}
	palette[id] = {
		name : name,
		colors : colors
	};
	return i;
}

function parseTile(lines, i) {
	var id = getId(lines[i]);
	var drwId = null;
	var name = null;

	i++;

	if (getType(lines[i]) === "DRW") { //load existing drawing
		drwId = getId(lines[i]);
		i++;
	}
	else {
		// store tile source
		drwId = "TIL_" + id;
		i = parseDrawingCore( lines, i, drwId );
	}

	//other properties
	var colorIndex = 1; // default palette color index is 1
	var isWall = null; // null indicates it can vary from room to room (original version)
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		if (getType(lines[i]) === "COL") {
			colorIndex = parseInt( getId(lines[i]) );
		}
		else if (getType(lines[i]) === "NAME") {
			/* NAME */
			name = lines[i].split(/\s(.+)/)[1];
			names.tile.set( name, id );
		}
		else if (getType(lines[i]) === "WAL") {
			var wallArg = getArg( lines[i], 1 );
			if( wallArg === "true" ) {
				isWall = true;
			}
			else if( wallArg === "false" ) {
				isWall = false;
			}
		}
		i++;
	}

	//tile data
	tile[id] = {
		drw : drwId, //drawing id
		col : colorIndex,
		animation : {
			isAnimated : (imageStore.source[drwId].length > 1),
			frameIndex : 0,
			frameCount : imageStore.source[drwId].length
		},
		name : name,
		isWall : isWall
	};

	return i;
}

function parseSprite(lines, i) {
	var id = getId(lines[i]);
	var drwId = null;
	var name = null;

	i++;

	if (getType(lines[i]) === "DRW") { //load existing drawing
		drwId = getId(lines[i]);
		i++;
	}
	else {
		// store sprite source
		drwId = "SPR_" + id;
		i = parseDrawingCore( lines, i, drwId );
	}

	//other properties
	var colorIndex = 2; //default palette color index is 2
	var dialogId = null;
	var startingInventory = {};
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		if (getType(lines[i]) === "COL") {
			/* COLOR OFFSET INDEX */
			colorIndex = parseInt( getId(lines[i]) );
		}
		else if (getType(lines[i]) === "POS") {
			/* STARTING POSITION */
			var posArgs = lines[i].split(" ");
			var roomId = posArgs[1];
			var coordArgs = posArgs[2].split(",");
			spriteStartLocations[id] = {
				room : roomId,
				x : parseInt(coordArgs[0]),
				y : parseInt(coordArgs[1])
			};
		}
		else if(getType(lines[i]) === "DLG") {
			dialogId = getId(lines[i]);
		}
		else if (getType(lines[i]) === "NAME") {
			/* NAME */
			name = lines[i].split(/\s(.+)/)[1];
			names.sprite.set( name, id );
		}
		else if (getType(lines[i]) === "ITM") {
			/* ITEM STARTING INVENTORY */
			var itemId = getId(lines[i]);
			var itemCount = parseFloat( getArg(lines[i], 2) );
			startingInventory[itemId] = itemCount;
		}
		i++;
	}

	//sprite data
	sprite[id] = {
		drw : drwId, //drawing id
		col : colorIndex,
		dlg : dialogId,
		room : null, //default location is "offstage"
		x : -1,
		y : -1,
		walkingPath : [], //tile by tile movement path (isn't saved)
		animation : {
			isAnimated : (imageStore.source[drwId].length > 1),
			frameIndex : 0,
			frameCount : imageStore.source[drwId].length
		},
		inventory : startingInventory,
		name : name
	};
	return i;
}

function parseItem(lines, i) {
	var id = getId(lines[i]);
	var drwId = null;
	var name = null;

	i++;

	if (getType(lines[i]) === "DRW") { //load existing drawing
		drwId = getId(lines[i]);
		i++;
	}
	else {
		// store item source
		drwId = "ITM_" + id; // these prefixes are maybe a terrible way to differentiate drawing tyepes :/
		i = parseDrawingCore( lines, i, drwId );
	}

	//other properties
	var colorIndex = 2; //default palette color index is 2
	var dialogId = null;
	while (i < lines.length && lines[i].length > 0) { //look for empty line
		if (getType(lines[i]) === "COL") {
			/* COLOR OFFSET INDEX */
			colorIndex = parseInt( getArg( lines[i], 1 ) );
		}
		// else if (getType(lines[i]) === "POS") {
		// 	/* STARTING POSITION */
		// 	var posArgs = lines[i].split(" ");
		// 	var roomId = posArgs[1];
		// 	var coordArgs = posArgs[2].split(",");
		// 	spriteStartLocations[id] = {
		// 		room : roomId,
		// 		x : parseInt(coordArgs[0]),
		// 		y : parseInt(coordArgs[1])
		// 	};
		// }
		else if(getType(lines[i]) === "DLG") {
			dialogId = getId(lines[i]);
		}
		else if (getType(lines[i]) === "NAME") {
			/* NAME */
			name = lines[i].split(/\s(.+)/)[1];
			names.item.set( name, id );
		}
		i++;
	}

	//item data
	item[id] = {
		drw : drwId, //drawing id
		col : colorIndex,
		dlg : dialogId,
		// room : null, //default location is "offstage"
		// x : -1,
		// y : -1,
		animation : {
			isAnimated : (imageStore.source[drwId].length > 1),
			frameIndex : 0,
			frameCount : imageStore.source[drwId].length
		},
		name : name
	};

	// console.log("ITM " + id);
	// console.log(item[id]);

	return i;
}

function parseDrawing(lines, i) {
	// store drawing source
	var drwId = getId( lines[i] );
	return parseDrawingCore( lines, i, drwId );
}

function parseDrawingCore(lines, i, drwId) {
	imageStore.source[drwId] = []; //init list of frames
	imageStore.source[drwId].push( [] ); //init first frame
	var frameIndex = 0;
	var y = 0;
	while ( y < tilesize ) {
		var l = lines[i+y];
		var row = [];
		for (x = 0; x < tilesize; x++) {
			row.push( parseInt( l.charAt(x) ) );
		}
		imageStore.source[drwId][frameIndex].push( row );
		y++;

		if (y === tilesize) {
			i = i + y;
			if ( lines[i] != undefined && lines[i].charAt(0) === ">" ) {
				// start next frame!
				imageStore.source[drwId].push( [] );
				frameIndex++;
				//start the count over again for the next frame
				i++;
				y = 0;
			}
		}
	}

	//console.log(imageStore.source[drwId]);
	return i;
}

function renderImages() {
	// console.log(" -- RENDER IMAGES -- ");

	//init image store
	for (pal in palette) {
		imageStore.render[pal] = {
			"1" : {}, //images with primary color index 1 (usually tiles)
			"2" : {}  //images with primary color index 2 (usually sprites)
		};
	}

	//render images required by sprites
	for (s in sprite) {
		var spr = sprite[s];
		renderImageForAllPalettes( spr );
	}
	//render images required by tiles
	for (t in tile) {
		var til = tile[t];
		renderImageForAllPalettes( til );
	}
	//render images required by tiles
	for (i in item) {
		var itm = item[i];
		renderImageForAllPalettes( itm );
	}
}

function renderImageForAllPalettes(drawing) {
	// console.log("RENDER IMAGE");
	for (pal in palette) {
		// console.log(pal);

		var col = drawing.col;
		var colStr = "" + col;

		// slightly hacky initialization of image store for palettes with more than 3 colors ~~~ SECRET FEATURE DO NOT USE :P ~~~
		if(imageStore.render[pal][colStr] === undefined || imageStore.render[pal][colStr] === null) {
			// console.log("UNDEFINED " + colStr);
			imageStore.render[pal][colStr] = {};
		}

		// console.log(drawing);
		// console.log(drawing.drw);
		// console.log(imageStore);

		var imgSrc = imageStore.source[ drawing.drw ];

		if ( imgSrc.length <= 1 ) {
			// non-animated drawing
			var frameSrc = imgSrc[0];
			// console.log(drawing);
			// console.log(imageStore);
			imageStore.render[pal][colStr][drawing.drw] = imageDataFromImageSource( frameSrc, pal, col );
		}
		else {
			// animated drawing
			var frameCount = 0;
			for (f in imgSrc) {
				var frameSrc = imgSrc[f];
				var frameId = drawing.drw + "_" + frameCount;
				imageStore.render[pal][colStr][frameId] = imageDataFromImageSource( frameSrc, pal, col );
				frameCount++;
			}
		}
	}
}

function imageDataFromImageSource(imageSource, pal, col) {
	//console.log(imageSource);

	var img = ctx.createImageData(tilesize*scale,tilesize*scale);
	for (var y = 0; y < tilesize; y++) {
		for (var x = 0; x < tilesize; x++) {
			var px = imageSource[y][x];
			for (var sy = 0; sy < scale; sy++) {
				for (var sx = 0; sx < scale; sx++) {
					var pxl = (((y * scale) + sy) * tilesize * scale * 4) + (((x*scale) + sx) * 4);
					if ( px === 1 && getPal(pal).length > col ) {
						img.data[pxl + 0] = getPal(pal)[col][0]; //ugly
						img.data[pxl + 1] = getPal(pal)[col][1];
						img.data[pxl + 2] = getPal(pal)[col][2];
						img.data[pxl + 3] = 255;
					}
					else { //ch === 0
						img.data[pxl + 0] = getPal(pal)[0][0];
						img.data[pxl + 1] = getPal(pal)[0][1];
						img.data[pxl + 2] = getPal(pal)[0][2];
						img.data[pxl + 3] = 255;
					}
				}
			}
		}
	}
	return img;
}

function parseDialog(lines, i) {
	var id = getId(lines[i]);
	i++;

	// TODO : use this for titles & endings too
	var results = scriptInterpreter.ReadDialogScript(lines,i);
	dialog[id] = results.script;
	i = results.index;

	return i;
}

function parseEnding(lines, i) {
	var id = getId(lines[i]);
	i++;
	var text = lines[i];
	i++;
	ending[id] = text;
	return i;
}

function parseVariable(lines, i) {
	var id = getId(lines[i]);
	i++;
	var value = lines[i];
	i++;
	variable[id] = value;
	return i;
}

function parseFlag(lines, i) {
	var id = getId(lines[i]);
	var valStr = lines[i].split(" ")[2];
	flags[id] = parseInt( valStr );
	i++;
	return i;
}

function drawTile(img,x,y,context) {
	if (!context) { //optional pass in context; otherwise, use default
		context = ctx;
	}
	context.putImageData(img,x*tilesize*scale,y*tilesize*scale);
}

function drawSprite(img,x,y,context) { //this may differ later (or not haha)
	drawTile(img,x,y,context);
}

function drawItem(img,x,y,context) {
	drawTile(img,x,y,context); //TODO these methods are dumb and repetitive
}

function drawRoom(room,context,frameIndex) { // context & frameIndex are optional
	if (!context) { //optional pass in context; otherwise, use default (ok this is REAL hacky isn't it)
		context = ctx;
	}

	//clear screen
	context.fillStyle = "rgb(" + getPal(curPal())[0][0] + "," + getPal(curPal())[0][1] + "," + getPal(curPal())[0][2] + ")";
	context.fillRect(0,0,canvas.width,canvas.height);

	//draw tiles
	for (i in room.tilemap) {
		for (j in room.tilemap[i]) {
			var id = room.tilemap[i][j];
			if (id != "0") {
				//console.log(id);
				if (tile[id] == null) { // hack-around to avoid corrupting files (not a solution though!)
					id = "0";
					room.tilemap[i][j] = id;
				}
				else {
					// console.log(id);
					drawTile( getTileImage(tile[id],getRoomPal(room.id),frameIndex), j, i, context );
				}
			}
		}
	}

	//draw items
	for (var i = 0; i < room.items.length; i++) {
		var itm = room.items[i];
		drawItem( getItemImage(item[itm.id],getRoomPal(room.id),frameIndex), itm.x, itm.y, context );
	}

	//draw sprites
	for (id in sprite) {
		var spr = sprite[id];
		if (spr.room === room.id) {
			drawSprite( getSpriteImage(spr,getRoomPal(room.id),frameIndex), spr.x, spr.y, context );
		}
	}
}

function getTileImage(t,palId,frameIndex) {
	if( frameIndex === undefined ) frameIndex = null; // no default parameter support on iOS

	var drwId = t.drw;

	if (!palId) palId = curPal(); // TODO : will this break on iOS?

	if ( t.animation.isAnimated ) {
		if (frameIndex != null) { // use optional provided frame index
			// console.log("GET TILE " + frameIndex);
			drwId += "_" + frameIndex;
		}
		else { // or the one bundled with the tile
			drwId += "_" + t.animation.frameIndex;
		}
	}
	return imageStore.render[ palId ][ t.col ][ drwId ];
}

function getSpriteImage(s,palId,frameIndex) {
	if( frameIndex === undefined ) frameIndex = null; // no default parameter support on iOS

	var drwId = s.drw;

	if (!palId) palId = curPal();

	if ( s.animation.isAnimated ) {
		if (frameIndex != null) {
			drwId += "_" + frameIndex;
		}
		else {
			drwId += "_" + s.animation.frameIndex;
		}
	}

	return imageStore.render[ palId ][ s.col ][ drwId ];
}

function getItemImage(itm,palId,frameIndex) { //aren't these all the same????
	if( frameIndex === undefined ) frameIndex = null; // no default parameter support on iOS

	var drwId = itm.drw;
	// console.log(drwId);

	if (!palId) palId = curPal();

	if ( itm.animation.isAnimated ) {
		if (frameIndex != null) {
			drwId += "_" + frameIndex;
		}
		else {
			drwId += "_" + itm.animation.frameIndex;
		}
	}

	// console.log(imageStore.render[ palId ][ itm.col ]);
	// console.log(imageStore.render[ palId ][ itm.col ][ drwId ]);
	return imageStore.render[ palId ][ itm.col ][ drwId ];
}

function curPal() {
	return getRoomPal(curRoom);
}

function getRoomPal(roomId) {
	if (room[roomId].pal != null) {
		//a specific palette was chosen
		return room[roomId].pal;
	}
	else {
		if (roomId in palette) {
			//there is a palette matching the name of the room
			return roomId;
		}
		else {
			//use the default palette
			return "0";
		}
	}
	return "0";	
}

var isDialogMode = false;
var isNarrating = false;
var isEnding = false;
var dialogModule = new Dialog();
var dialogRenderer = dialogModule.CreateRenderer();
var dialogBuffer = dialogModule.CreateBuffer();

function onExitDialog() {
	// var breakShit = null;
	// breakShit();
	console.log("EXIT DIALOG");
	isDialogMode = false;
	if (isNarrating) isNarrating = false;
	if (isDialogPreview) {
		isDialogPreview = false;
		if (onDialogPreviewEnd != null)
			onDialogPreviewEnd();
	}
}

/*
TODO
- titles and endings should also take advantage of the script pre-compilation if possible??
- could there be a namespace collision?
- what about dialog NAMEs vs IDs?
- what about a special script block separate from DLG?
*/
function startNarrating(dialogStr,end) {
	console.log("NARRATE " + dialogStr);

	if(end === undefined) end = false;

	isNarrating = true;
	isEnding = end;
	startDialog(dialogStr);
}

function startItemDialog(itemId) {
	var dialogId = item[itemId].dlg;
	// console.log("START ITEM DIALOG " + dialogId);
	if(dialog[dialogId]){
		var dialogStr = dialog[dialogId];
		startDialog(dialogStr,dialogId);
	}
}

function startSpriteDialog(spriteId) {
	var spr = sprite[spriteId];
	var dialogId = spr.dlg ? spr.dlg : spriteId;
	// console.log("START SPRITE DIALOG " + dialogId);
	if(dialog[dialogId]){
		var dialogStr = dialog[dialogId];
		startDialog(dialogStr,dialogId);
	}
}

function startDialog(dialogStr,scriptId) {
	if(dialogStr.length <= 0) {
		console.log("ON EXIT DIALOG -- startDialog 1");
		onExitDialog();
		return;
	}

	isDialogMode = true;

	dialogRenderer.Reset();
	dialogRenderer.SetCentered( isNarrating /*centered*/ );
	dialogBuffer.Reset();
	scriptInterpreter.SetDialogBuffer( dialogBuffer );

	var onScriptEnd = function() {
		if(!dialogBuffer.IsActive()){
			console.log("ON EXIT DIALOG -- startDialog 2");
			onExitDialog();
		}
	};

	if(scriptId === undefined) {
		scriptInterpreter.Interpret( dialogStr, onScriptEnd );		
	}
	else {
		if( !scriptInterpreter.HasScript(scriptId) )
			scriptInterpreter.Compile( scriptId, dialogStr );
		scriptInterpreter.Run( scriptId, onScriptEnd );
	}

}

var isDialogPreview = false;
function startPreviewDialog(script, onScriptEnd) {
	isNarrating = true;

	isDialogMode = true;

	isDialogPreview = true;

	dialogRenderer.Reset();
	dialogRenderer.SetCentered( true );
	dialogBuffer.Reset();
	scriptInterpreter.SetDialogBuffer( dialogBuffer );

	onDialogPreviewEnd = onScriptEnd;

	scriptInterpreter.Eval( script, null );
}

/* NEW SCRIPT STUFF */
var scriptModule = new Script();
var scriptInterpreter = scriptModule.CreateInterpreter();
var scriptUtils = scriptModule.CreateUtils(); // TODO: move to editor.js?
// scriptInterpreter.SetDialogBuffer( dialogBuffer );
</script>

<!-- BITSY HACKS TEST-->
<script type="text/javascript" id="borksyHacks">
//borksy use dist versions of hacks from the bitsy hacks repo now

/**

@file exit-from-dialog
@summary exit to another room from dialog, including conditionals
@license WTFPL (do WTF you want)
@version 5.0.1
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
Lets you exit to another room from dialog (including inside conditionals). Use
it to make an invisible sprite that acts as a conditional exit, use it to warp
somewhere after a conversation, use it to put a guard at your gate who only
lets you in once you're disguised, use it to require payment before the
ferryman will take you across the river.

Using the (exit) function in any part of a series of dialog will make the
game exit to the new room after the dialog is finished. Using (exitNow) will
immediately warp to the new room, but the current dialog will continue.

WARNING: In exit coordinates, the TOP LEFT tile is (0,0). In sprite coordinates,
         the BOTTOM LEFT tile is (0,0). If you'd like to use sprite coordinates,
         add the word "sprite" as the fourth parameter to the exit function.

Usage: (exit "<room name>,<x>,<y>")
       (exit "<room name>,<x>,<y>,sprite")
       (exitNow "<room name>,<x>,<y>")
       (exitNow "<room name>,<x>,<y>,sprite")

Example: (exit "FinalRoom,8,4")
         (exitNow "FinalRoom,8,11,sprite")

HOW TO USE:
  1. Copy-paste this script into a new script tag after the Bitsy source code.
     It should appear *before* any other mods that handle loading your game
     data so it executes *after* them (last-in first-out).

NOTE: This uses parentheses "()" instead of curly braces "{}" around function
      calls because the Bitsy editor's fancy dialog window strips unrecognized
      curly-brace functions from dialog text. To keep from losing data, write
      these function calls with parentheses like the examples above.

      For full editor integration, you'd *probably* also need to paste this
      code at the end of the editor's `bitsy.js` file. Untested.
*/
(function (bitsy) {
'use strict';

bitsy = bitsy && bitsy.hasOwnProperty('default') ? bitsy['default'] : bitsy;

/**
@file utils
@summary miscellaneous bitsy utilities
@author Sean S. LeBlanc
*/

/*helper used to inject code into script tags based on a search string*/
function inject(searchString, codeToInject) {
	var args = [].slice.call(arguments);
	codeToInject = flatten(args.slice(1)).join('');

	// find the relevant script tag
	var scriptTags = document.getElementsByTagName('script');
	var scriptTag;
	var code;
	for (var i = 0; i < scriptTags.length; ++i) {
		scriptTag = scriptTags[i];
		var matchesSearch = scriptTag.textContent.indexOf(searchString) !== -1;
		var isCurrentScript = scriptTag === document.currentScript;
		if (matchesSearch && !isCurrentScript) {
			code = scriptTag.textContent;
			break;
		}
	}

	// error-handling
	if (!code) {
		throw 'Couldn\'t find "' + searchString + '" in script tags';
	}

	// modify the content
	code = code.replace(searchString, searchString + codeToInject);

	// replace the old script tag with a new one using our modified code
	var newScriptTag = document.createElement('script');
	newScriptTag.textContent = code;
	scriptTag.insertAdjacentElement('afterend', newScriptTag);
	scriptTag.remove();
}

/**
 * Helper for getting room by name or id
 * @param {string} name id or name of room to return
 * @return {string} room, or undefined if it doesn't exist
 */
function getRoom(name) {
	var id = bitsy.room.hasOwnProperty(name) ? name : bitsy.names.room.get(name);
	return bitsy.room[id];
}

/**
 * Helper for getting an array with unique elements 
 * @param  {Array} array Original array
 * @return {Array}       Copy of array, excluding duplicates
 */
function unique(array) {
	return array.filter(function (item, idx) {
		return array.indexOf(item) === idx;
	});
}

function flatten(list) {
	if (!Array.isArray(list)) {
		return list;
	}

	return list.reduce(function (fragments, arg) {
		return fragments.concat(flatten(arg));
	}, []);
}

/**

@file kitsy-script-toolkit
@summary makes it easier and cleaner to run code before and after Bitsy functions or to inject new code into Bitsy script tags
@license WTFPL (do WTF you want)
@version 2.2.1
@requires Bitsy Version: 4.5, 4.6
@author @mildmojo

@description
HOW TO USE:
  import {before, after, inject, addDialogTag, addDeferredDialogTag} from "./helpers/kitsy-script-toolkit";

  before(targetFuncName, beforeFn);
  after(targetFuncName, afterFn);
  inject(searchString, codeFragment1[, ...codefragmentN]);
  addDialogTag(tagName, dialogFn);
  addDeferredDialogTag(tagName, dialogFn);

  For more info, see the documentation at:
  https://github.com/seleb/bitsy-hacks/wiki/Coding-with-kitsy
*/


// Examples: inject('names.sprite.set( name, id );', 'console.dir(names)');
//           inject('names.sprite.set( name, id );', 'console.dir(names);', 'console.dir(sprite);');
//           inject('names.sprite.set( name, id );', ['console.dir(names)', 'console.dir(sprite);']);
function inject$1(searchString, codeFragments) {
	var kitsy = kitsyInit();
	var args = [].slice.call(arguments);
	codeFragments = flatten(args.slice(1));

	kitsy.queuedInjectScripts.push({
		searchString: searchString,
		codeFragments: codeFragments
	});
}

// Ex: before('load_game', function run() { alert('Loading!'); });
//     before('show_text', function run(text) { return text.toUpperCase(); });
//     before('show_text', function run(text, done) { done(text.toUpperCase()); });
function before(targetFuncName, beforeFn) {
	var kitsy = kitsyInit();
	kitsy.queuedBeforeScripts[targetFuncName] = kitsy.queuedBeforeScripts[targetFuncName] || [];
	kitsy.queuedBeforeScripts[targetFuncName].push(beforeFn);
}

// Ex: after('load_game', function run() { alert('Loaded!'); });
function after(targetFuncName, afterFn) {
	var kitsy = kitsyInit();
	kitsy.queuedAfterScripts[targetFuncName] = kitsy.queuedAfterScripts[targetFuncName] || [];
	kitsy.queuedAfterScripts[targetFuncName].push(afterFn);
}

function kitsyInit() {
	// return already-initialized kitsy
	if (bitsy.kitsy) {
		return bitsy.kitsy;
	}

	// Initialize kitsy
	bitsy.kitsy = {
		queuedInjectScripts: [],
		queuedBeforeScripts: {},
		queuedAfterScripts: {}
	};

	var oldStartFunc = bitsy.startExportedGame;
	bitsy.startExportedGame = function doAllInjections() {
		// Only do this once.
		bitsy.startExportedGame = oldStartFunc;

		// Rewrite scripts and hook everything up.
		doInjects();
		applyAllHooks();

		// Start the game
		bitsy.startExportedGame.apply(this, arguments);
	};

	return bitsy.kitsy;
}


function doInjects() {
	bitsy.kitsy.queuedInjectScripts.forEach(function (injectScript) {
		inject(injectScript.searchString, injectScript.codeFragments);
	});
	_reinitEngine();
}

function applyAllHooks() {
	var allHooks = unique(Object.keys(bitsy.kitsy.queuedBeforeScripts).concat(Object.keys(bitsy.kitsy.queuedAfterScripts)));
	allHooks.forEach(applyHook);
}

function applyHook(functionName) {
	var superFn = bitsy[functionName];
	var superFnLength = superFn.length;
	var functions = [];
	// start with befores
	functions = functions.concat(bitsy.kitsy.queuedBeforeScripts[functionName] || []);
	// then original
	functions.push(superFn);
	// then afters
	functions = functions.concat(bitsy.kitsy.queuedAfterScripts[functionName] || []);

	// overwrite original with one which will call each in order
	bitsy[functionName] = function () {
		var args = [].slice.call(arguments);
		var i = 0;
		runBefore.apply(this, arguments);

		// Iterate thru sync & async functions. Run each, finally run original.
		function runBefore() {
			// All outta functions? Finish
			if (i === functions.length) {
				return;
			}

			// Update args if provided.
			if (arguments.length > 0) {
				args = [].slice.call(arguments);
			}

			if (functions[i].length > superFnLength) {
				// Assume funcs that accept more args than the original are
				// async and accept a callback as an additional argument.
				functions[i++].apply(this, args.concat(runBefore.bind(this)));
			} else {
				// run synchronously
				var newArgs = functions[i++].apply(this, args) || args;
				runBefore.apply(this, newArgs);
			}
		}
	};
}

function _reinitEngine() {
	// recreate the script and dialog objects so that they'll be
	// referencing the code with injections instead of the original
	bitsy.scriptModule = new bitsy.Script();
	bitsy.scriptInterpreter = bitsy.scriptModule.CreateInterpreter();

	bitsy.dialogModule = new bitsy.Dialog();
	bitsy.dialogRenderer = bitsy.dialogModule.CreateRenderer();
	bitsy.dialogBuffer = bitsy.dialogModule.CreateBuffer();
}

// Rewrite custom functions' parentheses to curly braces for Bitsy's
// interpreter. Unescape escaped parentheticals, too.
function convertDialogTags(input, tag) {
	return input
		.replace(new RegExp('(^|[^\\\\])\\((' + tag + '\\s+(".+?"|.+?))\\)', 'g'), '$1{$2}') // Rewrite (tag "..."|...) to {tag "..."|...}
		.replace(new RegExp('\\\\\\((' + tag + '\\s+(".+"|.+))\\\\?\\)', 'g'), '($1)'); // Rewrite \(tag "..."|...\) to (tag "..."|...)
}


function addDialogFunction(tag, fn) {
	var kitsy = kitsyInit();
	kitsy.dialogFunctions = kitsy.dialogFunctions || {};
	if (kitsy.dialogFunctions[tag]) {
		throw new Error('The dialog function "' + tag + '" already exists.');
	}

	// Hook into game load and rewrite custom functions in game data to Bitsy format.
	before('load_game', function (game_data, startWithTitle) {
		return [convertDialogTags(game_data, tag), startWithTitle];
	});

	kitsy.dialogFunctions[tag] = fn;
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 * 
 * Function is executed immediately when the tag is reached.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters, onReturn){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 *                       onReturn: function to call with return value (just call `onReturn(null);` at the end of your function if your tag doesn't interact with the logic system)
 */
function addDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	inject$1(
		'var functionMap = new Map();',
		'functionMap.set("' + tag + '", kitsy.dialogFunctions.' + tag + ');'
	);
}

/**
 * Adds a custom dialog tag which executes the provided function.
 * For ease-of-use with the bitsy editor, tags can be written as
 * (tagname "parameters") in addition to the standard {tagname "parameters"}
 * 
 * Function is executed after the dialog box.
 *
 * @param {string}   tag Name of tag
 * @param {Function} fn  Function to execute, with signature `function(environment, parameters){}`
 *                       environment: provides access to SetVariable/GetVariable (among other things, see Environment in the bitsy source for more info)
 *                       parameters: array containing parameters as string in first element (i.e. `parameters[0]`)
 */
function addDeferredDialogTag(tag, fn) {
	addDialogFunction(tag, fn);
	bitsy.kitsy.deferredDialogFunctions = bitsy.kitsy.deferredDialogFunctions || {};
	var deferred = bitsy.kitsy.deferredDialogFunctions[tag] = [];
	inject$1(
		'var functionMap = new Map();',
		'functionMap.set("' + tag + '", function(e, p, o){ kitsy.deferredDialogFunctions.' + tag + '.push({e:e,p:p}); o(null); });'
	);
	// Hook into the dialog finish event and execute the actual function
	after('onExitDialog', function () {
		while (deferred.length) {
			var args = deferred.shift();
			fn(args.e, args.p, args.o);
		}
	});
	// Hook into the game reset and make sure data gets cleared
	after('clearGameData', function () {
		deferred.length = 0;
	});
}



// Implement the {exit} dialog function. It saves the room name and
// destination X/Y coordinates so we can travel there after the dialog is over.
addDeferredDialogTag('exit', function (environment, parameters) {
	var exitParams = _getExitParams('exit', parameters);
	if (!exitParams) {
		return;
	}

	doPlayerExit(exitParams);
});

// Implement the {exitNow} dialog function. It exits to the destination room
// and X/Y coordinates right damn now.
addDialogTag('exitNow', function (environment, parameters, onReturn) {
	var exitParams = _getExitParams('exitNow', parameters);
	if (!exitParams) {
		return;
	}

	doPlayerExit(exitParams);
	onReturn(null);
});

function _getExitParams(exitFuncName, parameters) {
	var params = parameters[0].split(',');
	var roomName = params[0];
	var x = params[1];
	var y = params[2];
	var coordsType = (params[3] || 'exit').toLowerCase();
	var useSpriteCoords = coordsType === 'sprite';
	var roomId = getRoom(roomName).id;

	if (!roomName || x === undefined || y === undefined) {
		console.warn('{' + exitFuncName + '} was missing parameters! Usage: {' +
			exitFuncName + ' "roomname,x,y"}');
		return null;
	}

	if (roomId === undefined) {
		console.warn("Bad {" + exitFuncName + "} parameter: Room '" + roomName + "' not found!");
		return null;
	}

	return {
		room: roomId,
		x: Number(x),
		y: useSpriteCoords ? 15 - Number(y) : Number(y)
	};
}

// dest === {room: Room, x: Int, y: Int}
function doPlayerExit(dest) {
	bitsy.player().room = dest.room;
	bitsy.player().x = dest.x;
	bitsy.player().y = dest.y;
	bitsy.curRoom = dest.room;
}
// End of (exit) dialog function mod

}(window));

/**

@file solid items
@summary treat some items like sprites that can be placed multiple times
@license MIT
@version 1.0.1
@author Sean S. LeBlanc

@description
Prevents certain items from being picked up or walked over, but still triggers their dialog.
This allows them to be treated like sprites that can be placed multiple times.

HOW TO USE:
1. Copy-paste this script into a script tag after the bitsy source
2. Update the `itemIsSolid` function below to match your needs
*/
(function (bitsy) {
'use strict';
var hackOptions = {
itemIsSolid: function (item) {
  // specific solid item
  //return item.name == 'tea';

  // specific solid item list
  //return ['tea', 'flower', 'hat'].indexOf(item.name) !== -1;
  
  // solid item flag in name
  return item.name.indexOf('SOLID') !== -1;

  // all items are solid
  //return true;
}
};

bitsy = bitsy && bitsy.hasOwnProperty('default') ? bitsy['default'] : bitsy;





// true if item should be treated as sprite
// false if item should be treated normally
function getSolidItemFromIndex(itemIndex) {
	if (itemIndex === -1) {
		return;
	}
	var itemId = bitsy.room[bitsy.curRoom].items[itemIndex].id;
	var item = bitsy.item[itemId];
	if (hackOptions.itemIsSolid(item)) {
		return item;
	}
	return;
}

var _getItemIndex = bitsy.getItemIndex;
bitsy.getItemIndex = function () {
	var itemIndex = _getItemIndex.apply(this, arguments);
	var sprItem = getSolidItemFromIndex(itemIndex);
	if (sprItem) {
		return -1;
	}
	return itemIndex;
};

var _getSpriteAt = bitsy.getSpriteAt;
bitsy.getSpriteAt = function (x, y) {
	var spr = _getSpriteAt.apply(this, arguments);
	if (spr) {
		return spr;
	}
	var itemIndex = _getItemIndex(bitsy.curRoom, x, y);
	var item = getSolidItemFromIndex(itemIndex);
	if (item) {
		return item.drw;
	}
};

var _startSpriteDialog = bitsy.startSpriteDialog;
bitsy.startSpriteDialog = function (spriteId) {
	var item = spriteId.split("ITM_")[1];
	if (item) {
		return bitsy.startItemDialog(item);
	}
	_startSpriteDialog.apply(this, arguments);
};

}(window));

/**

@file transparent sprites
@summary makes all sprites have transparent backgrounds
@license MIT
@version 1.0.0
@author Sean S. LeBlanc

@description
Makes all sprites have transparent backgrounds.
i.e. tiles can be seen underneath the player, sprites, and items.

HOW TO USE:
Copy-paste this script into a script tag after the bitsy source
*/
(function (bitsy) {
'use strict';
var hackOptions = {
// if true, overrides scaling behaviour to reduce the setup time + memory use,
// but the game will be blurry unless you've added pixelated image CSS
scaling: false
};

bitsy = bitsy && bitsy.hasOwnProperty('default') ? bitsy['default'] : bitsy;





// override imageDataFromImageSource to use transparency for background pixels
// and save the results to a custom image cache
var _imageDataFromImageSource = bitsy.imageDataFromImageSource;
bitsy.imageDataFromImageSource = function (imageSource, pal) {
	var cache;
	return function (args) {
		if (cache) {
			return cache;
		}

		// get the bitsy image data
		var img = _imageDataFromImageSource.apply(undefined, args);

		// make background pixels transparent
		var bg = bitsy.getPal(pal)[0];
		var i;
		// discard unnecessary pixels
		if (hackOptions.scaling) {
			var scaledImg = bitsy.ctx.createImageData(img.width / bitsy.scale, img.height / bitsy.scale);
			for (var y = 0; y < scaledImg.height; ++y) {
				for (var x = 0; x < scaledImg.width; ++x) {
					var idx = (y * scaledImg.width + x) * 4;
					var idx2 = (y * bitsy.scale * img.width + x * bitsy.scale) * 4;
					scaledImg.data[idx + 0] = img.data[idx2 + 0];
					scaledImg.data[idx + 1] = img.data[idx2 + 1];
					scaledImg.data[idx + 2] = img.data[idx2 + 2];
					scaledImg.data[idx + 3] = img.data[idx2 + 3];
				}
			}
			img = scaledImg;
		}

		// set background pixels to transparent
		for (i = 0; i < img.data.length; i += 4) {
			if (
				img.data[i + 0] === bg[0] &&
				img.data[i + 1] === bg[1] &&
				img.data[i + 2] === bg[2]
			) {
				img.data[i + 3] = 0;
			}
		}

		// give ourselves a little canvas + context to work with
		var spriteCanvas = document.createElement("canvas");
		spriteCanvas.width = bitsy.tilesize * (hackOptions.scaling ? 1 : bitsy.scale);
		spriteCanvas.height = bitsy.tilesize * (hackOptions.scaling ? 1 : bitsy.scale);
		var spriteContext = spriteCanvas.getContext("2d");

		// put bitsy data to our canvas
		spriteContext.clearRect(0, 0, bitsy.tilesize, bitsy.tilesize);
		if (hackOptions.scaling) {
			spriteContext.putImageData(img, 0, 0, 0, 0, bitsy.tilesize, bitsy.tilesize);
		} else {
			spriteContext.putImageData(img, 0, 0);
		}

		// save it in our cache
		cache = spriteCanvas;

		// return our image	
		return cache;
	}.bind(undefined, arguments)
};

// override drawTile to draw from our custom image cache
// instead of putting image data directly
bitsy.drawTile = function (img, x, y, context) {
	if (!context) { //optional pass in context; otherwise, use default
		context = bitsy.ctx;
	}

	if (hackOptions.scaling) {
		context.drawImage(
			img(),
			x * bitsy.tilesize * bitsy.scale,
			y * bitsy.tilesize * bitsy.scale,
			bitsy.tilesize * bitsy.scale,
			bitsy.tilesize * bitsy.scale
		);
	} else {
		context.drawImage(
			img(),
			x * bitsy.tilesize * bitsy.scale,
			y * bitsy.tilesize * bitsy.scale
		);
	}
};

}(window));



</script>

<script type="text/javascript" id="borksyAdditionalJS">
/**

@file gamepad input
@summary HTML5 gamepad support
@license MIT
@version 1.0.0
@author Sean S. LeBlanc

@description
Adds support for gamepad input.

Directional input is mapped to the left and right analog sticks, the dpad, and the face buttons (e.g. ABXY).
The same hold-to-move logic used for keyboard input is shared with the gamepad input.

HOW TO USE:
Copy-paste this script into a script tag after the bitsy source
*/
(function (bitsy) {
'use strict';

bitsy = bitsy && bitsy.hasOwnProperty('default') ? bitsy['default'] : bitsy;

var gamepads = {
	// XBOX360 wired controller configuration
	// buttons
	A: 0,
	X: 2,
	B: 1,
	Y: 3,
	LB: 4,
	RB: 5,
	LT: 6,
	RT: 7,
	BACK: 8,
	START: 9,
	LHAT: 10,
	RHAT: 11,
	DPAD_UP: 12,
	DPAD_DOWN: 13,
	DPAD_LEFT: 14,
	DPAD_RIGHT: 15,

	// axes
	LSTICK_H: 0,
	LSTICK_V: 1,
	RSTICK_H: 2,
	RSTICK_V: 3,


	players: [],

	available: false,
	pollEveryFrame: false,
	connected: false,
	deadZone: 0.25, // if abs(an axis value) is < deadZone, returns 0 instead
	snapZone: 0.25, // if abs(1-an axis value) is < snapZone, returns 1 instead

	init: function () {
		if (navigator.getGamepads) {
			this.available = true;
		} else if (navigator.webkitGetGamepads) {
			navigator.getGamepads = navigator.webkitGetGamepads;
			this.available = true;
		}

		if (this.available) {
			console.log("Gamepad API available");
			if (navigator.userAgent.indexOf('Firefox/') != -1) {
				// listen to connection events for firefox
				window.addEventListener("gamepadconnected", function (event) {
					console.log("gamepad connection event");
					this.pollconnections(event);
				}.bind(this));
				window.addEventListener("gamepaddisconnected", function (event) {
					console.log("gamepad connection event");
					this.pollconnections(event);
				}.bind(this));
			} else {
				this.pollEveryFrame = true;
			}
		} else {
			console.error("Gamepad API not available");
		}
	},

	pollconnections: function (event) {
		this.connected = false;

		// assume existing players' gamepads aren't enabled until they're found
		for (var i = 0; i < this.players.length; ++i) {
			if (this.players[i]) {
				this.players[i].disabled = true;
			}
		}

		var gps = navigator.getGamepads();
		for (var i = 0; i < gps.length; ++i) {
			var gp = gps[i];
			if (gp) {
				if (gp.connected) {
					if (this.players[gp.index] == null) {
						// new player
						gp.down = [];
						gp.justDown = [];
						gp.justUp = [];
						gp.axesPrev = [];
						this.players[gp.index] = gp;
					} else {
						// returning player, copy old button states before replacing
						gp.down = this.players[gp.index].down;
						gp.justDown = this.players[gp.index].justDown;
						gp.justUp = this.players[gp.index].justUp;
						gp.axesPrev = this.players[gp.index].axesPrev;
						this.players[gp.index] = gp;
					}
					this.connected = true;
					this.players[gp.index].disabled = false;
				} else {
					this.players[gp.index] = null;
				}
			}
		}
	},

	update: function () {
		// store the previous axis values
		// has to be done before pollConnections since that will get the new axis values
		for (var i = 0; i < this.players.length; ++i) {
			var p = this.getPlayer(i);
			p.axesPrev = p.axes.slice();
		}

		// poll connections and update gamepad states every frame because chrome's a lazy bum
		if (this.pollEveryFrame) {
			this.pollconnections();
		}

		for (var i = 0; i < this.players.length; ++i) {
			var p = this.getPlayer(i);
			if (p && p != null) {
				for (var j = 0; j < p.buttons.length; ++j) {
					if (p.buttons[j].pressed) {
						p.justDown[j] = !(p.down[j] === true);
						p.down[j] = true;
						p.justUp[j] = false;
					} else {
						p.justUp[j] = p.down[j] === true;
						p.down[j] = false;
						p.justDown[j] = false;
					}
				}
			}

		}
	},

	// returns _player's gamepad
	// if one doesn't exist, returns an object with gamepad properties reflecting a null state
	getPlayer: function (_player) {
		if (this.players[_player] && this.players[_player].connected && !this.players[_player].disabled) {
			return this.players[_player];
		} else {
			return {
				connected: false,
				disabled: true,
				down: [],
				justDown: [],
				justUp: [],
				axes: [],
				axesPrev: [],
				buttons: []
			};
		}
	},

	// returns an array representing _length axes for _player at _offset
	// if abs(an axis value) is < deadZone, returns 0 instead
	// if abs(1-an axis value) is < snapZone, returns 1/-1 instead
	// otherwise, returns the axis value, normalized between deadZone and (1-snapZone)
	// if _offset isn't set, sets to 0
	// if _length isn't set, sets to 2
	// if _player isn't set (or -1), returns the sum of everyone's axes
	// if _prev is set and true, uses the axis values from the previous frame instead of the current one
	getAxes: function (_offset, _length, _player, _prev) {
		if (arguments.length < 4) {
			_prev = false;
			if (arguments.length < 3) {
				_player = -1;
				if (arguments.length < 2) {
					_length = 2;
					if (arguments.length < 1) {
						_offset = 0;
					}
				}
			}
		}

		var axes = [];
		for (var i = 0; i < _length; ++i) {
			axes[i] = 0;
		}
		if (_player == -1) {
			for (var i = 0; i < this.players.length; ++i) {
				var a = this.getAxes(_offset, _length, i, _prev);
				for (var j = 0; j < a.length; ++j) {
					axes[j] += a[j];
				}
			}
		} else {
			var p = this.getPlayer(_player);
			var a = _prev ? p.axesPrev : p.axes;
			a = a.slice(_offset, _offset + _length);
			for (var i = 0; i < a.length; ++i) {
				if (Math.abs(a[i]) < this.deadZone) {
					axes[i] += 0;
				} else if (Math.abs(1.0 - a[i]) < this.snapZone) {
					axes[i] += 1;
				} else if (Math.abs(-1.0 - a[i]) < this.snapZone) {
					axes[i] -= 1;
				} else {
					axes[i] += Math.sign(a[i]) * (Math.abs(a[i]) - this.deadZone) / (1.0 - this.snapZone - this.deadZone);
				}
			}
		}
		return axes;
	},
	// returns getAxes(_axis,1,_player)[0]
	// if _player isn't set, returns the sum of everyone's axis
	// if _prev is set and true, uses the axis values from the previous frame instead of the current one
	getAxis: function (_axis, _player, _prev) {
		if (arguments.length < 3) {
			_prev = false;
			if (arguments.length < 2) {
				_player = -1;
			}
		}
		return this.getAxes(_axis, 1, _player, _prev)[0];
	},

	// returns true if _axis is past _threshold in _direction
	// if _direction isn't set, assumes the sign of _theshold is the direction (e.g. if the theshold is -0.5, it will check if _axis is < -0.5)
	// if _player isn't set, returns true for any player
	// if _prev is set and true, uses the axis values from the previous frame instead of the current one
	axisPast: function (_axis, _threshold, _direction, _player, _prev) {
		if (arguments.length < 5) {
			_prev = false;
			if (arguments.length < 4) {
				_player = -1;
				if (arguments.length < 3) {
					_direction = Math.sign(_threshold);
					if (arguments.length < 2) {
						console.error("must specify axis and threshold");
					}
				}
			}
		}

		var a = this.getAxis(_axis, _player, _prev);



		if (_direction < 0) {
			return a < _threshold;
		} else if (_direction > 0) {
			return a > _threshold;
		} else {
			console.error("direction can't be zero");
		}
	},
	// returns true if _axis is past _threshold in _direction and WAS NOT in previous update
	// if _direction isn't set, assumes the sign of _theshold is the direction (e.g. if the theshold is -0.5, it will check if _axis is < -0.5)
	// if _player isn't set, returns true for any player
	axisJustPast: function (_axis, _threshold, _direction, _player) {
		if (arguments.length < 4) {
			_player = -1;
			if (arguments.length < 3) {
				_direction = Math.sign(_threshold);
				if (arguments.length < 2) {
					console.error("must specify axis and threshold");
				}
			}
		}
		return this.axisPast(_axis, _threshold, _direction, _player, false) && !this.axisPast(_axis, _threshold, _direction, _player, true);
	},

	// returns [x,y] representing the dpad for _player
	// if _player isn't set (or -1), returns the sum of everyone's dpads
	getDpad: function (_player) {
		if (arguments.length < 1) {
			_player = -1;
		}
		var dpad = [0, 0];
		if (_player == -1) {
			for (var i = 0; i < this.players.length; ++i) {
				var d = this.getDpad(i);
				dpad[0] += d[0];
				dpad[1] += d[1];
			}
		} else {
			if (this.isDown(this.DPAD_RIGHT, _player)) {
				dpad[0] += 1;
			}
			if (this.isDown(this.DPAD_LEFT, _player)) {
				dpad[0] -= 1;
			}
			if (this.isDown(this.DPAD_UP, _player)) {
				dpad[1] += 1;
			}
			if (this.isDown(this.DPAD_DOWN, _player)) {
				dpad[1] -= 1;
			}
		}
		return dpad;
	},

	// returns true if _player's _btn is currently down
	// if _player isn't set (or -1), returns true for any player
	isDown: function (_btn, _player) {
		if (arguments.length < 2) {
			_player = -1;
			if (arguments.length < 1) {
				console.error("must specify a button");
			}
		}
		if (_player == -1) {
			for (var i = 0; i < this.players.length; ++i) {
				if (this.isDown(_btn, i)) {
					return true;
				}
			}
			return false;
		} else {
			return this.getPlayer(_player).down[_btn] === true;
		}
	},

	// returns true if _player's _btn is not currently down
	// if _player isn't set (or -1), returns true for any player
	isUp: function (_btn, _player) {
		return !this.isDown(_btn, _player);
	},

	// returns true if _player's _btn is currently down and WAS NOT down in previous update
	// if _player isn't set (or -1), returns true for any player
	isJustDown: function (_btn, _player) {
		if (arguments.length < 2) {
			_player = -1;
			if (arguments.length < 1) {
				console.error("must specify a button");
			}
		}
		if (_player == -1) {
			for (var i = 0; i < this.players.length; ++i) {
				if (this.isJustDown(_btn, i)) {
					return true;
				}
			}
			return false;
		} else {
			return this.getPlayer(_player).justDown[_btn] === true;
		}
	},

	// returns true if _player's _btn is currently NOT down and WAS down in previous update
	// if _player isn't set (or -1), returns true for any player
	isJustUp: function (_btn, _player) {
		if (arguments.length < 2) {
			_player = -1;
			if (arguments.length < 1) {
				console.error("must specify a button");
			}
		}
		if (_player == -1) {
			for (var i = 0; i < this.players.length; ++i) {
				if (this.isJustUp(_btn, i)) {
					return true;
				}
			}
			return false;
		} else {
			return this.getPlayer(_player).justUp[_btn] === true
		}	}
};

var inputGamepads = gamepads;



var _startExportedGame = bitsy.startExportedGame;
bitsy.startExportedGame = function () {
	inputGamepads.init();
	if (_startExportedGame) {
		_startExportedGame();
	}
};
var empty = function () {};

var move = function (dpad, face, axis, axis2, axispast, axisdir, key) {
	// keydown
	if (
		inputGamepads.isJustDown(dpad) ||
		inputGamepads.isJustDown(face) ||
		inputGamepads.axisJustPast(axis, axispast, axisdir) ||
		(
			bitsy.playerHoldToMoveTimer <= 0 && (
				inputGamepads.isDown(dpad) ||
				inputGamepads.isDown(face) ||
				inputGamepads.axisPast(axis, axispast, axisdir)
			)
		)
	) {
		bitsy.curPlayerDirection = bitsy.Direction.None;
		bitsy.onkeydown({
			keyCode: key,
			preventDefault: empty
		});
	}

	// keyup
	if (
		inputGamepads.isJustUp(dpad) ||
		inputGamepads.isJustUp(face) ||
		inputGamepads.axisJustPast(axis, axispast, -axisdir)
	) {
		bitsy.onkeyup({
			keyCode: key,
			preventDefault: empty
		});
	}
};

var _update = bitsy.update;
bitsy.update = function () {
	move(inputGamepads.DPAD_LEFT, inputGamepads.X, inputGamepads.LSTICK_H, inputGamepads.RSTICK_H, -0.5, -1, bitsy.key.left);
	move(inputGamepads.DPAD_RIGHT, inputGamepads.B, inputGamepads.LSTICK_H, inputGamepads.RSTICK_H, 0.5, 1, bitsy.key.right);
	move(inputGamepads.DPAD_UP, inputGamepads.Y, inputGamepads.LSTICK_V, inputGamepads.RSTICK_V, -0.5, -1, bitsy.key.up);
	move(inputGamepads.DPAD_DOWN, inputGamepads.A, inputGamepads.LSTICK_V, inputGamepads.RSTICK_V, 0.5, 1, bitsy.key.down);

	if (_update) {
		_update();
	}
	inputGamepads.update();
};

}(window));

</script>

</head>


<!-- DOCUMENT BODY -->
<body onload='startExportedGame()'>
<!-- GAME CANVAS -->
<canvas id='game'></canvas>
</body>


</html>
